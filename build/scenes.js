/**
 * dat-gui JavaScript Controller Library
 * http://code.google.com/p/dat-gui
 *
 * Copyright 2011 Data Arts Team, Google Creative Lab
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */

/** @license
 * RequireJS Image Plugin
 * Author: Miller Medeiros
 * Version: 0.2.2 (2013/02/08)
 * Released under the MIT license
 */

/**
 * @license RequireJS text 2.0.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/** @license
 * RequireJS plugin for loading JSON files
 * - depends on Text plugin and it was HEAVILY "inspired" by it as well.
 * Author: Miller Medeiros
 * Version: 0.3.1 (2013/02/04)
 * Released under the MIT license
 */

(function(){var THREE=THREE||{REVISION:"58"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}},self.Int32Array=self.Int32Array||Array,self.Float32Array=self.Float32Array||Array,String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},THREE.extend=function(e,t){if(Object.keys)for(var n=Object.keys(t),r=0,i=n.length;r<i;r++){var s=n[r];Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}else for(s in n={}.hasOwnProperty,t)n.call(t,s)&&(e[s]=t[s]);return e},function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(t){var n=Date.now(),r=Math.max(0,16-(n-e)),i=window.setTimeout(function(){t(n+r)},r);return e=n+r,i}),window.cancelAnimationFrame=window.cancelAnimationFrame||function(e){window.clearTimeout(e)}}(),THREE.CullFaceNone=0,THREE.CullFaceBack=1,THREE.CullFaceFront=2,THREE.CullFaceFrontBack=3,THREE.FrontFaceDirectionCW=0,THREE.FrontFaceDirectionCCW=1,THREE.BasicShadowMap=0,THREE.PCFShadowMap=1,THREE.PCFSoftShadowMap=2,THREE.FrontSide=0,THREE.BackSide=1,THREE.DoubleSide=2,THREE.NoShading=0,THREE.FlatShading=1,THREE.SmoothShading=2,THREE.NoColors=0,THREE.FaceColors=1,THREE.VertexColors=2,THREE.NoBlending=0,THREE.NormalBlending=1,THREE.AdditiveBlending=2,THREE.SubtractiveBlending=3,THREE.MultiplyBlending=4,THREE.CustomBlending=5,THREE.AddEquation=100,THREE.SubtractEquation=101,THREE.ReverseSubtractEquation=102,THREE.ZeroFactor=200,THREE.OneFactor=201,THREE.SrcColorFactor=202,THREE.OneMinusSrcColorFactor=203,THREE.SrcAlphaFactor=204,THREE.OneMinusSrcAlphaFactor=205,THREE.DstAlphaFactor=206,THREE.OneMinusDstAlphaFactor=207,THREE.DstColorFactor=208,THREE.OneMinusDstColorFactor=209,THREE.SrcAlphaSaturateFactor=210,THREE.MultiplyOperation=0,THREE.MixOperation=1,THREE.AddOperation=2,THREE.UVMapping=function(){},THREE.CubeReflectionMapping=function(){},THREE.CubeRefractionMapping=function(){},THREE.SphericalReflectionMapping=function(){},THREE.SphericalRefractionMapping=function(){},THREE.RepeatWrapping=1e3,THREE.ClampToEdgeWrapping=1001,THREE.MirroredRepeatWrapping=1002,THREE.NearestFilter=1003,THREE.NearestMipMapNearestFilter=1004,THREE.NearestMipMapLinearFilter=1005,THREE.LinearFilter=1006,THREE.LinearMipMapNearestFilter=1007,THREE.LinearMipMapLinearFilter=1008,THREE.UnsignedByteType=1009,THREE.ByteType=1010,THREE.ShortType=1011,THREE.UnsignedShortType=1012,THREE.IntType=1013,THREE.UnsignedIntType=1014,THREE.FloatType=1015,THREE.UnsignedShort4444Type=1016,THREE.UnsignedShort5551Type=1017,THREE.UnsignedShort565Type=1018,THREE.AlphaFormat=1019,THREE.RGBFormat=1020,THREE.RGBAFormat=1021,THREE.LuminanceFormat=1022,THREE.LuminanceAlphaFormat=1023,THREE.RGB_S3TC_DXT1_Format=2001,THREE.RGBA_S3TC_DXT1_Format=2002,THREE.RGBA_S3TC_DXT3_Format=2003,THREE.RGBA_S3TC_DXT5_Format=2004,THREE.Color=function(e){return void 0!==e&&this.set(e),this},THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(e){return e instanceof THREE.Color?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(0===t)this.r=this.g=this.b=n;else{var r=function(e,t,n){return 0>n&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:.5>n?t:n<2/3?e+6*(t-e)*(2/3-n):e},t=.5>=n?n*(1+t):n+t-n*t,n=2*n-t;this.r=r(n,t,e+1/3),this.g=r(n,t,e),this.b=r(n,t,e-1/3)}return this},setStyle:function(e){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(e))return e=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(e),this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,this;if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(e))return e=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(e),this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(e))return e=/^\#([0-9a-f]{6})$/i.exec(e),this.setHex(parseInt(e[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(e))return e=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e),this.setHex(parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3],16)),this;if(/^(\w+)$/i.test(e))return this.setHex(THREE.ColorKeywords[e]),this},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e){return this.r=e.r*e.r,this.g=e.g*e.g,this.b=e.b*e.b,this},copyLinearToGamma:function(e){return this.r=Math.sqrt(e.r),this.g=Math.sqrt(e.g),this.b=Math.sqrt(e.b),this},convertGammaToLinear:function(){var e=this.r,t=this.g,n=this.b;return this.r=e*e,this.g=t*t,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var e={h:0,s:0,l:0};return function(){var t=this.r,n=this.g,r=this.b,i=Math.max(t,n,r),s=Math.min(t,n,r),o,u=(s+i)/2;if(s===i)s=o=0;else{var f=i-s,s=.5>=u?f/(i+s):f/(2-i-s);switch(i){case t:o=(n-r)/f+(n<r?6:0);break;case n:o=(r-t)/f+2;break;case r:o=(t-n)/f+4}o/=6}return e.h=o,e.s=s,e.l=u,e}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){var r=this.getHSL();return r.h+=e,r.s+=t,r.l+=n,this.setHSL(r.h,r.s,r.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}},THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},THREE.Quaternion=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},setFromEuler:function(e,t){var n=Math.cos(e.x/2),r=Math.cos(e.y/2),i=Math.cos(e.z/2),s=Math.sin(e.x/2),o=Math.sin(e.y/2),u=Math.sin(e.z/2);return void 0===t||"XYZ"===t?(this.x=s*r*i+n*o*u,this.y=n*o*i-s*r*u,this.z=n*r*u+s*o*i,this.w=n*r*i-s*o*u):"YXZ"===t?(this.x=s*r*i+n*o*u,this.y=n*o*i-s*r*u,this.z=n*r*u-s*o*i,this.w=n*r*i+s*o*u):"ZXY"===t?(this.x=s*r*i-n*o*u,this.y=n*o*i+s*r*u,this.z=n*r*u+s*o*i,this.w=n*r*i-s*o*u):"ZYX"===t?(this.x=s*r*i-n*o*u,this.y=n*o*i+s*r*u,this.z=n*r*u-s*o*i,this.w=n*r*i+s*o*u):"YZX"===t?(this.x=s*r*i+n*o*u,this.y=n*o*i+s*r*u,this.z=n*r*u-s*o*i,this.w=n*r*i-s*o*u):"XZY"===t&&(this.x=s*r*i-n*o*u,this.y=n*o*i-s*r*u,this.z=n*r*u+s*o*i,this.w=n*r*i+s*o*u),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this.x=e.x*r,this.y=e.y*r,this.z=e.z*r,this.w=Math.cos(n),this},setFromRotationMatrix:function(e){var t=e.elements,n=t[0],e=t[4],r=t[8],i=t[1],s=t[5],o=t[9],u=t[2],a=t[6],t=t[10],f=n+s+t;return 0<f?(n=.5/Math.sqrt(f+1),this.w=.25/n,this.x=(a-o)*n,this.y=(r-u)*n,this.z=(i-e)*n):n>s&&n>t?(n=2*Math.sqrt(1+n-s-t),this.w=(a-o)/n,this.x=.25*n,this.y=(e+i)/n,this.z=(r+u)/n):s>t?(n=2*Math.sqrt(1+s-n-t),this.w=(r-u)/n,this.x=(e+i)/n,this.y=.25*n,this.z=(o+a)/n):(n=2*Math.sqrt(1+t-n-s),this.w=(i-e)/n,this.x=(r+u)/n,this.y=(o+a)/n,this.z=.25*n),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var e=this.length();return 0===e?(this.z=this.y=this.x=0,this.w=1):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},multiplyQuaternions:function(e,t){var n=e.x,r=e.y,i=e.z,s=e.w,o=t.x,u=t.y,a=t.z,f=t.w;return this.x=n*f+s*o+r*a-i*u,this.y=r*f+s*u+i*o-n*a,this.z=i*f+s*a+n*u-r*o,this.w=s*f-n*o-r*u-i*a,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},slerp:function(e,t){var n=this.x,r=this.y,i=this.z,s=this.w,o=s*e.w+n*e.x+r*e.y+i*e.z;0>o?(this.w=-e.w,this.x=-e.x,this.y=-e.y,this.z=-e.z,o=-o):this.copy(e);if(1<=o)return this.w=s,this.x=n,this.y=r,this.z=i,this;var u=Math.acos(o),a=Math.sqrt(1-o*o);return.001>Math.abs(a)?(this.w=.5*(s+this.w),this.x=.5*(n+this.x),this.y=.5*(r+this.y),this.z=.5*(i+this.z),this):(o=Math.sin((1-t)*u)/a,u=Math.sin(t*u)/a,this.w=s*o+this.w*u,this.x=n*o+this.x*u,this.y=r*o+this.y*u,this.z=i*o+this.z*u,this)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}},THREE.Quaternion.slerp=function(e,t,n,r){return n.copy(e).slerp(t,r)},THREE.Vector2=function(e,t){this.x=e||0,this.y=t||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScalar:function(e){return this.x+=e,this.y+=e,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e):this.set(0,0),this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,e=this.y-e.y;return t*t+e*e},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e){return this.x=e[0],this.y=e[1],this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[3]*n+e[6]*r,this.y=e[1]*t+e[4]*n+e[7]*r,this.z=e[2]*t+e[5]*n+e[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12],this.y=e[1]*t+e[5]*n+e[9]*r+e[13],this.z=e[2]*t+e[6]*n+e[10]*r+e[14],this},applyProjection:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements,i=1/(e[3]*t+e[7]*n+e[11]*r+e[15]);return this.x=(e[0]*t+e[4]*n+e[8]*r+e[12])*i,this.y=(e[1]*t+e[5]*n+e[9]*r+e[13])*i,this.z=(e[2]*t+e[6]*n+e[10]*r+e[14])*i,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,s=e.y,o=e.z,e=e.w,u=e*t+s*r-o*n,a=e*n+o*t-i*r,f=e*r+i*n-s*t,t=-i*t-s*n-o*r;return this.x=u*e+t*-i+a*-o-f*-s,this.y=a*e+t*-s+f*-i-u*-o,this.z=f*e+t*-o+u*-s-a*-i,this},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r,this.y=e[1]*t+e[5]*n+e[9]*r,this.z=e[2]*t+e[6]*n+e[10]*r,this.normalize(),this},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e,this.z/=e):this.z=this.y=this.x=0,this},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},cross:function(e,t){if(void 0!==t)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t);var n=this.x,r=this.y,i=this.z;return this.x=r*e.z-i*e.y,this.y=i*e.x-n*e.z,this.z=n*e.y-r*e.x,this},crossVectors:function(e,t){return this.x=e.y*t.z-e.z*t.y,this.y=e.z*t.x-e.x*t.z,this.z=e.x*t.y-e.y*t.x,this},angleTo:function(e){return e=this.dot(e)/(this.length()*e.length()),Math.acos(THREE.Math.clamp(e,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,e=this.z-e.z;return t*t+n*n+e*e},setEulerFromRotationMatrix:function(e,t){function n(e){return Math.min(Math.max(e,-1),1)}var r=e.elements,i=r[0],s=r[4],o=r[8],u=r[1],a=r[5],f=r[9],l=r[2],c=r[6],r=r[10];return void 0===t||"XYZ"===t?(this.y=Math.asin(n(o)),.99999>Math.abs(o)?(this.x=Math.atan2(-f,r),this.z=Math.atan2(-s,i)):(this.x=Math.atan2(c,a),this.z=0)):"YXZ"===t?(this.x=Math.asin(-n(f)),.99999>Math.abs(f)?(this.y=Math.atan2(o,r),this.z=Math.atan2(u,a)):(this.y=Math.atan2(-l,i),this.z=0)):"ZXY"===t?(this.x=Math.asin(n(c)),.99999>Math.abs(c)?(this.y=Math.atan2(-l,r),this.z=Math.atan2(-s,a)):(this.y=0,this.z=Math.atan2(u,i))):"ZYX"===t?(this.y=Math.asin(-n(l)),.99999>Math.abs(l)?(this.x=Math.atan2(c,r),this.z=Math.atan2(u,i)):(this.x=0,this.z=Math.atan2(-s,a))):"YZX"===t?(this.z=Math.asin(n(u)),.99999>Math.abs(u)?(this.x=Math.atan2(-f,a),this.y=Math.atan2(-l,i)):(this.x=0,this.y=Math.atan2(o,r))):"XZY"===t&&(this.z=Math.asin(-n(s)),.99999>Math.abs(s)?(this.x=Math.atan2(c,a),this.y=Math.atan2(o,i)):(this.x=Math.atan2(-f,r),this.y=0)),this},setEulerFromQuaternion:function(e,t){function n(e){return Math.min(Math.max(e,-1),1)}var r=e.x*e.x,i=e.y*e.y,s=e.z*e.z,o=e.w*e.w;return void 0===t||"XYZ"===t?(this.x=Math.atan2(2*(e.x*e.w-e.y*e.z),o-r-i+s),this.y=Math.asin(n(2*(e.x*e.z+e.y*e.w))),this.z=Math.atan2(2*(e.z*e.w-e.x*e.y),o+r-i-s)):"YXZ"===t?(this.x=Math.asin(n(2*(e.x*e.w-e.y*e.z))),this.y=Math.atan2(2*(e.x*e.z+e.y*e.w),o-r-i+s),this.z=Math.atan2(2*(e.x*e.y+e.z*e.w),o-r+i-s)):"ZXY"===t?(this.x=Math.asin(n(2*(e.x*e.w+e.y*e.z))),this.y=Math.atan2(2*(e.y*e.w-e.z*e.x),o-r-i+s),this.z=Math.atan2(2*(e.z*e.w-e.x*e.y),o-r+i-s)):"ZYX"===t?(this.x=Math.atan2(2*(e.x*e.w+e.z*e.y),o-r-i+s),this.y=Math.asin(n(2*(e.y*e.w-e.x*e.z))),this.z=Math.atan2(2*(e.x*e.y+e.z*e.w),o+r-i-s)):"YZX"===t?(this.x=Math.atan2(2*(e.x*e.w-e.z*e.y),o-r+i-s),this.y=Math.atan2(2*(e.y*e.w-e.x*e.z),o+r-i-s),this.z=Math.asin(n(2*(e.x*e.y+e.z*e.w)))):"XZY"===t&&(this.x=Math.atan2(2*(e.x*e.w+e.y*e.z),o-r+i-s),this.y=Math.atan2(2*(e.x*e.z+e.y*e.w),o+r-i-s),this.z=Math.asin(n(2*(e.z*e.w-e.x*e.y)))),this},getPositionFromMatrix:function(e){return this.x=e.elements[12],this.y=e.elements[13],this.z=e.elements[14],this},getScaleFromMatrix:function(e){var t=this.set(e.elements[0],e.elements[1],e.elements[2]).length(),n=this.set(e.elements[4],e.elements[5],e.elements[6]).length(),e=this.set(e.elements[8],e.elements[9],e.elements[10]).length();return this.x=t,this.y=n,this.z=e,this},getColumnFromMatrix:function(e,t){var n=4*e,r=t.elements;return this.x=r[n],this.y=r[n+1],this.z=r[n+2],this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var e=new THREE.Quaternion;return function(t,n){var r=e.setFromEuler(t,n);return this.applyQuaternion(r),this}}(),applyAxisAngle:function(){var e=new THREE.Quaternion;return function(t,n){var r=e.setFromAxisAngle(t,n);return this.applyQuaternion(r),this}}(),projectOnVector:function(){var e=new THREE.Vector3;return function(t){return e.copy(t).normalize(),t=this.dot(e),this.copy(e).multiplyScalar(t)}}(),projectOnPlane:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new THREE.Vector3;return function(t){return e.copy(this).projectOnVector(t).multiplyScalar(2),this.subVectors(e,this)}}()}),THREE.Vector4=function(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},sub:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,e=e.elements;return this.x=e[0]*t+e[4]*n+e[8]*r+e[12]*i,this.y=e[1]*t+e[5]*n+e[9]*r+e[13]*i,this.z=e[2]*t+e[6]*n+e[10]*r+e[14]*i,this.w=e[3]*t+e[7]*n+e[11]*r+e[15]*i,this},divideScalar:function(e){return 0!==e?(this.x/=e,this.y/=e,this.z/=e,this.w/=e):(this.z=this.y=this.x=0,this.w=1),this},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return 1e-4>t?(this.x=1,this.z=this.y=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,e=e.elements,i=e[0];r=e[4];var s=e[8],o=e[1],u=e[5],a=e[9];n=e[2],t=e[6];var f=e[10];return.01>Math.abs(r-o)&&.01>Math.abs(s-n)&&.01>Math.abs(a-t)?.1>Math.abs(r+o)&&.1>Math.abs(s+n)&&.1>Math.abs(a+t)&&.1>Math.abs(i+u+f-3)?(this.set(1,0,0,0),this):(e=Math.PI,i=(i+1)/2,u=(u+1)/2,f=(f+1)/2,r=(r+o)/4,s=(s+n)/4,a=(a+t)/4,i>u&&i>f?.01>i?(t=0,r=n=.707106781):(t=Math.sqrt(i),n=r/t,r=s/t):u>f?.01>u?(t=.707106781,n=0,r=.707106781):(n=Math.sqrt(u),t=r/n,r=a/n):.01>f?(n=t=.707106781,r=0):(r=Math.sqrt(f),t=s/r,n=a/r),this.set(t,n,r,e),this):(e=Math.sqrt((t-a)*(t-a)+(s-n)*(s-n)+(o-r)*(o-r)),.001>Math.abs(e)&&(e=1),this.x=(t-a)/e,this.y=(s-n)/e,this.z=(o-r)/e,this.w=Math.acos((i+u+f-1)/2),this)},min:function(e){return this.x>e.x&&(this.x=e.x),this.y>e.y&&(this.y=e.y),this.z>e.z&&(this.z=e.z),this.w>e.w&&(this.w=e.w),this},max:function(e){return this.x<e.x&&(this.x=e.x),this.y<e.y&&(this.y=e.y),this.z<e.z&&(this.z=e.z),this.w<e.w&&(this.w=e.w),this},clamp:function(e,t){return this.x<e.x?this.x=e.x:this.x>t.x&&(this.x=t.x),this.y<e.y?this.y=e.y:this.y>t.y&&(this.y=t.y),this.z<e.z?this.z=e.z:this.z>t.z&&(this.z=t.z),this.w<e.w?this.w=e.w:this.w>t.w&&(this.w=t.w),this},negate:function(){return this.multiplyScalar(-1)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(e){var t=this.length();return 0!==t&&e!==t&&this.multiplyScalar(e/t),this},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e){return this.x=e[0],this.y=e[1],this.z=e[2],this.w=e[3],this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Line3=function(e,t){this.start=void 0!==e?e:new THREE.Vector3,this.end=void 0!==t?t:new THREE.Vector3},THREE.Line3.prototype={constructor:THREE.Line3,set:function(e,t){return this.start.copy(e),this.end.copy(t),this},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},center:function(e){return(e||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var n=t||new THREE.Vector3;return this.delta(n).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r){e.subVectors(n,this.start),t.subVectors(this.end,this.start);var i=t.dot(t),i=t.dot(e)/i;return r&&(i=THREE.Math.clamp(i,0,1)),i}}(),closestPointToPoint:function(e,t,n){return e=this.closestPointToPointParameter(e,t),n=n||new THREE.Vector3,this.delta(n).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}},THREE.Box2=function(e,t){this.min=void 0!==e?e:new THREE.Vector2(Infinity,Infinity),this.max=void 0!==t?t:new THREE.Vector2(-Infinity,-Infinity)},THREE.Box2.prototype={constructor:THREE.Box2,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(0<e.length){var t=e[0];this.min.copy(t),this.max.copy(t);for(var n=1,r=e.length;n<r;n++)t=e[n],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector2;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-Infinity,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(e){return(e||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y?!0:!1},getParameter:function(e){return new THREE.Vector2((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y?!1:!0},clampPoint:function(e,t){return(t||new THREE.Vector2).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector2;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}},THREE.Box3=function(e,t){this.min=void 0!==e?e:new THREE.Vector3(Infinity,Infinity,Infinity),this.max=void 0!==t?t:new THREE.Vector3(-Infinity,-Infinity,-Infinity)},THREE.Box3.prototype={constructor:THREE.Box3,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){if(0<e.length){var t=e[0];this.min.copy(t),this.max.copy(t);for(var n=1,r=e.length;n<r;n++)t=e[n],t.x<this.min.x?this.min.x=t.x:t.x>this.max.x&&(this.max.x=t.x),t.y<this.min.y?this.min.y=t.y:t.y>this.max.y&&(this.max.y=t.y),t.z<this.min.z?this.min.z=t.z:t.z>this.max.z&&(this.max.z=t.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var e=new THREE.Vector3;return function(t,n){var r=e.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}}(),copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-Infinity,this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(e){return(e||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(e){return(e||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z?!1:!0},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z?!0:!1},getParameter:function(e){return new THREE.Vector3((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(e){return e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z?!1:!0},clampPoint:function(e,t){return(t||new THREE.Vector3).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new THREE.Vector3;return function(t){return t=t||new THREE.Sphere,t.center=this.center(),t.radius=.5*this.size(e).length(),t}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(){var e=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(t){return e[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),e[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),e[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),e[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),e[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),e[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),e[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),e[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(e),this}}(),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}},THREE.Matrix3=function(e,t,n,r,i,s,o,u,a){this.elements=new Float32Array(9),this.set(void 0!==e?e:1,t||0,n||0,r||0,void 0!==i?i:1,s||0,o||0,u||0,void 0!==a?a:1)},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(e,t,n,r,i,s,o,u,a){var f=this.elements;return f[0]=e,f[3]=t,f[6]=n,f[1]=r,f[4]=i,f[7]=s,f[2]=o,f[5]=u,f[8]=a,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(e){return e=e.elements,this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var n=0,r=t.length;n<r;n+=3)e.x=t[n],e.y=t[n+1],e.z=t[n+2],e.applyMatrix3(this),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z;return t}}(),multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],e=e[8];return t*s*e-t*o*a-n*i*e+n*o*u+r*i*a-r*s*u},getInverse:function(e,t){var n=e.elements,r=this.elements;r[0]=n[10]*n[5]-n[6]*n[9],r[1]=-n[10]*n[1]+n[2]*n[9],r[2]=n[6]*n[1]-n[2]*n[5],r[3]=-n[10]*n[4]+n[6]*n[8],r[4]=n[10]*n[0]-n[2]*n[8],r[5]=-n[6]*n[0]+n[2]*n[4],r[6]=n[9]*n[4]-n[5]*n[8],r[7]=-n[9]*n[0]+n[1]*n[8],r[8]=n[5]*n[0]-n[1]*n[4],n=n[0]*r[0]+n[1]*r[3]+n[2]*r[6];if(0===n){if(t)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/n),this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.getInverse(e).transpose(),this},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},clone:function(){var e=this.elements;return new THREE.Matrix3(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])}},THREE.Matrix4=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=this.elements=new Float32Array(16);m[0]=void 0!==e?e:1,m[4]=t||0,m[8]=n||0,m[12]=r||0,m[1]=i||0,m[5]=void 0!==s?s:1,m[9]=o||0,m[13]=u||0,m[2]=a||0,m[6]=f||0,m[10]=void 0!==l?l:1,m[14]=c||0,m[3]=h||0,m[7]=p||0,m[11]=d||0,m[15]=void 0!==v?v:1},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=i,m[5]=s,m[9]=o,m[13]=u,m[2]=a,m[6]=f,m[10]=l,m[14]=c,m[3]=h,m[7]=p,m[11]=d,m[15]=v,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]),this},extractPosition:function(e){return console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},copyPosition:function(e){var t=this.elements,e=e.elements;return t[12]=e[12],t[13]=e[13],t[14]=e[14],this},extractRotation:function(){var e=new THREE.Vector3;return function(t){var n=this.elements,t=t.elements,r=1/e.set(t[0],t[1],t[2]).length(),i=1/e.set(t[4],t[5],t[6]).length(),s=1/e.set(t[8],t[9],t[10]).length();return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,this}}(),setRotationFromEuler:function(e,t){return console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code."),this.makeRotationFromEuler(e,t)},makeRotationFromEuler:function(e,t){var n=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),r=Math.sin(r),u=Math.cos(i),i=Math.sin(i),a=Math.cos(s),s=Math.sin(s);if(void 0===t||"XYZ"===t){var f=o*a,l=o*s,c=r*a,h=r*s;n[0]=u*a,n[4]=-u*s,n[8]=i,n[1]=l+c*i,n[5]=f-h*i,n[9]=-r*u,n[2]=h-f*i,n[6]=c+l*i,n[10]=o*u}else"YXZ"===t?(f=u*a,l=u*s,c=i*a,h=i*s,n[0]=f+h*r,n[4]=c*r-l,n[8]=o*i,n[1]=o*s,n[5]=o*a,n[9]=-r,n[2]=l*r-c,n[6]=h+f*r,n[10]=o*u):"ZXY"===t?(f=u*a,l=u*s,c=i*a,h=i*s,n[0]=f-h*r,n[4]=-o*s,n[8]=c+l*r,n[1]=l+c*r,n[5]=o*a,n[9]=h-f*r,n[2]=-o*i,n[6]=r,n[10]=o*u):"ZYX"===t?(f=o*a,l=o*s,c=r*a,h=r*s,n[0]=u*a,n[4]=c*i-l,n[8]=f*i+h,n[1]=u*s,n[5]=h*i+f,n[9]=l*i-c,n[2]=-i,n[6]=r*u,n[10]=o*u):"YZX"===t?(f=o*u,l=o*i,c=r*u,h=r*i,n[0]=u*a,n[4]=h-f*s,n[8]=c*s+l,n[1]=s,n[5]=o*a,n[9]=-r*a,n[2]=-i*a,n[6]=l*s+c,n[10]=f-h*s):"XZY"===t&&(f=o*u,l=o*i,c=r*u,h=r*i,n[0]=u*a,n[4]=-s,n[8]=i*a,n[1]=f*s+h,n[5]=o*a,n[9]=l*s-c,n[2]=c*s-l,n[6]=r*a,n[10]=h*s+f);return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this},setRotationFromQuaternion:function(e){return console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."),this.makeRotationFromQuaternion(e)},makeRotationFromQuaternion:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z,s=e.w,o=n+n,u=r+r,a=i+i,e=n*o,f=n*u,n=n*a,l=r*u,r=r*a,i=i*a,o=s*o,u=s*u,s=s*a;return t[0]=1-(l+i),t[4]=f-s,t[8]=n+u,t[1]=f+s,t[5]=1-(e+i),t[9]=r-o,t[2]=n-u,t[6]=r+o,t[10]=1-(e+l),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(r,i,s){var o=this.elements;return n.subVectors(r,i).normalize(),0===n.length()&&(n.z=1),e.crossVectors(s,n).normalize(),0===e.length()&&(n.x+=1e-4,e.crossVectors(s,n).normalize()),t.crossVectors(n,e),o[0]=e.x,o[4]=t.x,o[8]=n.x,o[1]=e.y,o[5]=t.y,o[9]=n.y,o[2]=e.z,o[6]=t.z,o[10]=n.z,this}}(),multiply:function(e,t){return void 0!==t?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,s=n[0],o=n[4],u=n[8],a=n[12],f=n[1],l=n[5],c=n[9],h=n[13],p=n[2],d=n[6],v=n[10],m=n[14],g=n[3],y=n[7],b=n[11],n=n[15],w=r[0],E=r[4],S=r[8],x=r[12],T=r[1],N=r[5],C=r[9],k=r[13],L=r[2],A=r[6],O=r[10],M=r[14],_=r[3],D=r[7],P=r[11],r=r[15];return i[0]=s*w+o*T+u*L+a*_,i[4]=s*E+o*N+u*A+a*D,i[8]=s*S+o*C+u*O+a*P,i[12]=s*x+o*k+u*M+a*r,i[1]=f*w+l*T+c*L+h*_,i[5]=f*E+l*N+c*A+h*D,i[9]=f*S+l*C+c*O+h*P,i[13]=f*x+l*k+c*M+h*r,i[2]=p*w+d*T+v*L+m*_,i[6]=p*E+d*N+v*A+m*D,i[10]=p*S+d*C+v*O+m*P,i[14]=p*x+d*k+v*M+m*r,i[3]=g*w+y*T+b*L+n*_,i[7]=g*E+y*N+b*A+n*D,i[11]=g*S+y*C+b*O+n*P,i[15]=g*x+y*k+b*M+n*r,this},multiplyToArray:function(e,t,n){var r=this.elements;return this.multiplyMatrices(e,t),n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},multiplyVector3:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),e.applyProjection(this)},multiplyVector4:function(e){return console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){var e=new THREE.Vector3;return function(t){for(var n=0,r=t.length;n<r;n+=3)e.x=t[n],e.y=t[n+1],e.z=t[n+2],e.applyProjection(this),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z;return t}}(),rotateAxis:function(e){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],s=e[1],o=e[5],u=e[9],a=e[13],f=e[2],l=e[6],c=e[10],h=e[14];return e[3]*(+i*u*l-r*a*l-i*o*c+n*a*c+r*o*h-n*u*h)+e[7]*(+t*u*h-t*a*c+i*s*c-r*s*h+r*a*f-i*u*f)+e[11]*(+t*a*l-t*o*h-i*s*l+n*s*h+i*o*f-n*a*f)+e[15]*(-r*o*f-t*u*l+t*o*c+r*s*l-n*s*c+n*u*f)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},flattenToArrayOffset:function(e,t){var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e},getPosition:function(){var e=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var t=this.elements;return e.set(t[12],t[13],t[14])}}(),setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],s=r[4],o=r[8],u=r[12],a=r[1],f=r[5],l=r[9],c=r[13],h=r[2],p=r[6],d=r[10],v=r[14],m=r[3],g=r[7],y=r[11],b=r[15];n[0]=l*v*g-c*d*g+c*p*y-f*v*y-l*p*b+f*d*b,n[4]=u*d*g-o*v*g-u*p*y+s*v*y+o*p*b-s*d*b,n[8]=o*c*g-u*l*g+u*f*y-s*c*y-o*f*b+s*l*b,n[12]=u*l*p-o*c*p-u*f*d+s*c*d+o*f*v-s*l*v,n[1]=c*d*m-l*v*m-c*h*y+a*v*y+l*h*b-a*d*b,n[5]=o*v*m-u*d*m+u*h*y-i*v*y-o*h*b+i*d*b,n[9]=u*l*m-o*c*m-u*a*y+i*c*y+o*a*b-i*l*b,n[13]=o*c*h-u*l*h+u*a*d-i*c*d-o*a*v+i*l*v,n[2]=f*v*m-c*p*m+c*h*g-a*v*g-f*h*b+a*p*b,n[6]=u*p*m-s*v*m-u*h*g+i*v*g+s*h*b-i*p*b,n[10]=s*c*m-u*f*m+u*a*g-i*c*g-s*a*b+i*f*b,n[14]=u*f*h-s*c*h-u*a*p+i*c*p+s*a*v-i*f*v,n[3]=l*p*m-f*d*m-l*h*g+a*d*g+f*h*y-a*p*y,n[7]=s*d*m-o*p*m+o*h*g-i*d*g-s*h*y+i*p*y,n[11]=o*f*m-s*l*m-o*a*g+i*l*g+s*a*y-i*f*y,n[15]=s*l*h-o*f*h+o*a*p-i*l*p-s*a*d+i*f*d,n=r[0]*n[0]+r[1]*n[4]+r[2]*n[8]+r[3]*n[12];if(0==n){if(t)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),this.identity(),this}return this.multiplyScalar(1/n),this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(e){var t=this.elements,n=e.x,r=e.y,e=e.z;return t[0]*=n,t[4]*=r,t[8]*=e,t[1]*=n,t[5]*=r,t[9]*=e,t[2]*=n,t[6]*=r,t[10]*=e,t[3]*=n,t[7]*=r,t[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],Math.max(e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10])))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),e=Math.sin(e);return this.set(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,s=e.x,o=e.y,u=e.z,a=i*s,f=i*o;return this.set(a*s+n,a*o-r*u,a*u+r*o,0,a*o+r*u,f*o+n,f*u-r*s,0,a*u-r*o,f*u+r*s,i*u*u+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},compose:function(e,t,n){return console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code."),this.makeFromPositionQuaternionScale(e,t,n)},makeFromPositionQuaternionScale:function(e,t,n){return this.makeRotationFromQuaternion(t),this.scale(n),this.setPosition(e),this},makeFromPositionEulerScale:function(e,t,n,r){return this.makeRotationFromEuler(t,n),this.scale(r),this.setPosition(e),this},makeFrustum:function(e,t,n,r,i,s){var o=this.elements;return o[0]=2*i/(t-e),o[4]=0,o[8]=(t+e)/(t-e),o[12]=0,o[1]=0,o[5]=2*i/(r-n),o[9]=(r+n)/(r-n),o[13]=0,o[2]=0,o[6]=0,o[10]=-(s+i)/(s-i),o[14]=-2*s*i/(s-i),o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(e,t,n,r){var e=n*Math.tan(THREE.Math.degToRad(.5*e)),i=-e;return this.makeFrustum(i*t,e*t,i,e,n,r)},makeOrthographic:function(e,t,n,r,i,s){var o=this.elements,u=t-e,a=n-r,f=s-i;return o[0]=2/u,o[4]=0,o[8]=0,o[12]=-((t+e)/u),o[1]=0,o[5]=2/a,o[9]=0,o[13]=-((n+r)/a),o[2]=0,o[6]=0,o[10]=-2/f,o[14]=-((s+i)/f),o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},clone:function(){var e=this.elements;return new THREE.Matrix4(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])}},THREE.extend(THREE.Matrix4.prototype,{decompose:function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3,r=new THREE.Matrix4;return function(i,s,o){var u=this.elements;return e.set(u[0],u[1],u[2]),t.set(u[4],u[5],u[6]),n.set(u[8],u[9],u[10]),i=i instanceof THREE.Vector3?i:new THREE.Vector3,s=s instanceof THREE.Quaternion?s:new THREE.Quaternion,o=o instanceof THREE.Vector3?o:new THREE.Vector3,o.x=e.length(),o.y=t.length(),o.z=n.length(),i.x=u[12],i.y=u[13],i.z=u[14],r.copy(this),r.elements[0]/=o.x,r.elements[1]/=o.x,r.elements[2]/=o.x,r.elements[4]/=o.y,r.elements[5]/=o.y,r.elements[6]/=o.y,r.elements[8]/=o.z,r.elements[9]/=o.z,r.elements[10]/=o.z,s.setFromRotationMatrix(r),[i,s,o]}}()}),THREE.Ray=function(e,t){this.origin=void 0!==e?e:new THREE.Vector3,this.direction=void 0!==t?t:new THREE.Vector3},THREE.Ray.prototype={constructor:THREE.Ray,set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new THREE.Vector3).copy(this.direction).multiplyScalar(e).add(this.origin)},recast:function(){var e=new THREE.Vector3;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var n=t||new THREE.Vector3;n.subVectors(e,this.origin);var r=n.dot(this.direction);return n.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(){var e=new THREE.Vector3;return function(t){var n=e.subVectors(t,this.origin).dot(this.direction);return e.copy(this.direction).multiplyScalar(n).add(this.origin),e.distanceTo(t)}}(),isIntersectionSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},isIntersectionPlane:function(e){return 0!=e.normal.dot(this.direction)||0==e.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0!=t)return-(this.origin.dot(e.normal)+e.constant)/t;if(0==e.distanceToPoint(this.origin))return 0},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return void 0===n?void 0:this.at(n,t)},applyMatrix4:function(e){return this.direction.add(this.origin).applyMatrix4(e),this.origin.applyMatrix4(e),this.direction.sub(this.origin),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}},THREE.Sphere=function(e,t){this.center=void 0!==e?e:new THREE.Vector3,this.radius=void 0!==t?t:0},THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromCenterAndPoints:function(e,t){for(var n=0,r=0,i=t.length;r<i;r++)var s=e.distanceToSquared(t[r]),n=Math.max(n,s);return this.center=e,this.radius=Math.sqrt(n),this},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},clampPoint:function(e,t){var n=this.center.distanceToSquared(e),r=t||new THREE.Vector3;return r.copy(e),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(e){return e=e||new THREE.Box3,e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}},THREE.Frustum=function(e,t,n,r,i,s){this.planes=[void 0!==e?e:new THREE.Plane,void 0!==t?t:new THREE.Plane,void 0!==n?n:new THREE.Plane,void 0!==r?r:new THREE.Plane,void 0!==i?i:new THREE.Plane,void 0!==s?s:new THREE.Plane]},THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(e,t,n,r,i,s){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(s),this},copy:function(e){for(var t=this.planes,n=0;6>n;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,e=n[0],r=n[1],i=n[2],s=n[3],o=n[4],u=n[5],a=n[6],f=n[7],l=n[8],c=n[9],h=n[10],p=n[11],d=n[12],v=n[13],m=n[14],n=n[15];return t[0].setComponents(s-e,f-o,p-l,n-d).normalize(),t[1].setComponents(s+e,f+o,p+l,n+d).normalize(),t[2].setComponents(s+r,f+u,p+c,n+v).normalize(),t[3].setComponents(s-r,f-u,p-c,n-v).normalize(),t[4].setComponents(s-i,f-a,p-h,n-m).normalize(),t[5].setComponents(s+i,f+a,p+h,n+m).normalize(),this},intersectsObject:function(){var e=new THREE.Vector3;return function(t){var n=t.matrixWorld,r=this.planes,t=-t.geometry.boundingSphere.radius*n.getMaxScaleOnAxis();e.getPositionFromMatrix(n);for(n=0;6>n;n++)if(r[n].distanceToPoint(e)<t)return!1;return!0}}(),intersectsSphere:function(e){for(var t=this.planes,n=e.center,e=-e.radius,r=0;6>r;r++)if(t[r].distanceToPoint(n)<e)return!1;return!0},containsPoint:function(e){for(var t=this.planes,n=0;6>n;n++)if(0>t[n].distanceToPoint(e))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}},THREE.Plane=function(e,t){this.normal=void 0!==e?e:new THREE.Vector3(1,0,0),this.constant=void 0!==t?t:0},THREE.Plane.prototype={constructor:THREE.Plane,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r,i){return r=e.subVectors(i,r).cross(t.subVectors(n,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,n),this}}(),copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return this.orthoPoint(e,t).sub(e).negate()},orthoPoint:function(e,t){var n=this.distanceToPoint(e);return(t||new THREE.Vector3).copy(this.normal).multiplyScalar(n)},isIntersectionLine:function(e){var t=this.distanceToPoint(e.start),e=this.distanceToPoint(e.end);return 0>t&&0<e||0>e&&0<t},intersectLine:function(){var e=new THREE.Vector3;return function(t,n){var r=n||new THREE.Vector3,i=t.delta(e),s=this.normal.dot(i);if(0!=s)return s=-(t.start.dot(this.normal)+this.constant)/s,0>s||1<s?void 0:r.copy(i).multiplyScalar(s).add(t.start);if(0==this.distanceToPoint(t.start))return r.copy(t.start)}}(),coplanarPoint:function(e){return(e||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n,r){var r=r||(new THREE.Matrix3).getNormalMatrix(n),i=e.copy(this.normal).applyMatrix3(r),s=this.coplanarPoint(t);return s.applyMatrix4(n),this.setFromNormalAndCoplanarPoint(i,s),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}},THREE.Math={clamp:function(e,t,n){return e<t?t:e>n?n:e},clampBottom:function(e,t){return e<t?t:e},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(6*e-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},sign:function(e){return 0>e?-1:0<e?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}()},THREE.Spline=function(e){function t(e,t,n,r,i,s,o){return e=.5*(n-e),r=.5*(r-t),(2*(t-n)+e+r)*o+(-3*(t-n)-2*e-r)*s+e*i+t}this.points=e;var n=[],r={x:0,y:0,z:0},i,s,o,u,a,f,l,c,h;this.initFromArray=function(e){this.points=[];for(var t=0;t<e.length;t++)this.points[t]={x:e[t][0],y:e[t][1],z:e[t][2]}},this.getPoint=function(e){return i=(this.points.length-1)*e,s=Math.floor(i),o=i-s,n[0]=0===s?s:s-1,n[1]=s,n[2]=s>this.points.length-2?this.points.length-1:s+1,n[3]=s>this.points.length-3?this.points.length-1:s+2,f=this.points[n[0]],l=this.points[n[1]],c=this.points[n[2]],h=this.points[n[3]],u=o*o,a=o*u,r.x=t(f.x,l.x,c.x,h.x,o,u,a),r.y=t(f.y,l.y,c.y,h.y,o,u,a),r.z=t(f.z,l.z,c.z,h.z,o,u,a),r},this.getControlPointsArray=function(){var e,t,n=this.points.length,r=[];for(e=0;e<n;e++)t=this.points[e],r[e]=[t.x,t.y,t.z];return r},this.getLength=function(e){var t,n,r,i=t=t=0,s=new THREE.Vector3,o=new THREE.Vector3,u=[],a=0;u[0]=0,e||(e=100),n=this.points.length*e,s.copy(this.points[0]);for(e=1;e<n;e++)t=e/n,r=this.getPoint(t),o.copy(r),a+=o.distanceTo(s),s.copy(r),t*=this.points.length-1,t=Math.floor(t),t!=i&&(u[t]=a,i=t);return u[u.length]=a,{chunks:u,total:a}},this.reparametrizeByArcLength=function(e){var t,n,r,i,s,o,u=[],a=new THREE.Vector3,f=this.getLength();u.push(a.copy(this.points[0]).clone());for(t=1;t<this.points.length;t++){n=f.chunks[t]-f.chunks[t-1],o=Math.ceil(e*n/f.total),i=(t-1)/(this.points.length-1),s=t/(this.points.length-1);for(n=1;n<o-1;n++)r=i+n*(1/o)*(s-i),r=this.getPoint(r),u.push(a.copy(r).clone());u.push(a.copy(this.points[t]).clone())}this.points=u}},THREE.Triangle=function(e,t,n){this.a=void 0!==e?e:new THREE.Vector3,this.b=void 0!==t?t:new THREE.Vector3,this.c=void 0!==n?n:new THREE.Vector3},THREE.Triangle.normal=function(){var e=new THREE.Vector3;return function(t,n,r,i){return i=i||new THREE.Vector3,i.subVectors(r,n),e.subVectors(t,n),i.cross(e),t=i.lengthSq(),0<t?i.multiplyScalar(1/Math.sqrt(t)):i.set(0,0,0)}}(),THREE.Triangle.barycoordFromPoint=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(r,i,s,o,u){e.subVectors(o,i),t.subVectors(s,i),n.subVectors(r,i);var r=e.dot(e),i=e.dot(t),s=e.dot(n),f=t.dot(t),o=t.dot(n),l=r*f-i*i,u=u||new THREE.Vector3;return 0==l?u.set(-2,-1,-1):(l=1/l,f=(f*s-i*o)*l,r=(r*o-i*s)*l,u.set(1-f-r,r,f))}}(),THREE.Triangle.containsPoint=function(){var e=new THREE.Vector3;return function(t,n,r,i){return t=THREE.Triangle.barycoordFromPoint(t,n,r,i,e),0<=t.x&&0<=t.y&&1>=t.x+t.y}}(),THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return THREE.Triangle.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return THREE.Triangle.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return THREE.Triangle.containsPoint(e,this.a,this.b,this.c)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)},clone:function(){return(new THREE.Triangle).copy(this)}},THREE.Vertex=function(e){return console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."),e},THREE.UV=function(e,t){return console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."),new THREE.Vector2(e,t)},THREE.Clock=function(e){this.autoStart=void 0!==e?e:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1},THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;this.autoStart&&!this.running&&this.start();if(this.running){var t=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),e=.001*(t-this.oldTime);this.oldTime=t,this.elapsedTime+=e}return e}},THREE.EventDispatcher=function(){},THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)?!0:!1},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners,r=n[e].indexOf(t);-1!==r&&n[e].splice(r,1)}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=0,r=t.length;n<r;n++)t[n].call(this,e)}}}},function(e){e.Raycaster=function(t,n,r,i){this.ray=new e.Ray(t,n),0<this.ray.direction.lengthSq()&&this.ray.direction.normalize(),this.near=r||0,this.far=i||Infinity};var t=new e.Sphere,n=new e.Ray,r=new e.Plane,i=new e.Vector3,s=new e.Vector3,o=new e.Matrix4,u=function(e,t){return e.distance-t.distance},a=function(u,f,l){if(u instanceof e.Particle){s.getPositionFromMatrix(u.matrixWorld);var h=f.ray.distanceToPoint(s);if(h>u.scale.x)return l;l.push({distance:h,point:u.position,face:null,object:u})}else if(u instanceof e.LOD)s.getPositionFromMatrix(u.matrixWorld),h=f.ray.origin.distanceTo(s),a(u.getObjectForDistance(h),f,l);else if(u instanceof e.Mesh){s.getPositionFromMatrix(u.matrixWorld),t.set(s,u.geometry.boundingSphere.radius*u.matrixWorld.getMaxScaleOnAxis());if(!f.ray.isIntersectionSphere(t))return l;var h=u.geometry,p=h.vertices,v=u.material instanceof e.MeshFaceMaterial,m=!0===v?u.material.materials:null,y=u.material.side,w,E,S,x=f.precision;o.getInverse(u.matrixWorld),n.copy(f.ray).applyMatrix4(o);for(var T=0,N=h.faces.length;T<N;T++){var C=h.faces[T],y=!0===v?m[C.materialIndex]:u.material;if(void 0!==y){r.setFromNormalAndCoplanarPoint(C.normal,p[C.a]);var k=n.distanceToPlane(r);if(!(Math.abs(k)<x)&&!(0>k)){y=y.side;if(!(y===e.DoubleSide||(w=n.direction.dot(r.normal),y===e.FrontSide?0>w:0<w)))continue;if(!(k<f.near||k>f.far)){i=n.at(k,i);if(C instanceof e.Face3){if(y=p[C.a],w=p[C.b],E=p[C.c],!e.Triangle.containsPoint(i,y,w,E))continue}else{if(!(C instanceof e.Face4))throw Error("face type not supported");if(y=p[C.a],w=p[C.b],E=p[C.c],S=p[C.d],!e.Triangle.containsPoint(i,y,w,S)&&!e.Triangle.containsPoint(i,w,E,S))continue}l.push({distance:k,point:f.ray.at(k),face:C,faceIndex:T,object:u})}}}}}},f=function(e,t,n){for(var e=e.getDescendants(),r=0,i=e.length;r<i;r++)a(e[r],t,n)};e.Raycaster.prototype.precision=1e-4,e.Raycaster.prototype.set=function(e,t){this.ray.set(e,t),0<this.ray.direction.length()&&this.ray.direction.normalize()},e.Raycaster.prototype.intersectObject=function(e,t){var n=[];return!0===t&&f(e,this,n),a(e,this,n),n.sort(u),n},e.Raycaster.prototype.intersectObjects=function(e,t){for(var n=[],r=0,i=e.length;r<i;r++)a(e[r],this,n),!0===t&&f(e[r],this,n);return n.sort(u),n}}(THREE),THREE.Object3D=function(){this.id=THREE.Object3DIdCount++,this.name="",this.parent=void 0,this.children=[],this.up=new THREE.Vector3(0,1,0),this.position=new THREE.Vector3,this.rotation=new THREE.Vector3,this.eulerOrder=THREE.Object3D.defaultEulerOrder,this.scale=new THREE.Vector3(1,1,1),this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new THREE.Matrix4,this.matrixWorld=new THREE.Matrix4,this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0,this.quaternion=new THREE.Quaternion,this.useQuaternion=!1,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.userData={}},THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(){var e=new THREE.Matrix4;return function(t){this.matrix.multiplyMatrices(t,this.matrix),this.position.getPositionFromMatrix(this.matrix),this.scale.getScaleFromMatrix(this.matrix),e.extractRotation(this.matrix),!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(e):this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}(),rotateOnAxis:function(){var e=new THREE.Quaternion,t=new THREE.Quaternion;return function(n,r){return e.setFromAxisAngle(n,r),!0===this.useQuaternion?this.quaternion.multiply(e):(t.setFromEuler(this.rotation,this.eulerOrder),t.multiply(e),this.rotation.setEulerFromQuaternion(t,this.eulerOrder)),this}}(),translateOnAxis:function(){var e=new THREE.Vector3;return function(t,n){return e.copy(t),!0===this.useQuaternion?e.applyQuaternion(this.quaternion):e.applyEuler(this.rotation,this.eulerOrder),this.position.add(e.multiplyScalar(n)),this}}(),translate:function(e,t){return console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."),this.translateOnAxis(t,e)},translateX:function(){var e=new THREE.Vector3(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new THREE.Vector3(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new THREE.Vector3(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var e=new THREE.Matrix4;return function(t){return t.applyMatrix4(e.getInverse(this.matrixWorld))}}(),lookAt:function(){var e=new THREE.Matrix4;return function(t){e.lookAt(t,this.position,this.up),!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(e):this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}(),add:function(e){if(e===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(e instanceof THREE.Object3D){void 0!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e);for(var t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__addObject(e)}},remove:function(e){var t=this.children.indexOf(e);if(-1!==t){e.parent=void 0,this.children.splice(t,1);for(t=this;void 0!==t.parent;)t=t.parent;void 0!==t&&t instanceof THREE.Scene&&t.__removeObject(e)}},traverse:function(e){e(this);for(var t=0,n=this.children.length;t<n;t++)this.children[t].traverse(e)},getObjectById:function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.id===e||!0===t&&(i=i.getObjectById(e,t),void 0!==i))return i}},getObjectByName:function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if(i.name===e||!0===t&&(i=i.getObjectByName(e,t),void 0!==i))return i}},getChildByName:function(e,t){return console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e,t)},getDescendants:function(e){void 0===e&&(e=[]),Array.prototype.push.apply(e,this.children);for(var t=0,n=this.children.length;t<n;t++)this.children[t].getDescendants(e);return e},updateMatrix:function(){!1===this.useQuaternion?this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===e)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0;for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},clone:function(e){void 0===e&&(e=new THREE.Object3D),e.name=this.name,e.up.copy(this.up),e.position.copy(this.position),e.rotation instanceof THREE.Vector3&&e.rotation.copy(this.rotation),e.eulerOrder=this.eulerOrder,e.scale.copy(this.scale),e.renderDepth=this.renderDepth,e.rotationAutoUpdate=this.rotationAutoUpdate,e.matrix.copy(this.matrix),e.matrixWorld.copy(this.matrixWorld),e.matrixAutoUpdate=this.matrixAutoUpdate,e.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,e.quaternion.copy(this.quaternion),e.useQuaternion=this.useQuaternion,e.visible=this.visible,e.castShadow=this.castShadow,e.receiveShadow=this.receiveShadow,e.frustumCulled=this.frustumCulled,e.userData=JSON.parse(JSON.stringify(this.userData));for(var t=0;t<this.children.length;t++)e.add(this.children[t].clone());return e}},THREE.Object3D.defaultEulerOrder="XYZ",THREE.Object3DIdCount=0,THREE.Projector=function(){function e(){if(s===u){var e=new THREE.RenderableObject;return o.push(e),u++,s++,e}return o[s++]}function t(){if(f===c){var e=new THREE.RenderableVertex;return l.push(e),c++,f++,e}return l[f++]}function n(e,t){return t.z-e.z}function r(e,t){var n=0,r=1,i=e.z+e.w,s=t.z+t.w,o=-e.z+e.w,u=-t.z+t.w;return 0<=i&&0<=s&&0<=o&&0<=u?!0:0>i&&0>s||0>o&&0>u?!1:(0>i?n=Math.max(n,i/(i-s)):0>s&&(r=Math.min(r,i/(i-s))),0>o?n=Math.max(n,o/(o-u)):0>u&&(r=Math.min(r,o/(o-u))),r<n?!1:(e.lerp(t,n),t.lerp(e,1-r),!0))}var i,s,o=[],u=0,a,f,l=[],c=0,h,p,d=[],v=0,m,g=[],y=0,b,w,E=[],S=0,x,T,N=[],C=0,k={objects:[],sprites:[],lights:[],elements:[]},L=new THREE.Vector3,A=new THREE.Vector4,O=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),M=new THREE.Box3,_=Array(3),D=Array(4),P=new THREE.Matrix4,H=new THREE.Matrix4,B,j=new THREE.Matrix4,F=new THREE.Matrix3,I=new THREE.Matrix3,q=new THREE.Vector3,R=new THREE.Frustum,U=new THREE.Vector4,z=new THREE.Vector4;this.projectVector=function(e,t){return t.matrixWorldInverse.getInverse(t.matrixWorld),H.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),e.applyProjection(H)},this.unprojectVector=function(e,t){return t.projectionMatrixInverse.getInverse(t.projectionMatrix),H.multiplyMatrices(t.matrixWorld,t.projectionMatrixInverse),e.applyProjection(H)},this.pickingRay=function(e,t){e.z=-1;var n=new THREE.Vector3(e.x,e.y,1);return this.unprojectVector(e,t),this.unprojectVector(n,t),n.sub(e).normalize(),new THREE.Raycaster(e,n)},this.projectScene=function(o,u,c,W){var X=!1,$,Q,Y,Z,et,tt,nt,rt,it,st,ot,ut,at;T=w=m=p=0,k.elements.length=0,!0===o.autoUpdate&&o.updateMatrixWorld(),void 0===u.parent&&u.updateMatrixWorld(),P.copy(u.matrixWorldInverse.getInverse(u.matrixWorld)),H.multiplyMatrices(u.projectionMatrix,P),I.getNormalMatrix(P),R.setFromMatrix(H),s=0,k.objects.length=0,k.sprites.length=0,k.lights.length=0;var ft=function(t){for(var n=0,r=t.children.length;n<r;n++){var s=t.children[n];if(!1!==s.visible){if(s instanceof THREE.Light)k.lights.push(s);else if(s instanceof THREE.Mesh||s instanceof THREE.Line){if(!1===s.frustumCulled||!0===R.intersectsObject(s))i=e(),i.object=s,null!==s.renderDepth?i.z=s.renderDepth:(L.getPositionFromMatrix(s.matrixWorld),L.applyProjection(H),i.z=L.z),k.objects.push(i)}else s instanceof THREE.Sprite||s instanceof THREE.Particle?(i=e(),i.object=s,null!==s.renderDepth?i.z=s.renderDepth:(L.getPositionFromMatrix(s.matrixWorld),L.applyProjection(H),i.z=L.z),k.sprites.push(i)):(i=e(),i.object=s,null!==s.renderDepth?i.z=s.renderDepth:(L.getPositionFromMatrix(s.matrixWorld),L.applyProjection(H),i.z=L.z),k.objects.push(i));ft(s)}}};ft(o),!0===c&&k.objects.sort(n),o=0;for(c=k.objects.length;o<c;o++)if(rt=k.objects[o].object,B=rt.matrixWorld,f=0,rt instanceof THREE.Mesh){it=rt.geometry,Y=it.vertices,st=it.faces,it=it.faceVertexUvs,F.getNormalMatrix(B),ut=rt.material instanceof THREE.MeshFaceMaterial,at=!0===ut?rt.material:null,$=0;for(Q=Y.length;$<Q;$++)a=t(),a.positionWorld.copy(Y[$]).applyMatrix4(B),a.positionScreen.copy(a.positionWorld).applyMatrix4(H),a.positionScreen.x/=a.positionScreen.w,a.positionScreen.y/=a.positionScreen.w,a.positionScreen.z/=a.positionScreen.w,a.visible=!(-1>a.positionScreen.x||1<a.positionScreen.x||-1>a.positionScreen.y||1<a.positionScreen.y||-1>a.positionScreen.z||1<a.positionScreen.z);Y=0;for($=st.length;Y<$;Y++){Q=st[Y];var lt=!0===ut?at.materials[Q.materialIndex]:rt.material;if(void 0!==lt){tt=lt.side;if(Q instanceof THREE.Face3){if(Z=l[Q.a],et=l[Q.b],nt=l[Q.c],_[0]=Z.positionScreen,_[1]=et.positionScreen,_[2]=nt.positionScreen,!0!==Z.visible&&!0!==et.visible&&!0!==nt.visible&&!O.isIntersectionBox(M.setFromPoints(_)))continue;if(X=0>(nt.positionScreen.x-Z.positionScreen.x)*(et.positionScreen.y-Z.positionScreen.y)-(nt.positionScreen.y-Z.positionScreen.y)*(et.positionScreen.x-Z.positionScreen.x),tt!==THREE.DoubleSide&&X!==(tt===THREE.FrontSide))continue;p===v?(ot=new THREE.RenderableFace3,d.push(ot),v++,p++,h=ot):h=d[p++],h.v1.copy(Z),h.v2.copy(et),h.v3.copy(nt)}else if(Q instanceof THREE.Face4){if(Z=l[Q.a],et=l[Q.b],nt=l[Q.c],ot=l[Q.d],D[0]=Z.positionScreen,D[1]=et.positionScreen,D[2]=nt.positionScreen,D[3]=ot.positionScreen,!0!==Z.visible&&!0!==et.visible&&!0!==nt.visible&&!0!==ot.visible&&!O.isIntersectionBox(M.setFromPoints(D)))continue;if(X=0>(ot.positionScreen.x-Z.positionScreen.x)*(et.positionScreen.y-Z.positionScreen.y)-(ot.positionScreen.y-Z.positionScreen.y)*(et.positionScreen.x-Z.positionScreen.x)||0>(et.positionScreen.x-nt.positionScreen.x)*(ot.positionScreen.y-nt.positionScreen.y)-(et.positionScreen.y-nt.positionScreen.y)*(ot.positionScreen.x-nt.positionScreen.x),tt!==THREE.DoubleSide&&X!==(tt===THREE.FrontSide))continue;if(m===y){var ct=new THREE.RenderableFace4;g.push(ct),y++,m++,h=ct}else h=g[m++];h.v1.copy(Z),h.v2.copy(et),h.v3.copy(nt),h.v4.copy(ot)}h.normalModel.copy(Q.normal),!1===X&&(tt===THREE.BackSide||tt===THREE.DoubleSide)&&h.normalModel.negate(),h.normalModel.applyMatrix3(F).normalize(),h.normalModelView.copy(h.normalModel).applyMatrix3(I),h.centroidModel.copy(Q.centroid).applyMatrix4(B),nt=Q.vertexNormals,Z=0;for(et=nt.length;Z<et;Z++)ot=h.vertexNormalsModel[Z],ot.copy(nt[Z]),!1===X&&(tt===THREE.BackSide||tt===THREE.DoubleSide)&&ot.negate(),ot.applyMatrix3(F).normalize(),h.vertexNormalsModelView[Z].copy(ot).applyMatrix3(I);h.vertexNormalsLength=nt.length,Z=0;for(et=it.length;Z<et;Z++)if(ot=it[Z][Y],void 0!==ot){tt=0;for(nt=ot.length;tt<nt;tt++)h.uvs[Z][tt]=ot[tt]}h.color=Q.color,h.material=lt,q.copy(h.centroidModel).applyProjection(H),h.z=q.z,k.elements.push(h)}}}else if(rt instanceof THREE.Line){j.multiplyMatrices(H,B),Y=rt.geometry.vertices,Z=t(),Z.positionScreen.copy(Y[0]).applyMatrix4(j),st=rt.type===THREE.LinePieces?2:1,$=1;for(Q=Y.length;$<Q;$++)Z=t(),Z.positionScreen.copy(Y[$]).applyMatrix4(j),0<($+1)%st||(et=l[f-2],U.copy(Z.positionScreen),z.copy(et.positionScreen),!0===r(U,z)&&(U.multiplyScalar(1/U.w),z.multiplyScalar(1/z.w),w===S?(it=new THREE.RenderableLine,E.push(it),S++,w++,b=it):b=E[w++],b.v1.positionScreen.copy(U),b.v2.positionScreen.copy(z),b.z=Math.max(U.z,z.z),b.material=rt.material,rt.material.vertexColors===THREE.VertexColors&&(b.vertexColors[0].copy(rt.geometry.colors[$]),b.vertexColors[1].copy(rt.geometry.colors[$-1])),k.elements.push(b)))}o=0;for(c=k.sprites.length;o<c;o++)rt=k.sprites[o].object,B=rt.matrixWorld,rt instanceof THREE.Particle&&(A.set(B.elements[12],B.elements[13],B.elements[14],1),A.applyMatrix4(H),A.z/=A.w,0<A.z&&1>A.z&&(T===C?(X=new THREE.RenderableParticle,N.push(X),C++,T++,x=X):x=N[T++],x.object=rt,x.x=A.x/A.w,x.y=A.y/A.w,x.z=A.z,x.rotation=rt.rotation.z,x.scale.x=rt.scale.x*Math.abs(x.x-(A.x+u.projectionMatrix.elements[0])/(A.w+u.projectionMatrix.elements[12])),x.scale.y=rt.scale.y*Math.abs(x.y-(A.y+u.projectionMatrix.elements[5])/(A.w+u.projectionMatrix.elements[13])),x.material=rt.material,k.elements.push(x)));return!0===W&&k.elements.sort(n),k}},THREE.Face3=function(e,t,n,r,i,s){this.a=e,this.b=t,this.c=n,this.normal=r instanceof THREE.Vector3?r:new THREE.Vector3,this.vertexNormals=r instanceof Array?r:[],this.color=i instanceof THREE.Color?i:new THREE.Color,this.vertexColors=i instanceof Array?i:[],this.vertexTangents=[],this.materialIndex=void 0!==s?s:0,this.centroid=new THREE.Vector3},THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var e=new THREE.Face3(this.a,this.b,this.c);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,n;t=0;for(n=this.vertexNormals.length;t<n;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();t=0;for(n=this.vertexColors.length;t<n;t++)e.vertexColors[t]=this.vertexColors[t].clone();t=0;for(n=this.vertexTangents.length;t<n;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Face4=function(e,t,n,r,i,s,o){this.a=e,this.b=t,this.c=n,this.d=r,this.normal=i instanceof THREE.Vector3?i:new THREE.Vector3,this.vertexNormals=i instanceof Array?i:[],this.color=s instanceof THREE.Color?s:new THREE.Color,this.vertexColors=s instanceof Array?s:[],this.vertexTangents=[],this.materialIndex=void 0!==o?o:0,this.centroid=new THREE.Vector3},THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var e=new THREE.Face4(this.a,this.b,this.c,this.d);e.normal.copy(this.normal),e.color.copy(this.color),e.centroid.copy(this.centroid),e.materialIndex=this.materialIndex;var t,n;t=0;for(n=this.vertexNormals.length;t<n;t++)e.vertexNormals[t]=this.vertexNormals[t].clone();t=0;for(n=this.vertexColors.length;t<n;t++)e.vertexColors[t]=this.vertexColors[t].clone();t=0;for(n=this.vertexTangents.length;t<n;t++)e.vertexTangents[t]=this.vertexTangents[t].clone();return e}},THREE.Geometry=function(){this.id=THREE.GeometryIdCount++,this.name="",this.vertices=[],this.colors=[],this.normals=[],this.faces=[],this.faceUvs=[[]],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphColors=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.dynamic=!0,this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1},THREE.Geometry.prototype={constructor:THREE.Geometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(e){for(var t=(new THREE.Matrix3).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);n=0;for(r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var s=0,o=i.vertexNormals.length;s<o;s++)i.vertexNormals[s].applyMatrix3(t).normalize();i.centroid.applyMatrix4(e)}},computeCentroids:function(){var e,t,n;e=0;for(t=this.faces.length;e<t;e++)n=this.faces[e],n.centroid.set(0,0,0),n instanceof THREE.Face3?(n.centroid.add(this.vertices[n.a]),n.centroid.add(this.vertices[n.b]),n.centroid.add(this.vertices[n.c]),n.centroid.divideScalar(3)):n instanceof THREE.Face4&&(n.centroid.add(this.vertices[n.a]),n.centroid.add(this.vertices[n.b]),n.centroid.add(this.vertices[n.c]),n.centroid.add(this.vertices[n.d]),n.centroid.divideScalar(4))},computeFaceNormals:function(){for(var e=new THREE.Vector3,t=new THREE.Vector3,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],s=this.vertices[i.a],o=this.vertices[i.b];e.subVectors(this.vertices[i.c],o),t.subVectors(s,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i;if(void 0===this.__tmpVertices){i=this.__tmpVertices=Array(this.vertices.length),t=0;for(n=this.vertices.length;t<n;t++)i[t]=new THREE.Vector3;t=0;for(n=this.faces.length;t<n;t++)r=this.faces[t],r instanceof THREE.Face3?r.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:r instanceof THREE.Face4&&(r.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else{i=this.__tmpVertices,t=0;for(n=this.vertices.length;t<n;t++)i[t].set(0,0,0)}if(e){var s,o,u,a=new THREE.Vector3,f=new THREE.Vector3,l=new THREE.Vector3,c=new THREE.Vector3,h=new THREE.Vector3;t=0;for(n=this.faces.length;t<n;t++)r=this.faces[t],r instanceof THREE.Face3?(e=this.vertices[r.a],s=this.vertices[r.b],o=this.vertices[r.c],a.subVectors(o,s),f.subVectors(e,s),a.cross(f),i[r.a].add(a),i[r.b].add(a),i[r.c].add(a)):r instanceof THREE.Face4&&(e=this.vertices[r.a],s=this.vertices[r.b],o=this.vertices[r.c],u=this.vertices[r.d],l.subVectors(u,s),f.subVectors(e,s),l.cross(f),i[r.a].add(l),i[r.b].add(l),i[r.d].add(l),c.subVectors(u,o),h.subVectors(s,o),c.cross(h),i[r.b].add(c),i[r.c].add(c),i[r.d].add(c))}else{t=0;for(n=this.faces.length;t<n;t++)r=this.faces[t],r instanceof THREE.Face3?(i[r.a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal)):r instanceof THREE.Face4&&(i[r.a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal),i[r.d].add(r.normal))}t=0;for(n=this.vertices.length;t<n;t++)i[t].normalize();t=0;for(n=this.faces.length;t<n;t++)r=this.faces[t],r instanceof THREE.Face3?(r.vertexNormals[0].copy(i[r.a]),r.vertexNormals[1].copy(i[r.b]),r.vertexNormals[2].copy(i[r.c])):r instanceof THREE.Face4&&(r.vertexNormals[0].copy(i[r.a]),r.vertexNormals[1].copy(i[r.b]),r.vertexNormals[2].copy(i[r.c]),r.vertexNormals[3].copy(i[r.d]))},computeMorphNormals:function(){var e,t,n,r,i;n=0;for(r=this.faces.length;n<r;n++){i=this.faces[n],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0;for(t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone()}var s=new THREE.Geometry;s.faces=this.faces,e=0;for(t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,u=this.morphNormals[e].vertexNormals,a,f;n=0;for(r=this.faces.length;n<r;n++)i=this.faces[n],a=new THREE.Vector3,f=i instanceof THREE.Face3?{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},o.push(a),u.push(f)}o=this.morphNormals[e],s.vertices=this.morphTargets[e].vertices,s.computeFaceNormals(),s.computeVertexNormals(),n=0;for(r=this.faces.length;n<r;n++)i=this.faces[n],a=o.faceNormals[n],f=o.vertexNormals[n],a.copy(i.normal),i instanceof THREE.Face3?(f.a.copy(i.vertexNormals[0]),f.b.copy(i.vertexNormals[1]),f.c.copy(i.vertexNormals[2])):(f.a.copy(i.vertexNormals[0]),f.b.copy(i.vertexNormals[1]),f.c.copy(i.vertexNormals[2]),f.d.copy(i.vertexNormals[3]))}n=0;for(r=this.faces.length;n<r;n++)i=this.faces[n],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeTangents:function(){function e(e,t,n,r,i,s,T){u=e.vertices[t],a=e.vertices[n],f=e.vertices[r],l=o[i],c=o[s],h=o[T],p=a.x-u.x,d=f.x-u.x,v=a.y-u.y,m=f.y-u.y,g=a.z-u.z,y=f.z-u.z,b=c.x-l.x,w=h.x-l.x,E=c.y-l.y,S=h.y-l.y,x=1/(b*S-w*E),k.set((S*p-E*d)*x,(S*v-E*m)*x,(S*g-E*y)*x),L.set((b*d-w*p)*x,(b*m-w*v)*x,(b*y-w*g)*x),N[t].add(k),N[n].add(k),N[r].add(k),C[t].add(L),C[n].add(L),C[r].add(L)}var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N=[],C=[],k=new THREE.Vector3,L=new THREE.Vector3,A=new THREE.Vector3,O=new THREE.Vector3,M=new THREE.Vector3;t=0;for(n=this.vertices.length;t<n;t++)N[t]=new THREE.Vector3,C[t]=new THREE.Vector3;t=0;for(n=this.faces.length;t<n;t++)s=this.faces[t],o=this.faceVertexUvs[0][t],s instanceof THREE.Face3?e(this,s.a,s.b,s.c,0,1,2):s instanceof THREE.Face4&&(e(this,s.a,s.b,s.d,0,1,3),e(this,s.b,s.c,s.d,1,2,3));var _=["a","b","c","d"];t=0;for(n=this.faces.length;t<n;t++){s=this.faces[t];for(r=0;r<s.vertexNormals.length;r++)M.copy(s.vertexNormals[r]),i=s[_[r]],T=N[i],A.copy(T),A.sub(M.multiplyScalar(M.dot(T))).normalize(),O.crossVectors(s.vertexNormals[r],T),i=O.dot(C[i]),i=0>i?-1:1,s.vertexTangents[r]=new THREE.Vector4(A.x,A.y,A.z,i)}this.hasTangents=!0},computeLineDistances:function(){for(var e=0,t=this.vertices,n=0,r=t.length;n<r;n++)0<n&&(e+=t[n].distanceTo(t[n-1])),this.lineDistances[n]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere),this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var e={},t=[],n=[],r,i=Math.pow(10,4),s,o,u,a,f;this.__tmpVertices=void 0,s=0;for(o=this.vertices.length;s<o;s++)r=this.vertices[s],r=[Math.round(r.x*i),Math.round(r.y*i),Math.round(r.z*i)].join("_"),void 0===e[r]?(e[r]=s,t.push(this.vertices[s]),n[s]=t.length-1):n[s]=n[e[r]];i=[],s=0;for(o=this.faces.length;s<o;s++)if(e=this.faces[s],e instanceof THREE.Face3){e.a=n[e.a],e.b=n[e.b],e.c=n[e.c],u=[e.a,e.b,e.c],r=-1;for(a=0;3>a;a++)if(u[a]==u[(a+1)%3]){i.push(s);break}}else if(e instanceof THREE.Face4){e.a=n[e.a],e.b=n[e.b],e.c=n[e.c],e.d=n[e.d],u=[e.a,e.b,e.c,e.d],r=-1;for(a=0;4>a;a++)u[a]==u[(a+1)%4]&&(0<=r&&i.push(s),r=a);if(0<=r){u.splice(r,1);var l=new THREE.Face3(u[0],u[1],u[2],e.normal,e.color,e.materialIndex);u=0;for(a=this.faceVertexUvs.length;u<a;u++)(f=this.faceVertexUvs[u][s])&&f.splice(r,1);e.vertexNormals&&0<e.vertexNormals.length&&(l.vertexNormals=e.vertexNormals,l.vertexNormals.splice(r,1)),e.vertexColors&&0<e.vertexColors.length&&(l.vertexColors=e.vertexColors,l.vertexColors.splice(r,1)),this.faces[s]=l}}for(s=i.length-1;0<=s;s--){this.faces.splice(s,1),u=0;for(a=this.faceVertexUvs.length;u<a;u++)this.faceVertexUvs[u].splice(s,1)}return n=this.vertices.length-t.length,this.vertices=t,n},clone:function(){for(var e=new THREE.Geometry,t=this.vertices,n=0,r=t.length;n<r;n++)e.vertices.push(t[n].clone());t=this.faces,n=0;for(r=t.length;n<r;n++)e.faces.push(t[n].clone());t=this.faceVertexUvs[0],n=0;for(r=t.length;n<r;n++){for(var i=t[n],s=[],o=0,u=i.length;o<u;o++)s.push(new THREE.Vector2(i[o].x,i[o].y));e.faceVertexUvs[0].push(s)}return e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.GeometryIdCount=0,THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++,this.attributes={},this.dynamic=!1,this.offsets=[],this.boundingSphere=this.boundingBox=null,this.hasTangents=!1,this.morphTargets=[]},THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(e){var t,n;this.attributes.position&&(t=this.attributes.position.array),this.attributes.normal&&(n=this.attributes.normal.array),void 0!==t&&(e.multiplyVector3Array(t),this.verticesNeedUpdate=!0),void 0!==n&&((new THREE.Matrix3).getNormalMatrix(e).multiplyVector3Array(n),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var e=this.attributes.position.array;if(e){var t=this.boundingBox,n,r,i;3<=e.length&&(t.min.x=t.max.x=e[0],t.min.y=t.max.y=e[1],t.min.z=t.max.z=e[2]);for(var s=3,o=e.length;s<o;s+=3)n=e[s],r=e[s+1],i=e[s+2],n<t.min.x?t.min.x=n:n>t.max.x&&(t.max.x=n),r<t.min.y?t.min.y=r:r>t.max.y&&(t.max.y=r),i<t.min.z?t.min.z=i:i>t.max.z&&(t.max.z=i)}if(void 0===e||0===e.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var e=this.attributes.position.array;if(e){for(var t,n=0,r,i,s=0,o=e.length;s<o;s+=3)t=e[s],r=e[s+1],i=e[s+2],t=t*t+r*r+i*i,t>n&&(n=t);this.boundingSphere.radius=Math.sqrt(n)}},computeVertexNormals:function(){if(this.attributes.position){var e,t,n,r;e=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(e),numItems:e};else{e=0;for(t=this.attributes.normal.array.length;e<t;e++)this.attributes.normal.array[e]=0}var i=this.attributes.position.array,s=this.attributes.normal.array,o,u,a,f,l,c,h=new THREE.Vector3,p=new THREE.Vector3,d=new THREE.Vector3,v=new THREE.Vector3,m=new THREE.Vector3;if(this.attributes.index){var g=this.attributes.index.array,y=this.offsets;n=0;for(r=y.length;n<r;++n){t=y[n].start,o=y[n].count;var b=y[n].index;e=t;for(t+=o;e<t;e+=3)o=b+g[e],u=b+g[e+1],a=b+g[e+2],f=i[3*o],l=i[3*o+1],c=i[3*o+2],h.set(f,l,c),f=i[3*u],l=i[3*u+1],c=i[3*u+2],p.set(f,l,c),f=i[3*a],l=i[3*a+1],c=i[3*a+2],d.set(f,l,c),v.subVectors(d,p),m.subVectors(h,p),v.cross(m),s[3*o]+=v.x,s[3*o+1]+=v.y,s[3*o+2]+=v.z,s[3*u]+=v.x,s[3*u+1]+=v.y,s[3*u+2]+=v.z,s[3*a]+=v.x,s[3*a+1]+=v.y,s[3*a+2]+=v.z}}else{e=0;for(t=i.length;e<t;e+=9)f=i[e],l=i[e+1],c=i[e+2],h.set(f,l,c),f=i[e+3],l=i[e+4],c=i[e+5],p.set(f,l,c),f=i[e+6],l=i[e+7],c=i[e+8],d.set(f,l,c),v.subVectors(d,p),m.subVectors(h,p),v.cross(m),s[e]=v.x,s[e+1]=v.y,s[e+2]=v.z,s[e+3]=v.x,s[e+4]=v.y,s[e+5]=v.z,s[e+6]=v.x,s[e+7]=v.y,s[e+8]=v.z}this.normalizeNormals(),this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var e=this.attributes.normal.array,t,n,r,i=0,s=e.length;i<s;i+=3)t=e[i],n=e[i+1],r=e[i+2],t=1/Math.sqrt(t*t+n*n+r*r),e[i]*=t,e[i+1]*=t,e[i+2]*=t},computeTangents:function(){function e(e){B.x=r[3*e],B.y=r[3*e+1],B.z=r[3*e+2],j.copy(B),I=a[e],P.copy(I),P.sub(B.multiplyScalar(B.dot(I))).normalize(),H.crossVectors(j,I),q=H.dot(f[e]),F=0>q?-1:1,u[4*e]=P.x,u[4*e+1]=P.y,u[4*e+2]=P.z,u[4*e+3]=F}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var t=this.attributes.index.array,n=this.attributes.position.array,r=this.attributes.normal.array,i=this.attributes.uv.array,s=n.length/3;if(void 0===this.attributes.tangent){var o=4*s;this.attributes.tangent={itemSize:4,array:new Float32Array(o),numItems:o}}for(var u=this.attributes.tangent.array,a=[],f=[],o=0;o<s;o++)a[o]=new THREE.Vector3,f[o]=new THREE.Vector3;var l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,s=new THREE.Vector3,o=new THREE.Vector3,N,C,k,L,A,O,M,_=this.offsets;k=0;for(L=_.length;k<L;++k){C=_[k].start,A=_[k].count;var D=_[k].index;N=C;for(C+=A;N<C;N+=3)A=D+t[N],O=D+t[N+1],M=D+t[N+2],l=n[3*A],c=n[3*A+1],h=n[3*A+2],p=n[3*O],d=n[3*O+1],v=n[3*O+2],m=n[3*M],g=n[3*M+1],y=n[3*M+2],b=i[2*A],w=i[2*A+1],E=i[2*O],S=i[2*O+1],x=i[2*M],T=i[2*M+1],p-=l,l=m-l,d-=c,c=g-c,v-=h,h=y-h,E-=b,b=x-b,S-=w,w=T-w,T=1/(E*w-b*S),s.set((w*p-S*l)*T,(w*d-S*c)*T,(w*v-S*h)*T),o.set((E*l-b*p)*T,(E*c-b*d)*T,(E*h-b*v)*T),a[A].add(s),a[O].add(s),a[M].add(s),f[A].add(o),f[O].add(o),f[M].add(o)}var P=new THREE.Vector3,H=new THREE.Vector3,B=new THREE.Vector3,j=new THREE.Vector3,F,I,q;k=0;for(L=_.length;k<L;++k){C=_[k].start,A=_[k].count,D=_[k].index,N=C;for(C+=A;N<C;N+=3)A=D+t[N],O=D+t[N+1],M=D+t[N+2],e(A),e(O),e(M)}this.tangentsNeedUpdate=this.hasTangents=!0}},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.Camera=function(){THREE.Object3D.call(this),this.matrixWorldInverse=new THREE.Matrix4,this.projectionMatrix=new THREE.Matrix4,this.projectionMatrixInverse=new THREE.Matrix4},THREE.Camera.prototype=Object.create(THREE.Object3D.prototype),THREE.Camera.prototype.lookAt=function(){var e=new THREE.Matrix4;return function(t){e.lookAt(this.position,t,this.up),!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(e):this.rotation.setEulerFromRotationMatrix(e,this.eulerOrder)}}(),THREE.OrthographicCamera=function(e,t,n,r,i,s){THREE.Camera.call(this),this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()},THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype),THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)},THREE.PerspectiveCamera=function(e,t,n,r){THREE.Camera.call(this),this.fov=void 0!==e?e:50,this.aspect=void 0!==t?t:1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype),THREE.PerspectiveCamera.prototype.setLens=function(e,t){void 0===t&&(t=24),this.fov=2*THREE.Math.radToDeg(Math.atan(t/(2*e))),this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.setViewOffset=function(e,t,n,r,i,s){this.fullWidth=e,this.fullHeight=t,this.x=n,this.y=r,this.width=i,this.height=s,this.updateProjectionMatrix()},THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight,t=Math.tan(THREE.Math.degToRad(.5*this.fov))*this.near,n=-t,r=e*n,e=Math.abs(e*t-r),n=Math.abs(t-n);this.projectionMatrix.makeFrustum(r+this.x*e/this.fullWidth,r+(this.x+this.width)*e/this.fullWidth,t-(this.y+this.height)*n/this.fullHeight,t-this.y*n/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)},THREE.Light=function(e){THREE.Object3D.call(this),this.color=new THREE.Color(e)},THREE.Light.prototype=Object.create(THREE.Object3D.prototype),THREE.Light.prototype.clone=function(e){return void 0===e&&(e=new THREE.Light),THREE.Object3D.prototype.clone.call(this,e),e.color.copy(this.color),e},THREE.AmbientLight=function(e){THREE.Light.call(this,e)},THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype),THREE.AmbientLight.prototype.clone=function(){var e=new THREE.AmbientLight;return THREE.Light.prototype.clone.call(this,e),e},THREE.AreaLight=function(e,t){THREE.Light.call(this,e),this.normal=new THREE.Vector3(0,-1,0),this.right=new THREE.Vector3(1,0,0),this.intensity=void 0!==t?t:1,this.height=this.width=1,this.constantAttenuation=1.5,this.linearAttenuation=.5,this.quadraticAttenuation=.1},THREE.AreaLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight=function(e,t){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraLeft=-500,this.shadowCameraTop=this.shadowCameraRight=500,this.shadowCameraBottom=-500,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowCascade=!1,this.shadowCascadeOffset=new THREE.Vector3(0,0,-1e3),this.shadowCascadeCount=2,this.shadowCascadeBias=[0,0,0],this.shadowCascadeWidth=[512,512,512],this.shadowCascadeHeight=[512,512,512],this.shadowCascadeNearZ=[-1,.99,.998],this.shadowCascadeFarZ=[.99,.998,1],this.shadowCascadeArray=[],this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype),THREE.DirectionalLight.prototype.clone=function(){var e=new THREE.DirectionalLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.HemisphereLight=function(e,t,n){THREE.Light.call(this,e),this.position.set(0,100,0),this.groundColor=new THREE.Color(t),this.intensity=void 0!==n?n:1},THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype),THREE.HemisphereLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.groundColor.copy(this.groundColor),e.intensity=this.intensity,e},THREE.PointLight=function(e,t,n){THREE.Light.call(this,e),this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0},THREE.PointLight.prototype=Object.create(THREE.Light.prototype),THREE.PointLight.prototype.clone=function(){var e=new THREE.PointLight;return THREE.Light.prototype.clone.call(this,e),e.intensity=this.intensity,e.distance=this.distance,e},THREE.SpotLight=function(e,t,n,r,i){THREE.Light.call(this,e),this.position.set(0,1,0),this.target=new THREE.Object3D,this.intensity=void 0!==t?t:1,this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.exponent=void 0!==i?i:10,this.onlyShadow=this.castShadow=!1,this.shadowCameraNear=50,this.shadowCameraFar=5e3,this.shadowCameraFov=50,this.shadowCameraVisible=!1,this.shadowBias=0,this.shadowDarkness=.5,this.shadowMapHeight=this.shadowMapWidth=512,this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null},THREE.SpotLight.prototype=Object.create(THREE.Light.prototype),THREE.SpotLight.prototype.clone=function(){var e=new THREE.SpotLight;return THREE.Light.prototype.clone.call(this,e),e.target=this.target.clone(),e.intensity=this.intensity,e.distance=this.distance,e.angle=this.angle,e.exponent=this.exponent,e.castShadow=this.castShadow,e.onlyShadow=this.onlyShadow,e},THREE.Loader=function(e){this.statusDomElement=(this.showStatus=e)?THREE.Loader.prototype.addStatusElement():null,this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var e=document.createElement("div");return e.style.position="absolute",e.style.right="0px",e.style.top="0px",e.style.fontSize="0.8em",e.style.textAlign="left",e.style.background="rgba(0,0,0,0.25)",e.style.color="#fff",e.style.width="120px",e.style.padding="0.5em 0.5em 0.5em 0.5em",e.style.zIndex=1e3,e.innerHTML="Loading ...",e},updateProgress:function(e){var t="Loaded ",t=e.total?t+((100*e.loaded/e.total).toFixed(0)+"%"):t+((e.loaded/1e3).toFixed(2)+" KB");this.statusDomElement.innerHTML=t},extractUrlBase:function(e){return e=e.split("/"),e.pop(),(1>e.length?".":e.join("/"))+"/"},initMaterials:function(e,t){for(var n=[],r=0;r<e.length;++r)n[r]=THREE.Loader.prototype.createMaterial(e[r],t);return n},needsTangents:function(e){for(var t=0,n=e.length;t<n;t++)if(e[t]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(e,t){function n(e){return e=Math.log(e)/Math.LN2,Math.floor(e)==e}function r(e){return e=Math.log(e)/Math.LN2,Math.pow(2,Math.round(e))}function i(e,i,s,u,a,f,l){var h=/\.dds$/i.test(s),p=t+"/"+s;if(h){var v=THREE.ImageUtils.loadCompressedTexture(p);e[i]=v}else v=document.createElement("canvas"),e[i]=new THREE.Texture(v);e[i].sourceFile=s,u&&(e[i].repeat.set(u[0],u[1]),1!==u[0]&&(e[i].wrapS=THREE.RepeatWrapping),1!==u[1]&&(e[i].wrapT=THREE.RepeatWrapping)),a&&e[i].offset.set(a[0],a[1]),f&&(s={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==s[f[0]]&&(e[i].wrapS=s[f[0]]),void 0!==s[f[1]]&&(e[i].wrapT=s[f[1]])),l&&(e[i].anisotropy=l);if(!h){var m=e[i],e=new Image;e.onload=function(){if(!n(this.width)||!n(this.height)){var e=r(this.width),t=r(this.height);m.image.width=e,m.image.height=t,m.image.getContext("2d").drawImage(this,0,0,e,t)}else m.image=this;m.needsUpdate=!0},e.crossOrigin=o.crossOrigin,e.src=p}}function s(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]}var o=this,u="MeshLambertMaterial",a={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(e.shading){var f=e.shading.toLowerCase();"phong"===f?u="MeshPhongMaterial":"basic"===f&&(u="MeshBasicMaterial")}void 0!==e.blending&&void 0!==THREE[e.blending]&&(a.blending=THREE[e.blending]);if(void 0!==e.transparent||1>e.opacity)a.transparent=e.transparent;return void 0!==e.depthTest&&(a.depthTest=e.depthTest),void 0!==e.depthWrite&&(a.depthWrite=e.depthWrite),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.flipSided&&(a.side=THREE.BackSide),void 0!==e.doubleSided&&(a.side=THREE.DoubleSide),void 0!==e.wireframe&&(a.wireframe=e.wireframe),void 0!==e.vertexColors&&("face"===e.vertexColors?a.vertexColors=THREE.FaceColors:e.vertexColors&&(a.vertexColors=THREE.VertexColors)),e.colorDiffuse?a.color=s(e.colorDiffuse):e.DbgColor&&(a.color=e.DbgColor),e.colorSpecular&&(a.specular=s(e.colorSpecular)),e.colorAmbient&&(a.ambient=s(e.colorAmbient)),e.transparency&&(a.opacity=e.transparency),e.specularCoef&&(a.shininess=e.specularCoef),e.mapDiffuse&&t&&i(a,"map",e.mapDiffuse,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy),e.mapLight&&t&&i(a,"lightMap",e.mapLight,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy),e.mapBump&&t&&i(a,"bumpMap",e.mapBump,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy),e.mapNormal&&t&&i(a,"normalMap",e.mapNormal,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy),e.mapSpecular&&t&&i(a,"specularMap",e.mapSpecular,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy),e.mapBumpScale&&(a.bumpScale=e.mapBumpScale),e.mapNormal?(u=THREE.ShaderLib.normalmap,f=THREE.UniformsUtils.clone(u.uniforms),f.tNormal.value=a.normalMap,e.mapNormalFactor&&f.uNormalScale.value.set(e.mapNormalFactor,e.mapNormalFactor),a.map&&(f.tDiffuse.value=a.map,f.enableDiffuse.value=!0),a.specularMap&&(f.tSpecular.value=a.specularMap,f.enableSpecular.value=!0),a.lightMap&&(f.tAO.value=a.lightMap,f.enableAO.value=!0),f.uDiffuseColor.value.setHex(a.color),f.uSpecularColor.value.setHex(a.specular),f.uAmbientColor.value.setHex(a.ambient),f.uShininess.value=a.shininess,void 0!==a.opacity&&(f.uOpacity.value=a.opacity),u=new THREE.ShaderMaterial({fragmentShader:u.fragmentShader,vertexShader:u.vertexShader,uniforms:f,lights:!0,fog:!0}),a.transparent&&(u.transparent=!0)):u=new THREE[u](a),void 0!==e.DbgName&&(u.name=e.DbgName),u}},THREE.ImageLoader=function(){this.crossOrigin=null},THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e,t){var n=this;void 0===t&&(t=new Image),t.addEventListener("load",function(){n.dispatchEvent({type:"load",content:t})},!1),t.addEventListener("error",function(){n.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),n.crossOrigin&&(t.crossOrigin=n.crossOrigin),t.src=e}},THREE.JSONLoader=function(e){THREE.Loader.call(this,e),this.withCredentials=!1},THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype),THREE.JSONLoader.prototype.load=function(e,t,n){n=n&&"string"==typeof n?n:this.extractUrlBase(e),this.onLoadStart(),this.loadAjaxJSON(this,e,t,n)},THREE.JSONLoader.prototype.loadAjaxJSON=function(e,t,n,r,i){var s=new XMLHttpRequest,o=0;s.onreadystatechange=function(){if(s.readyState===s.DONE)if(200===s.status||0===s.status){if(s.responseText){var u=JSON.parse(s.responseText),u=e.parse(u,r);n(u.geometry,u.materials)}else console.warn("THREE.JSONLoader: ["+t+"] seems to be unreachable or file there is empty");e.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+t+"] ["+s.status+"]");else s.readyState===s.LOADING?i&&(0===o&&(o=s.getResponseHeader("Content-Length")),i({total:o,loaded:s.responseText.length})):s.readyState===s.HEADERS_RECEIVED&&void 0!==i&&(o=s.getResponseHeader("Content-Length"))},s.open("GET",t,!0),s.withCredentials=this.withCredentials,s.send(null)},THREE.JSONLoader.prototype.parse=function(e,t){var n=new THREE.Geometry,r=void 0!==e.scale?1/e.scale:1,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=e.faces;p=e.vertices;var w=e.normals,E=e.colors,S=0;for(i=0;i<e.uvs.length;i++)e.uvs[i].length&&S++;for(i=0;i<S;i++)n.faceUvs[i]=[],n.faceVertexUvs[i]=[];u=0;for(a=p.length;u<a;)f=new THREE.Vector3,f.x=p[u++]*r,f.y=p[u++]*r,f.z=p[u++]*r,n.vertices.push(f);u=0;for(a=b.length;u<a;){p=b[u++],f=p&1,o=p&2,i=p&4,s=p&8,c=p&16,l=p&32,d=p&64,p&=128,f?(v=new THREE.Face4,v.a=b[u++],v.b=b[u++],v.c=b[u++],v.d=b[u++],f=4):(v=new THREE.Face3,v.a=b[u++],v.b=b[u++],v.c=b[u++],f=3),o&&(o=b[u++],v.materialIndex=o),o=n.faces.length;if(i)for(i=0;i<S;i++)m=e.uvs[i],h=b[u++],y=m[2*h],h=m[2*h+1],n.faceUvs[i][o]=new THREE.Vector2(y,h);if(s)for(i=0;i<S;i++){m=e.uvs[i],g=[];for(s=0;s<f;s++)h=b[u++],y=m[2*h],h=m[2*h+1],g[s]=new THREE.Vector2(y,h);n.faceVertexUvs[i][o]=g}c&&(c=3*b[u++],s=new THREE.Vector3,s.x=w[c++],s.y=w[c++],s.z=w[c],v.normal=s);if(l)for(i=0;i<f;i++)c=3*b[u++],s=new THREE.Vector3,s.x=w[c++],s.y=w[c++],s.z=w[c],v.vertexNormals.push(s);d&&(l=b[u++],l=new THREE.Color(E[l]),v.color=l);if(p)for(i=0;i<f;i++)l=b[u++],l=new THREE.Color(E[l]),v.vertexColors.push(l);n.faces.push(v)}if(e.skinWeights){u=0;for(a=e.skinWeights.length;u<a;u+=2)b=e.skinWeights[u],w=e.skinWeights[u+1],n.skinWeights.push(new THREE.Vector4(b,w,0,0))}if(e.skinIndices){u=0;for(a=e.skinIndices.length;u<a;u+=2)b=e.skinIndices[u],w=e.skinIndices[u+1],n.skinIndices.push(new THREE.Vector4(b,w,0,0))}n.bones=e.bones,n.animation=e.animation;if(void 0!==e.morphTargets){u=0;for(a=e.morphTargets.length;u<a;u++){n.morphTargets[u]={},n.morphTargets[u].name=e.morphTargets[u].name,n.morphTargets[u].vertices=[],E=n.morphTargets[u].vertices,S=e.morphTargets[u].vertices,b=0;for(w=S.length;b<w;b+=3)p=new THREE.Vector3,p.x=S[b]*r,p.y=S[b+1]*r,p.z=S[b+2]*r,E.push(p)}}if(void 0!==e.morphColors){u=0;for(a=e.morphColors.length;u<a;u++){n.morphColors[u]={},n.morphColors[u].name=e.morphColors[u].name,n.morphColors[u].colors=[],w=n.morphColors[u].colors,E=e.morphColors[u].colors,r=0;for(b=E.length;r<b;r+=3)S=new THREE.Color(16755200),S.setRGB(E[r],E[r+1],E[r+2]),w.push(S)}}return n.computeCentroids(),n.computeFaceNormals(),void 0===e.materials?{geometry:n}:(r=this.initMaterials(e.materials,t),this.needsTangents(r)&&n.computeTangents(),{geometry:n,materials:r})},THREE.LoadingMonitor=function(){var e=this,t=0,n=0,r=function(){t++,e.dispatchEvent({type:"progress",loaded:t,total:n}),t===n&&e.dispatchEvent({type:"load"})};this.add=function(e){n++,e.addEventListener("load",r,!1)}},THREE.LoadingMonitor.prototype={constructor:THREE.LoadingMonitor,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent},THREE.GeometryLoader=function(){},THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e){var t=this,n=new XMLHttpRequest;n.addEventListener("load",function(e){e=t.parse(JSON.parse(e.target.responseText)),t.dispatchEvent({type:"load",content:e})},!1),n.addEventListener("progress",function(e){t.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},!1),n.addEventListener("error",function(){t.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),n.open("GET",e,!0),n.send(null)},parse:function(){}},THREE.MaterialLoader=function(){},THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e){var t=this,n=new XMLHttpRequest;n.addEventListener("load",function(e){e=t.parse(JSON.parse(e.target.responseText)),t.dispatchEvent({type:"load",content:e})},!1),n.addEventListener("progress",function(e){t.dispatchEvent({type:"progress",loaded:e.loaded,total:e.total})},!1),n.addEventListener("error",function(){t.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),n.open("GET",e,!0),n.send(null)},parse:function(e){var t;switch(e.type){case"MeshBasicMaterial":t=new THREE.MeshBasicMaterial({color:e.color,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshLambertMaterial":t=new THREE.MeshLambertMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshPhongMaterial":t=new THREE.MeshPhongMaterial({color:e.color,ambient:e.ambient,emissive:e.emissive,specular:e.specular,shininess:e.shininess,opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshNormalMaterial":t=new THREE.MeshNormalMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe});break;case"MeshDepthMaterial":t=new THREE.MeshDepthMaterial({opacity:e.opacity,transparent:e.transparent,wireframe:e.wireframe})}return t}},THREE.SceneLoader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){},this.callbackSync=function(){},this.callbackProgress=function(){},this.geometryHandlerMap={},this.hierarchyHandlerMap={},this.addGeometryHandler("ascii",THREE.JSONLoader)},THREE.SceneLoader.prototype.constructor=THREE.SceneLoader,THREE.SceneLoader.prototype.load=function(e,t){var n=this,r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status||0===r.status){var i=JSON.parse(r.responseText);n.parse(i,t,e)}else console.error("THREE.SceneLoader: Couldn't load ["+e+"] ["+r.status+"]")},r.open("GET",e,!0),r.send(null)},THREE.SceneLoader.prototype.addGeometryHandler=function(e,t){this.geometryHandlerMap[e]={loaderClass:t}},THREE.SceneLoader.prototype.addHierarchyHandler=function(e,t){this.hierarchyHandlerMap[e]={loaderClass:t}},THREE.SceneLoader.prototype.parse=function(e,t,n){function r(e,t){return"relativeToHTML"==t?e:c+"/"+e}function i(){s(T.scene,C.objects)}function s(e,t){var n,i,o,a,f,c,v;for(v in t)if(void 0===T.objects[v]){var m=t[v],w=null;if(m.type&&m.type in l.hierarchyHandlerMap){if(void 0===m.loading){i={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1},o={};for(var E in m)E in i||(o[E]=m[E]);p=T.materials[m.material],m.loading=!0,i=l.hierarchyHandlerMap[m.type].loaderObject,i.options?i.load(r(m.url,C.urlBaseType),u(v,e,p,m)):i.load(r(m.url,C.urlBaseType),u(v,e,p,m),o)}}else if(void 0!==m.geometry){if(h=T.geometries[m.geometry]){w=!1,p=T.materials[m.material],w=p instanceof THREE.ShaderMaterial,o=m.position,a=m.rotation,f=m.scale,n=m.matrix,c=m.quaternion,m.material||(p=new THREE.MeshFaceMaterial(T.face_materials[m.geometry])),p instanceof THREE.MeshFaceMaterial&&0===p.materials.length&&(p=new THREE.MeshFaceMaterial(T.face_materials[m.geometry]));if(p instanceof THREE.MeshFaceMaterial)for(i=0;i<p.materials.length;i++)w=w||p.materials[i]instanceof THREE.ShaderMaterial;w&&h.computeTangents(),m.skin?w=new THREE.SkinnedMesh(h,p):m.morph?(w=new THREE.MorphAnimMesh(h,p),void 0!==m.duration&&(w.duration=m.duration),void 0!==m.time&&(w.time=m.time),void 0!==m.mirroredLoop&&(w.mirroredLoop=m.mirroredLoop),p.morphNormals&&h.computeMorphNormals()):w=new THREE.Mesh(h,p),w.name=v,n?(w.matrixAutoUpdate=!1,w.matrix.set(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])):(w.position.set(o[0],o[1],o[2]),c?(w.quaternion.set(c[0],c[1],c[2],c[3]),w.useQuaternion=!0):w.rotation.set(a[0],a[1],a[2]),w.scale.set(f[0],f[1],f[2])),w.visible=m.visible,w.castShadow=m.castShadow,w.receiveShadow=m.receiveShadow,e.add(w),T.objects[v]=w}}else"DirectionalLight"===m.type||"PointLight"===m.type||"AmbientLight"===m.type?(y=void 0!==m.color?m.color:16777215,b=void 0!==m.intensity?m.intensity:1,"DirectionalLight"===m.type?(o=m.direction,g=new THREE.DirectionalLight(y,b),g.position.set(o[0],o[1],o[2]),m.target&&(N.push({object:g,targetName:m.target}),g.target=null)):"PointLight"===m.type?(o=m.position,i=m.distance,g=new THREE.PointLight(y,b,i),g.position.set(o[0],o[1],o[2])):"AmbientLight"===m.type&&(g=new THREE.AmbientLight(y)),e.add(g),g.name=v,T.lights[v]=g,T.objects[v]=g):"PerspectiveCamera"===m.type||"OrthographicCamera"===m.type?(o=m.position,a=m.rotation,c=m.quaternion,"PerspectiveCamera"===m.type?d=new THREE.PerspectiveCamera(m.fov,m.aspect,m.near,m.far):"OrthographicCamera"===m.type&&(d=new THREE.OrthographicCamera(m.left,m.right,m.top,m.bottom,m.near,m.far)),d.name=v,d.position.set(o[0],o[1],o[2]),void 0!==c?(d.quaternion.set(c[0],c[1],c[2],c[3]),d.useQuaternion=!0):void 0!==a&&d.rotation.set(a[0],a[1],a[2]),e.add(d),T.cameras[v]=d,T.objects[v]=d):(o=m.position,a=m.rotation,f=m.scale,c=m.quaternion,w=new THREE.Object3D,w.name=v,w.position.set(o[0],o[1],o[2]),c?(w.quaternion.set(c[0],c[1],c[2],c[3]),w.useQuaternion=!0):w.rotation.set(a[0],a[1],a[2]),w.scale.set(f[0],f[1],f[2]),w.visible=void 0!==m.visible?m.visible:!1,e.add(w),T.objects[v]=w,T.empties[v]=w);if(w){if(void 0!==m.userData)for(var S in m.userData)w.userData[S]=m.userData[S];if(void 0!==m.groups)for(i=0;i<m.groups.length;i++)o=m.groups[i],void 0===T.groups[o]&&(T.groups[o]=[]),T.groups[o].push(v);void 0!==m.children&&s(w,m.children)}}}function o(e){return function(t,n){t.name=e,T.geometries[e]=t,T.face_materials[e]=n,i(),w-=1,l.onLoadComplete(),f()}}function u(e,t,n,r){return function(s){var s=s.content?s.content:s.dae?s.scene:s,o=r.position,u=r.rotation,a=r.quaternion,c=r.scale;s.position.set(o[0],o[1],o[2]),a?(s.quaternion.set(a[0],a[1],a[2],a[3]),s.useQuaternion=!0):s.rotation.set(u[0],u[1],u[2]),s.scale.set(c[0],c[1],c[2]),n&&s.traverse(function(e){e.material=n});var h=void 0!==r.visible?r.visible:!0;s.traverse(function(e){e.visible=h}),t.add(s),s.name=e,T.objects[e]=s,i(),w-=1,l.onLoadComplete(),f()}}function a(e){return function(t,n){t.name=e,T.geometries[e]=t,T.face_materials[e]=n}}function f(){l.callbackProgress({totalModels:S,totalTextures:x,loadedModels:S-w,loadedTextures:x-E},T),l.onLoadProgress();if(0===w&&0===E){for(var e=0;e<N.length;e++){var n=N[e],r=T.objects[n.targetName];r?n.object.target=r:(n.object.target=new THREE.Object3D,T.scene.add(n.object.target)),n.object.target.userData.targetInverse=n.object}t(T)}}var l=this,c=THREE.Loader.prototype.extractUrlBase(n),h,p,d,v,m,g,y,b,w,E,S,x,T,N=[],C=e,k;for(k in this.geometryHandlerMap)e=this.geometryHandlerMap[k].loaderClass,this.geometryHandlerMap[k].loaderObject=new e;for(k in this.hierarchyHandlerMap)e=this.hierarchyHandlerMap[k].loaderClass,this.hierarchyHandlerMap[k].loaderObject=new e;E=w=0,T={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}},C.transform&&(k=C.transform.position,e=C.transform.rotation,n=C.transform.scale,k&&T.scene.position.set(k[0],k[1],k[2]),e&&T.scene.rotation.set(e[0],e[1],e[2]),n&&T.scene.scale.set(n[0],n[1],n[2]),k||e||n)&&(T.scene.updateMatrix(),T.scene.updateMatrixWorld()),k=function(e){return function(){E-=e,f(),l.onLoadComplete()}};for(var L in C.fogs)e=C.fogs[L],"linear"===e.type?v=new THREE.Fog(0,e.near,e.far):"exp2"===e.type&&(v=new THREE.FogExp2(0,e.density)),e=e.color,v.color.setRGB(e[0],e[1],e[2]),T.fogs[L]=v;for(var A in C.geometries)v=C.geometries[A],v.type in this.geometryHandlerMap&&(w+=1,l.onLoadStart());for(var O in C.objects)v=C.objects[O],v.type&&v.type in this.hierarchyHandlerMap&&(w+=1,l.onLoadStart());S=w;for(A in C.geometries)if(v=C.geometries[A],"cube"===v.type)h=new THREE.CubeGeometry(v.width,v.height,v.depth,v.widthSegments,v.heightSegments,v.depthSegments),h.name=A,T.geometries[A]=h;else if("plane"===v.type)h=new THREE.PlaneGeometry(v.width,v.height,v.widthSegments,v.heightSegments),h.name=A,T.geometries[A]=h;else if("sphere"===v.type)h=new THREE.SphereGeometry(v.radius,v.widthSegments,v.heightSegments),h.name=A,T.geometries[A]=h;else if("cylinder"===v.type)h=new THREE.CylinderGeometry(v.topRad,v.botRad,v.height,v.radSegs,v.heightSegs),h.name=A,T.geometries[A]=h;else if("torus"===v.type)h=new THREE.TorusGeometry(v.radius,v.tube,v.segmentsR,v.segmentsT),h.name=A,T.geometries[A]=h;else if("icosahedron"===v.type)h=new THREE.IcosahedronGeometry(v.radius,v.subdivisions),h.name=A,T.geometries[A]=h;else if(v.type in this.geometryHandlerMap){O={};for(m in v)"type"!==m&&"url"!==m&&(O[m]=v[m]);this.geometryHandlerMap[v.type].loaderObject.load(r(v.url,C.urlBaseType),o(A),O)}else"embedded"===v.type&&(O=C.embeds[v.id],O.metadata=C.metadata,O&&(O=this.geometryHandlerMap.ascii.loaderObject.parse(O,""),a(A)(O.geometry,O.materials)));for(var M in C.textures)if(A=C.textures[M],A.url instanceof Array){E+=A.url.length;for(m=0;m<A.url.length;m++)l.onLoadStart()}else E+=1,l.onLoadStart();x=E;for(M in C.textures){A=C.textures[M],void 0!==A.mapping&&void 0!==THREE[A.mapping]&&(A.mapping=new THREE[A.mapping]);if(A.url instanceof Array){O=A.url.length,v=[];for(m=0;m<O;m++)v[m]=r(A.url[m],C.urlBaseType);m=(m=/\.dds$/i.test(v[0]))?THREE.ImageUtils.loadCompressedTextureCube(v,A.mapping,k(O)):THREE.ImageUtils.loadTextureCube(v,A.mapping,k(O))}else m=/\.dds$/i.test(A.url),O=r(A.url,C.urlBaseType),v=k(1),m=m?THREE.ImageUtils.loadCompressedTexture(O,A.mapping,v):THREE.ImageUtils.loadTexture(O,A.mapping,v),void 0!==THREE[A.minFilter]&&(m.minFilter=THREE[A.minFilter]),void 0!==THREE[A.magFilter]&&(m.magFilter=THREE[A.magFilter]),A.anisotropy&&(m.anisotropy=A.anisotropy),A.repeat&&(m.repeat.set(A.repeat[0],A.repeat[1]),1!==A.repeat[0]&&(m.wrapS=THREE.RepeatWrapping),1!==A.repeat[1]&&(m.wrapT=THREE.RepeatWrapping)),A.offset&&m.offset.set(A.offset[0],A.offset[1]),A.wrap&&(O={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==O[A.wrap[0]]&&(m.wrapS=O[A.wrap[0]]),void 0!==O[A.wrap[1]]&&(m.wrapT=O[A.wrap[1]]));T.textures[M]=m}var _,D;for(_ in C.materials){M=C.materials[_];for(D in M.parameters)"envMap"===D||"map"===D||"lightMap"===D||"bumpMap"===D?M.parameters[D]=T.textures[M.parameters[D]]:"shading"===D?M.parameters[D]="flat"===M.parameters[D]?THREE.FlatShading:THREE.SmoothShading:"side"===D?M.parameters[D]="double"==M.parameters[D]?THREE.DoubleSide:"back"==M.parameters[D]?THREE.BackSide:THREE.FrontSide:"blending"===D?M.parameters[D]=M.parameters[D]in THREE?THREE[M.parameters[D]]:THREE.NormalBlending:"combine"===D?M.parameters[D]=M.parameters[D]in THREE?THREE[M.parameters[D]]:THREE.MultiplyOperation:"vertexColors"===D?"face"==M.parameters[D]?M.parameters[D]=THREE.FaceColors:M.parameters[D]&&(M.parameters[D]=THREE.VertexColors):"wrapRGB"===D&&(k=M.parameters[D],M.parameters[D]=new THREE.Vector3(k[0],k[1],k[2]));void 0!==M.parameters.opacity&&1>M.parameters.opacity&&(M.parameters.transparent=!0),M.parameters.normalMap?(k=THREE.ShaderLib.normalmap,A=THREE.UniformsUtils.clone(k.uniforms),m=M.parameters.color,O=M.parameters.specular,v=M.parameters.ambient,L=M.parameters.shininess,A.tNormal.value=T.textures[M.parameters.normalMap],M.parameters.normalScale&&A.uNormalScale.value.set(M.parameters.normalScale[0],M.parameters.normalScale[1]),M.parameters.map&&(A.tDiffuse.value=M.parameters.map,A.enableDiffuse.value=!0),M.parameters.envMap&&(A.tCube.value=M.parameters.envMap,A.enableReflection.value=!0,A.uReflectivity.value=M.parameters.reflectivity),M.parameters.lightMap&&(A.tAO.value=M.parameters.lightMap,A.enableAO.value=!0),M.parameters.specularMap&&(A.tSpecular.value=T.textures[M.parameters.specularMap],A.enableSpecular.value=!0),M.parameters.displacementMap&&(A.tDisplacement.value=T.textures[M.parameters.displacementMap],A.enableDisplacement.value=!0,A.uDisplacementBias.value=M.parameters.displacementBias,A.uDisplacementScale.value=M.parameters.displacementScale),A.uDiffuseColor.value.setHex(m),A.uSpecularColor.value.setHex(O),A.uAmbientColor.value.setHex(v),A.uShininess.value=L,M.parameters.opacity&&(A.uOpacity.value=M.parameters.opacity),p=new THREE.ShaderMaterial({fragmentShader:k.fragmentShader,vertexShader:k.vertexShader,uniforms:A,lights:!0,fog:!0})):p=new THREE[M.type](M.parameters),p.name=_,T.materials[_]=p}for(_ in C.materials)if(M=C.materials[_],M.parameters.materials){D=[];for(m=0;m<M.parameters.materials.length;m++)D.push(T.materials[M.parameters.materials[m]]);T.materials[_].materials=D}i(),T.cameras&&C.defaults.camera&&(T.currentCamera=T.cameras[C.defaults.camera]),T.fogs&&C.defaults.fog&&(T.scene.fog=T.fogs[C.defaults.fog]),l.callbackSync(T),f()},THREE.TextureLoader=function(){this.crossOrigin=null},THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(e){var t=this,n=new Image;n.addEventListener("load",function(){var e=new THREE.Texture(n);e.needsUpdate=!0,t.dispatchEvent({type:"load",content:e})},!1),n.addEventListener("error",function(){t.dispatchEvent({type:"error",message:"Couldn't load URL ["+e+"]"})},!1),t.crossOrigin&&(n.crossOrigin=t.crossOrigin),n.src=e}},THREE.Material=function(){this.id=THREE.MaterialIdCount++,this.name="",this.side=THREE.FrontSide,this.opacity=1,this.transparent=!1,this.blending=THREE.NormalBlending,this.blendSrc=THREE.SrcAlphaFactor,this.blendDst=THREE.OneMinusSrcAlphaFactor,this.blendEquation=THREE.AddEquation,this.depthWrite=this.depthTest=!0,this.polygonOffset=!1,this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.overdraw=!1,this.needsUpdate=this.visible=!0},THREE.Material.prototype={constructor:THREE.Material,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0===n)console.warn("THREE.Material: '"+t+"' parameter is undefined.");else if(t in this){var r=this[t];r instanceof THREE.Color?r.set(n):r instanceof THREE.Vector3&&n instanceof THREE.Vector3?r.copy(n):this[t]=n}}},clone:function(e){return void 0===e&&(e=new THREE.Material),e.name=this.name,e.side=this.side,e.opacity=this.opacity,e.transparent=this.transparent,e.blending=this.blending,e.blendSrc=this.blendSrc,e.blendDst=this.blendDst,e.blendEquation=this.blendEquation,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.polygonOffset=this.polygonOffset,e.polygonOffsetFactor=this.polygonOffsetFactor,e.polygonOffsetUnits=this.polygonOffsetUnits,e.alphaTest=this.alphaTest,e.overdraw=this.overdraw,e.visible=this.visible,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.MaterialIdCount=0,THREE.LineBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineBasicMaterial.prototype.clone=function(){var e=new THREE.LineBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.linecap=this.linecap,e.linejoin=this.linejoin,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.LineDashedMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.scale=this.linewidth=1,this.dashSize=3,this.gapSize=1,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype),THREE.LineDashedMaterial.prototype.clone=function(){var e=new THREE.LineDashedMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.linewidth=this.linewidth,e.scale=this.scale,e.dashSize=this.dashSize,e.gapSize=this.gapSize,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.MeshBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.envMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshBasicMaterial.prototype.clone=function(){var e=new THREE.MeshBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e},THREE.MeshLambertMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.envMap=this.specularMap=this.lightMap=this.map=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshLambertMaterial.prototype.clone=function(){var e=new THREE.MeshLambertMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshPhongMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.ambient=new THREE.Color(16777215),this.emissive=new THREE.Color(0),this.specular=new THREE.Color(1118481),this.shininess=30,this.metal=!1,this.perPixel=!0,this.wrapAround=!1,this.wrapRGB=new THREE.Vector3(1,1,1),this.bumpMap=this.lightMap=this.map=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new THREE.Vector2(1,1),this.envMap=this.specularMap=null,this.combine=THREE.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=THREE.SmoothShading,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshPhongMaterial.prototype.clone=function(){var e=new THREE.MeshPhongMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.ambient.copy(this.ambient),e.emissive.copy(this.emissive),e.specular.copy(this.specular),e.shininess=this.shininess,e.metal=this.metal,e.perPixel=this.perPixel,e.wrapAround=this.wrapAround,e.wrapRGB.copy(this.wrapRGB),e.map=this.map,e.lightMap=this.lightMap,e.bumpMap=this.bumpMap,e.bumpScale=this.bumpScale,e.normalMap=this.normalMap,e.normalScale.copy(this.normalScale),e.specularMap=this.specularMap,e.envMap=this.envMap,e.combine=this.combine,e.reflectivity=this.reflectivity,e.refractionRatio=this.refractionRatio,e.fog=this.fog,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.wireframeLinecap=this.wireframeLinecap,e.wireframeLinejoin=this.wireframeLinejoin,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.MeshDepthMaterial=function(e){THREE.Material.call(this),this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)},THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshDepthMaterial.prototype.clone=function(){var e=new THREE.MeshDepthMaterial;return THREE.Material.prototype.clone.call(this,e),e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshNormalMaterial=function(e){THREE.Material.call(this,e),this.shading=THREE.FlatShading,this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(e)},THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype),THREE.MeshNormalMaterial.prototype.clone=function(){var e=new THREE.MeshNormalMaterial;return THREE.Material.prototype.clone.call(this,e),e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e},THREE.MeshFaceMaterial=function(e){this.materials=e instanceof Array?e:[]},THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))},THREE.ParticleBasicMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.vertexColors=!1,this.fog=!0,this.setValues(e)},THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleBasicMaterial.prototype.clone=function(){var e=new THREE.ParticleBasicMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.size=this.size,e.sizeAttenuation=this.sizeAttenuation,e.vertexColors=this.vertexColors,e.fog=this.fog,e},THREE.ParticleCanvasMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.program=function(){},this.setValues(e)},THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ParticleCanvasMaterial.prototype.clone=function(){var e=new THREE.ParticleCanvasMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.program=this.program,e},THREE.ShaderMaterial=function(e){THREE.Material.call(this),this.vertexShader=this.fragmentShader="void main() {}",this.uniforms={},this.defines={},this.attributes=null,this.shading=THREE.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.lights=this.fog=!1,this.vertexColors=THREE.NoColors,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)},THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype),THREE.ShaderMaterial.prototype.clone=function(){var e=new THREE.ShaderMaterial;return THREE.Material.prototype.clone.call(this,e),e.fragmentShader=this.fragmentShader,e.vertexShader=this.vertexShader,e.uniforms=THREE.UniformsUtils.clone(this.uniforms),e.attributes=this.attributes,e.defines=this.defines,e.shading=this.shading,e.wireframe=this.wireframe,e.wireframeLinewidth=this.wireframeLinewidth,e.fog=this.fog,e.lights=this.lights,e.vertexColors=this.vertexColors,e.skinning=this.skinning,e.morphTargets=this.morphTargets,e.morphNormals=this.morphNormals,e},THREE.SpriteMaterial=function(e){THREE.Material.call(this),this.color=new THREE.Color(16777215),this.map=new THREE.Texture,this.useScreenCoordinates=!0,this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.scaleByViewport=!this.sizeAttenuation,this.alignment=THREE.SpriteAlignment.center.clone(),this.fog=!1,this.uvOffset=new THREE.Vector2(0,0),this.uvScale=new THREE.Vector2(1,1),this.setValues(e),e=e||{},void 0===e.depthTest&&(this.depthTest=!this.useScreenCoordinates),void 0===e.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates),void 0===e.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)},THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteMaterial.prototype.clone=function(){var e=new THREE.SpriteMaterial;return THREE.Material.prototype.clone.call(this,e),e.color.copy(this.color),e.map=this.map,e.useScreenCoordinates=this.useScreenCoordinates,e.sizeAttenuation=this.sizeAttenuation,e.scaleByViewport=this.scaleByViewport,e.alignment.copy(this.alignment),e.uvOffset.copy(this.uvOffset),e.uvScale.copy(this.uvScale),e.fog=this.fog,e},THREE.SpriteAlignment={},THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1),THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1),THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1),THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0),THREE.SpriteAlignment.center=new THREE.Vector2(0,0),THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0),THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1),THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1),THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1),THREE.Texture=function(e,t,n,r,i,s,o,u,a){this.id=THREE.TextureIdCount++,this.name="",this.image=e,this.mipmaps=[],this.mapping=void 0!==t?t:new THREE.UVMapping,this.wrapS=void 0!==n?n:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==r?r:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==i?i:THREE.LinearFilter,this.minFilter=void 0!==s?s:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==a?a:1,this.format=void 0!==o?o:THREE.RGBAFormat,this.type=void 0!==u?u:THREE.UnsignedByteType,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.needsUpdate=!1,this.onUpdate=null},THREE.Texture.prototype={constructor:THREE.Texture,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(e){return void 0===e&&(e=new THREE.Texture),e.image=this.image,e.mipmaps=this.mipmaps.slice(0),e.mapping=this.mapping,e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.format=this.format,e.type=this.type,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.generateMipmaps=this.generateMipmaps,e.premultiplyAlpha=this.premultiplyAlpha,e.flipY=this.flipY,e.unpackAlignment=this.unpackAlignment,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.TextureIdCount=0,THREE.CompressedTexture=function(e,t,n,r,i,s,o,u,a,f,l){THREE.Texture.call(this,null,s,o,u,a,f,r,i,l),this.image={width:t,height:n},this.mipmaps=e,this.generateMipmaps=!1},THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype),THREE.CompressedTexture.prototype.clone=function(){var e=new THREE.CompressedTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.DataTexture=function(e,t,n,r,i,s,o,u,a,f,l){THREE.Texture.call(this,null,s,o,u,a,f,r,i,l),this.image={data:e,width:t,height:n}},THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype),THREE.DataTexture.prototype.clone=function(){var e=new THREE.DataTexture;return THREE.Texture.prototype.clone.call(this,e),e},THREE.Particle=function(e){THREE.Object3D.call(this),this.material=e},THREE.Particle.prototype=Object.create(THREE.Object3D.prototype),THREE.Particle.prototype.clone=function(e){return void 0===e&&(e=new THREE.Particle(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.ParticleSystem=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.ParticleBasicMaterial({color:16777215*Math.random()}),this.sortParticles=!1,this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.frustumCulled=!1},THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype),THREE.ParticleSystem.prototype.clone=function(e){return void 0===e&&(e=new THREE.ParticleSystem(this.geometry,this.material)),e.sortParticles=this.sortParticles,THREE.Object3D.prototype.clone.call(this,e),e},THREE.Line=function(e,t,n){THREE.Object3D.call(this),this.geometry=e,this.material=void 0!==t?t:new THREE.LineBasicMaterial({color:16777215*Math.random()}),this.type=void 0!==n?n:THREE.LineStrip,this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())},THREE.LineStrip=0,THREE.LinePieces=1,THREE.Line.prototype=Object.create(THREE.Object3D.prototype),THREE.Line.prototype.clone=function(e){return void 0===e&&(e=new THREE.Line(this.geometry,this.material,this.type)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Mesh=function(e,t){THREE.Object3D.call(this),this.material=this.geometry=null,this.setGeometry(e),this.setMaterial(t)},THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype),THREE.Mesh.prototype.setGeometry=function(e){void 0!==e&&(this.geometry=e,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())},THREE.Mesh.prototype.setMaterial=function(e){this.material=void 0!==e?e:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})},THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetForcedOrder=[],this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var e=0,t=this.geometry.morphTargets.length;e<t;e++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[e].name]=e}},THREE.Mesh.prototype.getMorphTargetIndexByName=function(e){return void 0!==this.morphTargetDictionary[e]?this.morphTargetDictionary[e]:(console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+e+" does not exist. Returning 0."),0)},THREE.Mesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.Mesh(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Bone=function(e){THREE.Object3D.call(this),this.skin=e,this.skinMatrix=new THREE.Matrix4},THREE.Bone.prototype=Object.create(THREE.Object3D.prototype),THREE.Bone.prototype.update=function(e,t){this.matrixAutoUpdate&&(t|=this.updateMatrix());if(t||this.matrixWorldNeedsUpdate)e?this.skinMatrix.multiplyMatrices(e,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0;var n,r=this.children.length;for(n=0;n<r;n++)this.children[n].update(this.skinMatrix,t)},THREE.SkinnedMesh=function(e,t,n){THREE.Mesh.call(this,e,t),this.useVertexTexture=void 0!==n?n:!0,this.identityMatrix=new THREE.Matrix4,this.bones=[],this.boneMatrices=[];var r,i,s;if(this.geometry&&void 0!==this.geometry.bones){for(e=0;e<this.geometry.bones.length;e++)n=this.geometry.bones[e],r=n.pos,i=n.rotq,s=n.scl,t=this.addBone(),t.name=n.name,t.position.set(r[0],r[1],r[2]),t.quaternion.set(i[0],i[1],i[2],i[3]),t.useQuaternion=!0,void 0!==s?t.scale.set(s[0],s[1],s[2]):t.scale.set(1,1,1);for(e=0;e<this.bones.length;e++)n=this.geometry.bones[e],t=this.bones[e],-1===n.parent?this.add(t):this.bones[n.parent].add(t);e=this.bones.length,this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=e=256<e?64:64<e?32:16<e?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*e),this.pose()}},THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.SkinnedMesh.prototype.addBone=function(e){return void 0===e&&(e=new THREE.Bone(this)),this.bones.push(e),e},THREE.SkinnedMesh.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e)this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1;for(var e=0,t=this.children.length;e<t;e++){var n=this.children[e];n instanceof THREE.Bone?n.update(this.identityMatrix,!1):n.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[],e=0;for(t=this.bones.length;e<t;e++)n=new THREE.Matrix4,n.getInverse(this.bones[e].skinMatrix),this.boneInverses.push(n)}e=0;for(t=this.bones.length;e<t;e++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[e].skinMatrix,this.boneInverses[e]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*e);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)},THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var e=0;e<this.geometry.skinIndices.length;e++){var t=this.geometry.skinWeights[e],n=1/t.lengthManhattan();Infinity!==n?t.multiplyScalar(n):t.set(1)}},THREE.SkinnedMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)),THREE.Mesh.prototype.clone.call(this,e),e},THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4,THREE.MorphAnimMesh=function(e,t){THREE.Mesh.call(this,e,t),this.duration=1e3,this.mirroredLoop=!1,this.currentKeyframe=this.lastKeyframe=this.time=0,this.direction=1,this.directionBackwards=!1,this.setFrameRange(0,this.geometry.morphTargets.length-1)},THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphAnimMesh.prototype.setFrameRange=function(e,t){this.startKeyframe=e,this.endKeyframe=t,this.length=this.endKeyframe-this.startKeyframe+1},THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1,this.directionBackwards=!1},THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1,this.directionBackwards=!0},THREE.MorphAnimMesh.prototype.parseAnimations=function(){var e=this.geometry;e.animations||(e.animations={});for(var t,n=e.animations,r=/([a-z]+)(\d+)/,i=0,s=e.morphTargets.length;i<s;i++){var o=e.morphTargets[i].name.match(r);if(o&&1<o.length){o=o[1],n[o]||(n[o]={start:Infinity,end:-Infinity});var u=n[o];i<u.start&&(u.start=i),i>u.end&&(u.end=i),t||(t=o)}}e.firstAnimation=t},THREE.MorphAnimMesh.prototype.setAnimationLabel=function(e,t,n){this.geometry.animations||(this.geometry.animations={}),this.geometry.animations[e]={start:t,end:n}},THREE.MorphAnimMesh.prototype.playAnimation=function(e,t){var n=this.geometry.animations[e];n?(this.setFrameRange(n.start,n.end),this.duration=1e3*((n.end-n.start)/t),this.time=0):console.warn("animation["+e+"] undefined")},THREE.MorphAnimMesh.prototype.updateAnimation=function(e){var t=this.duration/this.length;this.time+=this.direction*e;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);e=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/t),0,this.length-1),e!==this.currentKeyframe&&(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[e]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=e),t=this.time%t/t,this.directionBackwards&&(t=1-t),this.morphTargetInfluences[this.currentKeyframe]=t,this.morphTargetInfluences[this.lastKeyframe]=1-t},THREE.MorphAnimMesh.prototype.clone=function(e){return void 0===e&&(e=new THREE.MorphAnimMesh(this.geometry,this.material)),e.duration=this.duration,e.mirroredLoop=this.mirroredLoop,e.time=this.time,e.lastKeyframe=this.lastKeyframe,e.currentKeyframe=this.currentKeyframe,e.direction=this.direction,e.directionBackwards=this.directionBackwards,THREE.Mesh.prototype.clone.call(this,e),e},THREE.Ribbon=function(e,t){THREE.Object3D.call(this),this.geometry=e,this.material=t},THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype),THREE.Ribbon.prototype.clone=function(e){return void 0===e&&(e=new THREE.Ribbon(this.geometry,this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.LOD=function(){THREE.Object3D.call(this),this.objects=[]},THREE.LOD.prototype=Object.create(THREE.Object3D.prototype),THREE.LOD.prototype.addLevel=function(e,t){void 0===t&&(t=0);for(var t=Math.abs(t),n=0;n<this.objects.length&&!(t<this.objects[n].distance);n++);this.objects.splice(n,0,{distance:t,object:e}),this.add(e)},THREE.LOD.prototype.getObjectForDistance=function(e){for(var t=1,n=this.objects.length;t<n&&!(e<this.objects[t].distance);t++);return this.objects[t-1].object},THREE.LOD.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Vector3;return function(n){if(1<this.objects.length){e.getPositionFromMatrix(n.matrixWorld),t.getPositionFromMatrix(this.matrixWorld),n=e.distanceTo(t),this.objects[0].object.visible=!0;for(var r=1,i=this.objects.length;r<i;r++){if(!(n>=this.objects[r].distance))break;this.objects[r-1].object.visible=!1,this.objects[r].object.visible=!0}for(;r<i;r++)this.objects[r].object.visible=!1}}}(),THREE.LOD.prototype.clone=function(){},THREE.Sprite=function(e){THREE.Object3D.call(this),this.material=void 0!==e?e:new THREE.SpriteMaterial,this.rotation3d=this.rotation,this.rotation=0},THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype),THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation),this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder),this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},THREE.Sprite.prototype.clone=function(e){return void 0===e&&(e=new THREE.Sprite(this.material)),THREE.Object3D.prototype.clone.call(this,e),e},THREE.Scene=function(){THREE.Object3D.call(this),this.overrideMaterial=this.fog=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]},THREE.Scene.prototype=Object.create(THREE.Object3D.prototype),THREE.Scene.prototype.__addObject=function(e){if(e instanceof THREE.Light)-1===this.__lights.indexOf(e)&&this.__lights.push(e),e.target&&void 0===e.target.parent&&this.add(e.target);else if(!(e instanceof THREE.Camera||e instanceof THREE.Bone)&&-1===this.__objects.indexOf(e)){this.__objects.push(e),this.__objectsAdded.push(e);var t=this.__objectsRemoved.indexOf(e);-1!==t&&this.__objectsRemoved.splice(t,1)}for(t=0;t<e.children.length;t++)this.__addObject(e.children[t])},THREE.Scene.prototype.__removeObject=function(e){if(e instanceof THREE.Light){var t=this.__lights.indexOf(e);-1!==t&&this.__lights.splice(t,1)}else e instanceof THREE.Camera||(t=this.__objects.indexOf(e),-1!==t&&(this.__objects.splice(t,1),this.__objectsRemoved.push(e),t=this.__objectsAdded.indexOf(e),-1!==t&&this.__objectsAdded.splice(t,1)));for(t=0;t<e.children.length;t++)this.__removeObject(e.children[t])},THREE.Fog=function(e,t,n){this.name="",this.color=new THREE.Color(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3},THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)},THREE.FogExp2=function(e,t){this.name="",this.color=new THREE.Color(e),this.density=void 0!==t?t:25e-5},THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)},THREE.CanvasRenderer=function(e){function t(e){x!==e&&(x=w.globalAlpha=e)}function n(e){T!==e&&(e===THREE.NormalBlending?w.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?w.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending&&(w.globalCompositeOperation="darker"),T=e)}function r(e){k!==e&&(k=w.lineWidth=e)}function i(e){L!==e&&(L=w.lineCap=e)}function s(e){A!==e&&(A=w.lineJoin=e)}function o(e){N!==e&&(N=w.strokeStyle=e)}function u(e){C!==e&&(C=w.fillStyle=e)}function a(e,t){if(O!==e||M!==t)w.setLineDash([e,t]),O=e,M=t}console.log("THREE.CanvasRenderer",THREE.REVISION);var f=THREE.Math.smoothstep,e=e||{},l=this,c,h,p,d=new THREE.Projector,v=void 0!==e.canvas?e.canvas:document.createElement("canvas"),m,g,y,b,w=v.getContext("2d"),E=new THREE.Color(0),S=0,x=1,T=0,N=null,C=null,k=null,L=null,A=null,O=null,M=0,_,D,P,H,B=new THREE.RenderableVertex,j=new THREE.RenderableVertex,F,I,q,R,U,z,W,X,V,$,J,K,Q=new THREE.Color,G=new THREE.Color,Y=new THREE.Color,Z=new THREE.Color,et=new THREE.Color,tt=new THREE.Color,nt=new THREE.Color,rt=new THREE.Color,it={},st={},ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt=new THREE.Box2,gt=new THREE.Box2,yt=new THREE.Box2,bt=new THREE.Color,wt=new THREE.Color,Et=new THREE.Color,St=new THREE.Vector3,xt,Tt,Nt,Ct,kt,Lt,At=16;xt=document.createElement("canvas"),xt.width=xt.height=2,Tt=xt.getContext("2d"),Tt.fillStyle="rgba(0,0,0,1)",Tt.fillRect(0,0,2,2),Nt=Tt.getImageData(0,0,2,2),Ct=Nt.data,kt=document.createElement("canvas"),kt.width=kt.height=At,Lt=kt.getContext("2d"),Lt.translate(-At/2,-At/2),Lt.scale(At,At),At--,void 0===w.setLineDash&&(w.setLineDash=void 0!==w.mozDash?function(e){w.mozDash=null!==e[0]?e:null}:function(){}),this.domElement=v,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.sortElements=this.sortObjects=this.autoClear=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.setSize=function(e,t,n){m=e*this.devicePixelRatio,g=t*this.devicePixelRatio,y=Math.floor(m/2),b=Math.floor(g/2),v.width=m,v.height=g,1!==this.devicePixelRatio&&!1!==n&&(v.style.width=e+"px",v.style.height=t+"px"),mt.set(new THREE.Vector2(-y,-b),new THREE.Vector2(y,b)),gt.set(new THREE.Vector2(-y,-b),new THREE.Vector2(y,b)),x=1,T=0,A=L=k=C=N=null},this.setClearColor=function(e,t){E.set(e),S=void 0!==t?t:1,gt.set(new THREE.Vector2(-y,-b),new THREE.Vector2(y,b))},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getMaxAnisotropy=function(){return 0},this.clear=function(){w.setTransform(1,0,0,-1,y,b),!1===gt.empty()&&(gt.intersect(mt),gt.expandByScalar(2),1>S&&w.clearRect(gt.min.x|0,gt.min.y|0,gt.max.x-gt.min.x|0,gt.max.y-gt.min.y|0),0<S&&(n(THREE.NormalBlending),t(1),u("rgba("+Math.floor(255*E.r)+","+Math.floor(255*E.g)+","+Math.floor(255*E.b)+","+S+")"),w.fillRect(gt.min.x|0,gt.min.y|0,gt.max.x-gt.min.x|0,gt.max.y-gt.min.y|0)),gt.makeEmpty())},this.render=function(e,v){function m(e,t,n){for(var r=0,i=p.length;r<i;r++){var s=p[r];rt.copy(s.color);if(s instanceof THREE.DirectionalLight){var o=St.getPositionFromMatrix(s.matrixWorld).normalize(),u=t.dot(o);0>=u||(u*=s.intensity,n.add(rt.multiplyScalar(u)))}else s instanceof THREE.PointLight&&(o=St.getPositionFromMatrix(s.matrixWorld),u=t.dot(St.subVectors(o,e).normalize()),0>=u||(u*=0==s.distance?1:1-Math.min(e.distanceTo(o)/s.distance,1),0!=u&&(u*=s.intensity,n.add(rt.multiplyScalar(u)))))}}function g(e,r,i,s,o,u,a,c){l.info.render.vertices+=3,l.info.render.faces++,t(c.opacity),n(c.blending),F=e.positionScreen.x,I=e.positionScreen.y,q=r.positionScreen.x,R=r.positionScreen.y,U=i.positionScreen.x,z=i.positionScreen.y,E(F,I,q,R,U,z),(c instanceof THREE.MeshLambertMaterial||c instanceof THREE.MeshPhongMaterial)&&null===c.map?(tt.copy(c.color),nt.copy(c.emissive),c.vertexColors===THREE.FaceColors&&tt.multiply(a.color),!1===c.wireframe&&c.shading==THREE.SmoothShading&&3==a.vertexNormalsLength?(G.copy(bt),Y.copy(bt),Z.copy(bt),m(a.v1.positionWorld,a.vertexNormalsModel[0],G),m(a.v2.positionWorld,a.vertexNormalsModel[1],Y),m(a.v3.positionWorld,a.vertexNormalsModel[2],Z),G.multiply(tt).add(nt),Y.multiply(tt).add(nt),Z.multiply(tt).add(nt),et.addColors(Y,Z).multiplyScalar(.5),at=k(G,Y,Z,et),C(F,I,q,R,U,z,0,0,1,0,0,1,at)):(Q.copy(bt),m(a.centroidModel,a.normalModel,Q),Q.multiply(tt).add(nt),!0===c.wireframe?x(Q,c.wireframeLinewidth,c.wireframeLinecap,c.wireframeLinejoin):T(Q))):c instanceof THREE.MeshBasicMaterial||c instanceof THREE.MeshLambertMaterial||c instanceof THREE.MeshPhongMaterial?null!==c.map?c.map.mapping instanceof THREE.UVMapping&&(ft=a.uvs[0],N(F,I,q,R,U,z,ft[s].x,ft[s].y,ft[o].x,ft[o].y,ft[u].x,ft[u].y,c.map)):null!==c.envMap?c.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(St.copy(a.vertexNormalsModelView[s]),lt=.5*St.x+.5,ct=.5*St.y+.5,St.copy(a.vertexNormalsModelView[o]),ht=.5*St.x+.5,pt=.5*St.y+.5,St.copy(a.vertexNormalsModelView[u]),dt=.5*St.x+.5,vt=.5*St.y+.5,N(F,I,q,R,U,z,lt,ct,ht,pt,dt,vt,c.envMap)):(Q.copy(c.color),c.vertexColors===THREE.FaceColors&&Q.multiply(a.color),!0===c.wireframe?x(Q,c.wireframeLinewidth,c.wireframeLinecap,c.wireframeLinejoin):T(Q)):c instanceof THREE.MeshDepthMaterial?(ot=v.near,ut=v.far,G.r=G.g=G.b=1-f(e.positionScreen.z*e.positionScreen.w,ot,ut),Y.r=Y.g=Y.b=1-f(r.positionScreen.z*r.positionScreen.w,ot,ut),Z.r=Z.g=Z.b=1-f(i.positionScreen.z*i.positionScreen.w,ot,ut),et.addColors(Y,Z).multiplyScalar(.5),at=k(G,Y,Z,et),C(F,I,q,R,U,z,0,0,1,0,0,1,at)):c instanceof THREE.MeshNormalMaterial&&(c.shading==THREE.FlatShading?(e=a.normalModelView,Q.setRGB(e.x,e.y,e.z).multiplyScalar(.5).addScalar(.5),!0===c.wireframe?x(Q,c.wireframeLinewidth,c.wireframeLinecap,c.wireframeLinejoin):T(Q)):c.shading==THREE.SmoothShading&&(e=a.vertexNormalsModelView[s],G.setRGB(e.x,e.y,e.z).multiplyScalar(.5).addScalar(.5),e=a.vertexNormalsModelView[o],Y.setRGB(e.x,e.y,e.z).multiplyScalar(.5).addScalar(.5),e=a.vertexNormalsModelView[u],Z.setRGB(e.x,e.y,e.z).multiplyScalar(.5).addScalar(.5),et.addColors(Y,Z).multiplyScalar(.5),at=k(G,Y,Z,et),C(F,I,q,R,U,z,0,0,1,0,0,1,at)))}function E(e,t,n,r,i,s){w.beginPath(),w.moveTo(e,t),w.lineTo(n,r),w.lineTo(i,s),w.closePath()}function S(e,t,n,r,i,s,o,u){w.beginPath(),w.moveTo(e,t),w.lineTo(n,r),w.lineTo(i,s),w.lineTo(o,u),w.closePath()}function x(e,t,n,u){r(t),i(n),s(u),o(e.getStyle()),w.stroke(),yt.expandByScalar(2*t)}function T(e){u(e.getStyle()),w.fill()}function N(e,t,n,r,i,s,o,a,f,l,c,h,p){if(!(p instanceof THREE.DataTexture||void 0===p.image||0==p.image.width)){if(!0===p.needsUpdate){var d=p.wrapS==THREE.RepeatWrapping,v=p.wrapT==THREE.RepeatWrapping;it[p.id]=w.createPattern(p.image,!0===d&&!0===v?"repeat":!0===d&&!1===v?"repeat-x":!1===d&&!0===v?"repeat-y":"no-repeat"),p.needsUpdate=!1}void 0===it[p.id]?u("rgba(0,0,0,1)"):u(it[p.id]);var d=p.offset.x/p.repeat.x,v=p.offset.y/p.repeat.y,m=p.image.width*p.repeat.x,g=p.image.height*p.repeat.y,o=(o+d)*m,a=(1-a+v)*g,n=n-e,r=r-t,i=i-e,s=s-t,f=(f+d)*m-o,l=(1-l+v)*g-a,c=(c+d)*m-o,h=(1-h+v)*g-a,d=f*h-c*l;0===d?(void 0===st[p.id]&&(t=document.createElement("canvas"),t.width=p.image.width,t.height=p.image.height,t=t.getContext("2d"),t.drawImage(p.image,0,0),st[p.id]=t.getImageData(0,0,p.image.width,p.image.height).data),t=st[p.id],o=4*(Math.floor(o)+Math.floor(a)*p.image.width),Q.setRGB(t[o]/255,t[o+1]/255,t[o+2]/255),T(Q)):(d=1/d,p=(h*n-l*i)*d,l=(h*r-l*s)*d,n=(f*i-c*n)*d,r=(f*s-c*r)*d,e=e-p*o-n*a,o=t-l*o-r*a,w.save(),w.transform(p,l,n,r,e,o),w.fill(),w.restore())}}function C(e,t,n,r,i,s,o,u,a,f,l,c,h){var p,d;p=h.width-1,d=h.height-1,o*=p,u*=d,n-=e,r-=t,i-=e,s-=t,a=a*p-o,f=f*d-u,l=l*p-o,c=c*d-u,d=1/(a*c-l*f),p=(c*n-f*i)*d,f=(c*r-f*s)*d,n=(a*i-l*n)*d,r=(a*s-l*r)*d,e=e-p*o-n*u,t=t-f*o-r*u,w.save(),w.transform(p,f,n,r,e,t),w.clip(),w.drawImage(h,0,0),w.restore()}function k(e,t,n,r){return Ct[0]=255*e.r|0,Ct[1]=255*e.g|0,Ct[2]=255*e.b|0,Ct[4]=255*t.r|0,Ct[5]=255*t.g|0,Ct[6]=255*t.b|0,Ct[8]=255*n.r|0,Ct[9]=255*n.g|0,Ct[10]=255*n.b|0,Ct[12]=255*r.r|0,Ct[13]=255*r.g|0,Ct[14]=255*r.b|0,Tt.putImageData(Nt,0,0),Lt.drawImage(xt,0,0),kt}function L(e,t){var n=t.x-e.x,r=t.y-e.y,i=n*n+r*r;0!==i&&(i=1/Math.sqrt(i),n*=i,r*=i,t.x+=n,t.y+=r,e.x-=n,e.y-=r)}if(0==v instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear(),w.setTransform(1,0,0,-1,y,b),l.info.render.vertices=0,l.info.render.faces=0,c=d.projectScene(e,v,this.sortObjects,this.sortElements),h=c.elements,p=c.lights,bt.setRGB(0,0,0),wt.setRGB(0,0,0),Et.setRGB(0,0,0);for(var A=0,O=p.length;A<O;A++){var M=p[A],At=M.color;M instanceof THREE.AmbientLight?bt.add(At):M instanceof THREE.DirectionalLight?wt.add(At):M instanceof THREE.PointLight&&Et.add(At)}A=0;for(O=h.length;A<O;A++){var Ot=h[A],M=Ot.material;if(void 0!==M&&!1!==M.visible){yt.makeEmpty();if(Ot instanceof THREE.RenderableParticle){_=Ot,_.x*=y,_.y*=b,At=_,t(M.opacity),n(M.blending);var Mt=void 0,_t=void 0,Dt=void 0,Pt=void 0,Ht=void 0,Bt=void 0,jt=void 0;M instanceof THREE.ParticleBasicMaterial?null===M.map?(Dt=Ot.object.scale.x,Pt=Ot.object.scale.y,Dt*=Ot.scale.x*y,Pt*=Ot.scale.y*b,yt.min.set(At.x-Dt,At.y-Pt),yt.max.set(At.x+Dt,At.y+Pt),!1===mt.isIntersectionBox(yt)?yt.makeEmpty():(u(M.color.getStyle()),w.save(),w.translate(At.x,At.y),w.rotate(-Ot.rotation),w.scale(Dt,Pt),w.fillRect(-1,-1,2,2),w.restore())):(Ht=M.map.image,Bt=Ht.width>>1,jt=Ht.height>>1,Dt=Ot.scale.x*y,Pt=Ot.scale.y*b,Mt=Dt*Bt,_t=Pt*jt,yt.min.set(At.x-Mt,At.y-_t),yt.max.set(At.x+Mt,At.y+_t),!1===mt.isIntersectionBox(yt)?yt.makeEmpty():(w.save(),w.translate(At.x,At.y),w.rotate(-Ot.rotation),w.scale(Dt,-Pt),w.translate(-Bt,-jt),w.drawImage(Ht,0,0),w.restore())):M instanceof THREE.ParticleCanvasMaterial&&(Mt=Ot.scale.x*y,_t=Ot.scale.y*b,yt.min.set(At.x-Mt,At.y-_t),yt.max.set(At.x+Mt,At.y+_t),!1===mt.isIntersectionBox(yt)?yt.makeEmpty():(o(M.color.getStyle()),u(M.color.getStyle()),w.save(),w.translate(At.x,At.y),w.rotate(-Ot.rotation),w.scale(Mt,_t),M.program(w),w.restore()))}else if(Ot instanceof THREE.RenderableLine){if(_=Ot.v1,D=Ot.v2,_.positionScreen.x*=y,_.positionScreen.y*=b,D.positionScreen.x*=y,D.positionScreen.y*=b,yt.setFromPoints([_.positionScreen,D.positionScreen]),!0===mt.isIntersectionBox(yt))if(At=_,Mt=D,t(M.opacity),n(M.blending),w.beginPath(),w.moveTo(At.positionScreen.x,At.positionScreen.y),w.lineTo(Mt.positionScreen.x,Mt.positionScreen.y),M instanceof THREE.LineBasicMaterial){r(M.linewidth),i(M.linecap),s(M.linejoin);if(M.vertexColors!==THREE.VertexColors)o(M.color.getStyle());else if(_t=Ot.vertexColors[0].getStyle(),Ot=Ot.vertexColors[1].getStyle(),_t===Ot)o(_t);else{try{var Ft=w.createLinearGradient(At.positionScreen.x,At.positionScreen.y,Mt.positionScreen.x,Mt.positionScreen.y);Ft.addColorStop(0,_t),Ft.addColorStop(1,Ot)}catch(It){Ft=_t}o(Ft)}w.stroke(),yt.expandByScalar(2*M.linewidth)}else M instanceof THREE.LineDashedMaterial&&(r(M.linewidth),i(M.linecap),s(M.linejoin),o(M.color.getStyle()),a(M.dashSize,M.gapSize),w.stroke(),yt.expandByScalar(2*M.linewidth),a(null,null))}else if(Ot instanceof THREE.RenderableFace3){_=Ot.v1,D=Ot.v2,P=Ot.v3;if(-1>_.positionScreen.z||1<_.positionScreen.z)continue;if(-1>D.positionScreen.z||1<D.positionScreen.z)continue;if(-1>P.positionScreen.z||1<P.positionScreen.z)continue;_.positionScreen.x*=y,_.positionScreen.y*=b,D.positionScreen.x*=y,D.positionScreen.y*=b,P.positionScreen.x*=y,P.positionScreen.y*=b,!0===M.overdraw&&(L(_.positionScreen,D.positionScreen),L(D.positionScreen,P.positionScreen),L(P.positionScreen,_.positionScreen)),yt.setFromPoints([_.positionScreen,D.positionScreen,P.positionScreen]),!0===mt.isIntersectionBox(yt)&&g(_,D,P,0,1,2,Ot,M)}else if(Ot instanceof THREE.RenderableFace4){_=Ot.v1,D=Ot.v2,P=Ot.v3,H=Ot.v4;if(-1>_.positionScreen.z||1<_.positionScreen.z)continue;if(-1>D.positionScreen.z||1<D.positionScreen.z)continue;if(-1>P.positionScreen.z||1<P.positionScreen.z)continue;if(-1>H.positionScreen.z||1<H.positionScreen.z)continue;_.positionScreen.x*=y,_.positionScreen.y*=b,D.positionScreen.x*=y,D.positionScreen.y*=b,P.positionScreen.x*=y,P.positionScreen.y*=b,H.positionScreen.x*=y,H.positionScreen.y*=b,B.positionScreen.copy(D.positionScreen),j.positionScreen.copy(H.positionScreen),!0===M.overdraw&&(L(_.positionScreen,D.positionScreen),L(D.positionScreen,H.positionScreen),L(H.positionScreen,_.positionScreen),L(P.positionScreen,B.positionScreen),L(P.positionScreen,j.positionScreen)),yt.setFromPoints([_.positionScreen,D.positionScreen,P.positionScreen,H.positionScreen]),!0===mt.isIntersectionBox(yt)&&(At=_,Mt=D,_t=P,Dt=H,Pt=B,Ht=j,l.info.render.vertices+=4,l.info.render.faces++,t(M.opacity),n(M.blending),void 0!==M.map&&null!==M.map||void 0!==M.envMap&&null!==M.envMap?(g(At,Mt,Dt,0,1,3,Ot,M),g(Pt,_t,Ht,1,2,3,Ot,M)):(F=At.positionScreen.x,I=At.positionScreen.y,q=Mt.positionScreen.x,R=Mt.positionScreen.y,U=_t.positionScreen.x,z=_t.positionScreen.y,W=Dt.positionScreen.x,X=Dt.positionScreen.y,V=Pt.positionScreen.x,$=Pt.positionScreen.y,J=Ht.positionScreen.x,K=Ht.positionScreen.y,M instanceof THREE.MeshLambertMaterial||M instanceof THREE.MeshPhongMaterial?(tt.copy(M.color),nt.copy(M.emissive),M.vertexColors===THREE.FaceColors&&tt.multiply(Ot.color),!1===M.wireframe&&M.shading==THREE.SmoothShading&&4==Ot.vertexNormalsLength?(G.copy(bt),Y.copy(bt),Z.copy(bt),et.copy(bt),m(Ot.v1.positionWorld,Ot.vertexNormalsModel[0],G),m(Ot.v2.positionWorld,Ot.vertexNormalsModel[1],Y),m(Ot.v4.positionWorld,Ot.vertexNormalsModel[3],Z),m(Ot.v3.positionWorld,Ot.vertexNormalsModel[2],et),G.multiply(tt).add(nt),Y.multiply(tt).add(nt),Z.multiply(tt).add(nt),et.multiply(tt).add(nt),at=k(G,Y,Z,et),E(F,I,q,R,W,X),C(F,I,q,R,W,X,0,0,1,0,0,1,at),E(V,$,U,z,J,K),C(V,$,U,z,J,K,1,0,1,1,0,1,at)):(Q.copy(bt),m(Ot.centroidModel,Ot.normalModel,Q),Q.multiply(tt).add(nt),S(F,I,q,R,U,z,W,X),!0===M.wireframe?x(Q,M.wireframeLinewidth,M.wireframeLinecap,M.wireframeLinejoin):T(Q))):M instanceof THREE.MeshBasicMaterial?(Q.copy(M.color),M.vertexColors===THREE.FaceColors&&Q.multiply(Ot.color),S(F,I,q,R,U,z,W,X),!0===M.wireframe?x(Q,M.wireframeLinewidth,M.wireframeLinecap,M.wireframeLinejoin):T(Q)):M instanceof THREE.MeshNormalMaterial?(At=void 0,M.shading==THREE.FlatShading?(At=Ot.normalModelView,Q.setRGB(At.x,At.y,At.z).multiplyScalar(.5).addScalar(.5),S(F,I,q,R,U,z,W,X),!0===M.wireframe?x(Q,M.wireframeLinewidth,M.wireframeLinecap,M.wireframeLinejoin):T(Q)):M.shading==THREE.SmoothShading&&(At=Ot.vertexNormalsModelView[0],G.setRGB(At.x,At.y,At.z).multiplyScalar(.5).addScalar(.5),At=Ot.vertexNormalsModelView[1],Y.setRGB(At.x,At.y,At.z).multiplyScalar(.5).addScalar(.5),At=Ot.vertexNormalsModelView[3],Z.setRGB(At.x,At.y,At.z).multiplyScalar(.5).addScalar(.5),At=Ot.vertexNormalsModelView[2],et.setRGB(At.x,At.y,At.z).multiplyScalar(.5).addScalar(.5),at=k(G,Y,Z,et),E(F,I,q,R,W,X),C(F,I,q,R,W,X,0,0,1,0,0,1,at),E(V,$,U,z,J,K),C(V,$,U,z,J,K,1,0,1,1,0,1,at))):M instanceof THREE.MeshDepthMaterial&&(ot=v.near,ut=v.far,G.r=G.g=G.b=1-f(At.positionScreen.z*At.positionScreen.w,ot,ut),Y.r=Y.g=Y.b=1-f(Mt.positionScreen.z*Mt.positionScreen.w,ot,ut),Z.r=Z.g=Z.b=1-f(Dt.positionScreen.z*Dt.positionScreen.w,ot,ut),et.r=et.g=et.b=1-f(_t.positionScreen.z*_t.positionScreen.w,ot,ut),at=k(G,Y,Z,et),E(F,I,q,R,W,X),C(F,I,q,R,W,X,0,0,1,0,0,1,at),E(V,$,U,z,J,K),C(V,$,U,z,J,K,1,0,1,1,0,1,at))))}gt.union(yt)}}w.setTransform(1,0,0,1,0,0)}}},THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned 	  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix 	+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"},THREE.UniformsUtils={merge:function(e){var t,n,r,i={};for(t=0;t<e.length;t++)for(n in r=this.clone(e[t]),r)i[n]=r[n];return i},clone:function(e){var t,n,r,i={};for(t in e)for(n in i[t]={},e[t])r=e[t][n],i[t][n]=r instanceof THREE.Color||r instanceof THREE.Vector2||r instanceof THREE.Vector3||r instanceof THREE.Vector4||r instanceof THREE.Matrix4||r instanceof THREE.Texture?r.clone():r instanceof Array?r.slice():r;return i}},THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}},THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:.98},uReflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned 	  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned 	  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}},THREE.WebGLRenderer=function(e){function t(e){if(e.__webglCustomAttributesList)for(var t in e.__webglCustomAttributesList)Tt.deleteBuffer(e.__webglCustomAttributesList[t].buffer)}function n(e,t){var n=e.vertices.length,r=t.material;if(r.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var i in r.attributes){var s=r.attributes[i];if(!s.__webglInitialized||s.createUniqueBuffers){s.__webglInitialized=!0;var o=1;"v2"===s.type?o=2:"v3"===s.type?o=3:"v4"===s.type?o=4:"c"===s.type&&(o=3),s.size=o,s.array=new Float32Array(n*o),s.buffer=Tt.createBuffer(),s.buffer.belongsToAttribute=i,s.needsUpdate=!0}e.__webglCustomAttributesList.push(s)}}}function r(e,t){var n=t.geometry,r=e.faces3,u=e.faces4,a=3*r.length+4*u.length,f=1*r.length+2*u.length,u=3*r.length+4*u.length,r=i(t,e),l=o(r),c=s(r),h=r.vertexColors?r.vertexColors:!1;e.__vertexArray=new Float32Array(3*a),c&&(e.__normalArray=new Float32Array(3*a)),n.hasTangents&&(e.__tangentArray=new Float32Array(4*a)),h&&(e.__colorArray=new Float32Array(3*a));if(l){if(0<n.faceUvs.length||0<n.faceVertexUvs.length)e.__uvArray=new Float32Array(2*a);if(1<n.faceUvs.length||1<n.faceVertexUvs.length)e.__uv2Array=new Float32Array(2*a)}t.geometry.skinWeights.length&&t.geometry.skinIndices.length&&(e.__skinIndexArray=new Float32Array(4*a),e.__skinWeightArray=new Float32Array(4*a)),e.__faceArray=new Uint16Array(3*f),e.__lineArray=new Uint16Array(2*u);if(e.numMorphTargets){e.__morphTargetsArrays=[],n=0;for(l=e.numMorphTargets;n<l;n++)e.__morphTargetsArrays.push(new Float32Array(3*a))}if(e.numMorphNormals){e.__morphNormalsArrays=[],n=0;for(l=e.numMorphNormals;n<l;n++)e.__morphNormalsArrays.push(new Float32Array(3*a))}e.__webglFaceCount=3*f,e.__webglLineCount=2*u;if(r.attributes){void 0===e.__webglCustomAttributesList&&(e.__webglCustomAttributesList=[]);for(var p in r.attributes){var f=r.attributes[p],n={},d;for(d in f)n[d]=f[d];if(!n.__webglInitialized||n.createUniqueBuffers)n.__webglInitialized=!0,u=1,"v2"===n.type?u=2:"v3"===n.type?u=3:"v4"===n.type?u=4:"c"===n.type&&(u=3),n.size=u,n.array=new Float32Array(a*u),n.buffer=Tt.createBuffer(),n.buffer.belongsToAttribute=p,f.needsUpdate=!0,n.__original=f;e.__webglCustomAttributesList.push(n)}}e.__inittedArrays=!0}function i(e,t){return e.material instanceof THREE.MeshFaceMaterial?e.material.materials[t.materialIndex]:e.material}function s(e){return e instanceof THREE.MeshBasicMaterial&&!e.envMap||e instanceof THREE.MeshDepthMaterial?!1:e&&void 0!==e.shading&&e.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function o(e){return e.map||e.lightMap||e.bumpMap||e.normalMap||e.specularMap||e instanceof THREE.ShaderMaterial?!0:!1}function u(e){mt[e]||(Tt.enableVertexAttribArray(e),mt[e]=!0)}function a(){for(var e in mt)mt[e]&&(Tt.disableVertexAttribArray(e),mt[e]=!1)}function f(e,t){return e.z!==t.z?t.z-e.z:e.id-t.id}function l(e,t){return t[0]-e[0]}function c(e,t,n){if(e.length)for(var r=0,i=e.length;r<i;r++)K=X=null,$=J=Z=Y=st=it=et=-1,St=!0,e[r].render(t,n,dt,vt),K=X=null,$=J=Z=Y=st=it=et=-1,St=!0}function h(e,t,n,r,i,s,o,u){var a,f,l,c;t?(f=e.length-1,c=t=-1):(f=0,t=e.length,c=1);for(var h=f;h!==t;h+=c)if(a=e[h],a.render){f=a.object,l=a.buffer;if(u)a=u;else{a=a[n];if(!a)continue;o&&U.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst),U.setDepthTest(a.depthTest),U.setDepthWrite(a.depthWrite),C(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}U.setMaterialFaces(a),l instanceof THREE.BufferGeometry?U.renderBufferDirect(r,i,s,a,l,f):U.renderBuffer(r,i,s,a,l,f)}}function p(e,t,n,r,i,s,o){for(var u,a,f=0,l=e.length;f<l;f++)if(u=e[f],a=u.object,a.visible){if(o)u=o;else{u=u[t];if(!u)continue;s&&U.setBlending(u.blending,u.blendEquation,u.blendSrc,u.blendDst),U.setDepthTest(u.depthTest),U.setDepthWrite(u.depthWrite),C(u.polygonOffset,u.polygonOffsetFactor,u.polygonOffsetUnits)}U.renderImmediateObject(n,r,i,u,a)}}function d(e,t){var i,s,o,u;if(void 0===e.__webglInit&&(e.__webglInit=!0,e._modelViewMatrix=new THREE.Matrix4,e._normalMatrix=new THREE.Matrix3,void 0!==e.geometry&&void 0===e.geometry.__webglInit&&(e.geometry.__webglInit=!0,e.geometry.addEventListener("dispose",Ut)),s=e.geometry,void 0!==s))if(s instanceof THREE.BufferGeometry){var a,f;for(a in s.attributes)f="index"===a?Tt.ELEMENT_ARRAY_BUFFER:Tt.ARRAY_BUFFER,u=s.attributes[a],u.buffer=Tt.createBuffer(),Tt.bindBuffer(f,u.buffer),Tt.bufferData(f,u.array,Tt.STATIC_DRAW)}else if(e instanceof THREE.Mesh){o=e.material;if(void 0===s.geometryGroups){a=s;var l,c,h,p,d;f={};var m=a.morphTargets.length,g=a.morphNormals.length,y=o instanceof THREE.MeshFaceMaterial;a.geometryGroups={},o=0;for(l=a.faces.length;o<l;o++)c=a.faces[o],h=y?c.materialIndex:0,void 0===f[h]&&(f[h]={hash:h,counter:0}),d=f[h].hash+"_"+f[h].counter,void 0===a.geometryGroups[d]&&(a.geometryGroups[d]={faces3:[],faces4:[],materialIndex:h,vertices:0,numMorphTargets:m,numMorphNormals:g}),p=c instanceof THREE.Face3?3:4,65535<a.geometryGroups[d].vertices+p&&(f[h].counter+=1,d=f[h].hash+"_"+f[h].counter,void 0===a.geometryGroups[d]&&(a.geometryGroups[d]={faces3:[],faces4:[],materialIndex:h,vertices:0,numMorphTargets:m,numMorphNormals:g})),c instanceof THREE.Face3?a.geometryGroups[d].faces3.push(o):a.geometryGroups[d].faces4.push(o),a.geometryGroups[d].vertices+=p;a.geometryGroupsList=[];for(u in a.geometryGroups)a.geometryGroups[u].id=Q++,a.geometryGroupsList.push(a.geometryGroups[u])}for(i in s.geometryGroups)if(u=s.geometryGroups[i],!u.__webglVertexBuffer){a=u,a.__webglVertexBuffer=Tt.createBuffer(),a.__webglNormalBuffer=Tt.createBuffer(),a.__webglTangentBuffer=Tt.createBuffer(),a.__webglColorBuffer=Tt.createBuffer(),a.__webglUVBuffer=Tt.createBuffer(),a.__webglUV2Buffer=Tt.createBuffer(),a.__webglSkinIndicesBuffer=Tt.createBuffer(),a.__webglSkinWeightsBuffer=Tt.createBuffer(),a.__webglFaceBuffer=Tt.createBuffer(),a.__webglLineBuffer=Tt.createBuffer(),m=f=void 0;if(a.numMorphTargets){a.__webglMorphTargetsBuffers=[],f=0;for(m=a.numMorphTargets;f<m;f++)a.__webglMorphTargetsBuffers.push(Tt.createBuffer())}if(a.numMorphNormals){a.__webglMorphNormalsBuffers=[],f=0;for(m=a.numMorphNormals;f<m;f++)a.__webglMorphNormalsBuffers.push(Tt.createBuffer())}U.info.memory.geometries++,r(u,e),s.verticesNeedUpdate=!0,s.morphTargetsNeedUpdate=!0,s.elementsNeedUpdate=!0,s.uvsNeedUpdate=!0,s.normalsNeedUpdate=!0,s.tangentsNeedUpdate=!0,s.colorsNeedUpdate=!0}}else e instanceof THREE.Ribbon?s.__webglVertexBuffer||(u=s,u.__webglVertexBuffer=Tt.createBuffer(),u.__webglColorBuffer=Tt.createBuffer(),u.__webglNormalBuffer=Tt.createBuffer(),U.info.memory.geometries++,u=s,a=u.vertices.length,u.__vertexArray=new Float32Array(3*a),u.__colorArray=new Float32Array(3*a),u.__normalArray=new Float32Array(3*a),u.__webglVertexCount=a,n(u,e),s.verticesNeedUpdate=!0,s.colorsNeedUpdate=!0,s.normalsNeedUpdate=!0):e instanceof THREE.Line?s.__webglVertexBuffer||(u=s,u.__webglVertexBuffer=Tt.createBuffer(),u.__webglColorBuffer=Tt.createBuffer(),u.__webglLineDistanceBuffer=Tt.createBuffer(),U.info.memory.geometries++,u=s,a=u.vertices.length,u.__vertexArray=new Float32Array(3*a),u.__colorArray=new Float32Array(3*a),u.__lineDistanceArray=new Float32Array(1*a),u.__webglLineCount=a,n(u,e),s.verticesNeedUpdate=!0,s.colorsNeedUpdate=!0,s.lineDistancesNeedUpdate=!0):e instanceof THREE.ParticleSystem&&!s.__webglVertexBuffer&&(u=s,u.__webglVertexBuffer=Tt.createBuffer(),u.__webglColorBuffer=Tt.createBuffer(),U.info.memory.geometries++,u=s,a=u.vertices.length,u.__vertexArray=new Float32Array(3*a),u.__colorArray=new Float32Array(3*a),u.__sortArray=[],u.__webglParticleCount=a,n(u,e),s.verticesNeedUpdate=!0,s.colorsNeedUpdate=!0);if(void 0===e.__webglActive){if(e instanceof THREE.Mesh){if(s=e.geometry,s instanceof THREE.BufferGeometry)v(t.__webglObjects,s,e);else if(s instanceof THREE.Geometry)for(i in s.geometryGroups)u=s.geometryGroups[i],v(t.__webglObjects,u,e)}else e instanceof THREE.Ribbon||e instanceof THREE.Line||e instanceof THREE.ParticleSystem?(s=e.geometry,v(t.__webglObjects,s,e)):e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback?t.__webglObjectsImmediate.push({object:e,opaque:null,transparent:null}):e instanceof THREE.Sprite?t.__webglSprites.push(e):e instanceof THREE.LensFlare&&t.__webglFlares.push(e);e.__webglActive=!0}}function v(e,t,n){e.push({buffer:t,object:n,opaque:null,transparent:null})}function m(e){for(var t in e.attributes)if(e.attributes[t].needsUpdate)return!0;return!1}function g(e){for(var t in e.attributes)e.attributes[t].needsUpdate=!1}function y(e,t){e instanceof THREE.Mesh||e instanceof THREE.ParticleSystem||e instanceof THREE.Ribbon||e instanceof THREE.Line?b(t.__webglObjects,e):e instanceof THREE.Sprite?w(t.__webglSprites,e):e instanceof THREE.LensFlare?w(t.__webglFlares,e):(e instanceof THREE.ImmediateRenderObject||e.immediateRenderCallback)&&b(t.__webglObjectsImmediate,e),delete e.__webglActive}function b(e,t){for(var n=e.length-1;0<=n;n--)e[n].object===t&&e.splice(n,1)}function w(e,t){for(var n=e.length-1;0<=n;n--)e[n]===t&&e.splice(n,1)}function E(e,t,n,r,i){G=0,r.needsUpdate&&(r.program&&Vt(r),U.initMaterial(r,t,n,i),r.needsUpdate=!1),r.morphTargets&&!i.__webglMorphTargetInfluences&&(i.__webglMorphTargetInfluences=new Float32Array(U.maxMorphTargets));var s=!1,o=r.program,u=o.uniforms,a=r.uniforms;o!==X&&(Tt.useProgram(o),X=o,s=!0),r.id!==$&&($=r.id,s=!0);if(s||e!==K)Tt.uniformMatrix4fv(u.projectionMatrix,!1,e.projectionMatrix.elements),e!==K&&(K=e);if(r.skinning)if(Ht&&i.useVertexTexture){if(null!==u.boneTexture){var f=S();Tt.uniform1i(u.boneTexture,f),U.setTexture(i.boneTexture,f)}}else null!==u.boneGlobalMatrices&&Tt.uniformMatrix4fv(u.boneGlobalMatrices,!1,i.boneMatrices);if(s){n&&r.fog&&(a.fogColor.value=n.color,n instanceof THREE.Fog?(a.fogNear.value=n.near,a.fogFar.value=n.far):n instanceof THREE.FogExp2&&(a.fogDensity.value=n.density));if(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r.lights){if(St){for(var l,c=f=0,h=0,p,d,v,m=xt,g=m.directional.colors,y=m.directional.positions,b=m.point.colors,w=m.point.positions,E=m.point.distances,N=m.spot.colors,C=m.spot.positions,k=m.spot.distances,L=m.spot.directions,O=m.spot.anglesCos,M=m.spot.exponents,P=m.hemi.skyColors,H=m.hemi.groundColors,B=m.hemi.positions,j=0,F=0,I=0,q=0,R=0,z=0,W=0,V=0,J=l=0,n=v=J=0,s=t.length;n<s;n++)l=t[n],l.onlyShadow||(p=l.color,d=l.intensity,v=l.distance,l instanceof THREE.AmbientLight?l.visible&&(U.gammaInput?(f+=p.r*p.r,c+=p.g*p.g,h+=p.b*p.b):(f+=p.r,c+=p.g,h+=p.b)):l instanceof THREE.DirectionalLight?(R+=1,l.visible&&(Et.getPositionFromMatrix(l.matrixWorld),wt.getPositionFromMatrix(l.target.matrixWorld),Et.sub(wt),Et.normalize(),0===Et.x&&0===Et.y&&0===Et.z||(l=3*j,y[l]=Et.x,y[l+1]=Et.y,y[l+2]=Et.z,U.gammaInput?x(g,l,p,d*d):T(g,l,p,d),j+=1))):l instanceof THREE.PointLight?(z+=1,l.visible&&(J=3*F,U.gammaInput?x(b,J,p,d*d):T(b,J,p,d),wt.getPositionFromMatrix(l.matrixWorld),w[J]=wt.x,w[J+1]=wt.y,w[J+2]=wt.z,E[F]=v,F+=1)):l instanceof THREE.SpotLight?(W+=1,l.visible&&(J=3*I,U.gammaInput?x(N,J,p,d*d):T(N,J,p,d),wt.getPositionFromMatrix(l.matrixWorld),C[J]=wt.x,C[J+1]=wt.y,C[J+2]=wt.z,k[I]=v,Et.copy(wt),wt.getPositionFromMatrix(l.target.matrixWorld),Et.sub(wt),Et.normalize(),L[J]=Et.x,L[J+1]=Et.y,L[J+2]=Et.z,O[I]=Math.cos(l.angle),M[I]=l.exponent,I+=1)):l instanceof THREE.HemisphereLight&&(V+=1,l.visible&&(Et.getPositionFromMatrix(l.matrixWorld),Et.normalize(),0===Et.x&&0===Et.y&&0===Et.z||(v=3*q,B[v]=Et.x,B[v+1]=Et.y,B[v+2]=Et.z,p=l.color,l=l.groundColor,U.gammaInput?(d*=d,x(P,v,p,d),x(H,v,l,d)):(T(P,v,p,d),T(H,v,l,d)),q+=1))));n=3*j;for(s=Math.max(g.length,3*R);n<s;n++)g[n]=0;n=3*F;for(s=Math.max(b.length,3*z);n<s;n++)b[n]=0;n=3*I;for(s=Math.max(N.length,3*W);n<s;n++)N[n]=0;n=3*q;for(s=Math.max(P.length,3*V);n<s;n++)P[n]=0;n=3*q;for(s=Math.max(H.length,3*V);n<s;n++)H[n]=0;m.directional.length=j,m.point.length=F,m.spot.length=I,m.hemi.length=q,m.ambient[0]=f,m.ambient[1]=c,m.ambient[2]=h,St=!1}n=xt,a.ambientLightColor.value=n.ambient,a.directionalLightColor.value=n.directional.colors,a.directionalLightDirection.value=n.directional.positions,a.pointLightColor.value=n.point.colors,a.pointLightPosition.value=n.point.positions,a.pointLightDistance.value=n.point.distances,a.spotLightColor.value=n.spot.colors,a.spotLightPosition.value=n.spot.positions,a.spotLightDistance.value=n.spot.distances,a.spotLightDirection.value=n.spot.directions,a.spotLightAngleCos.value=n.spot.anglesCos,a.spotLightExponent.value=n.spot.exponents,a.hemisphereLightSkyColor.value=n.hemi.skyColors,a.hemisphereLightGroundColor.value=n.hemi.groundColors,a.hemisphereLightDirection.value=n.hemi.positions}if(r instanceof THREE.MeshBasicMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial){a.opacity.value=r.opacity,U.gammaInput?a.diffuse.value.copyGammaToLinear(r.color):a.diffuse.value=r.color,a.map.value=r.map,a.lightMap.value=r.lightMap,a.specularMap.value=r.specularMap,r.bumpMap&&(a.bumpMap.value=r.bumpMap,a.bumpScale.value=r.bumpScale),r.normalMap&&(a.normalMap.value=r.normalMap,a.normalScale.value.copy(r.normalScale));var Q;r.map?Q=r.map:r.specularMap?Q=r.specularMap:r.normalMap?Q=r.normalMap:r.bumpMap&&(Q=r.bumpMap),void 0!==Q&&(n=Q.offset,Q=Q.repeat,a.offsetRepeat.value.set(n.x,n.y,Q.x,Q.y)),a.envMap.value=r.envMap,a.flipEnvMap.value=r.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,a.reflectivity.value=r.reflectivity,a.refractionRatio.value=r.refractionRatio,a.combine.value=r.combine,a.useRefract.value=r.envMap&&r.envMap.mapping instanceof THREE.CubeRefractionMapping}r instanceof THREE.LineBasicMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity):r instanceof THREE.LineDashedMaterial?(a.diffuse.value=r.color,a.opacity.value=r.opacity,a.dashSize.value=r.dashSize,a.totalSize.value=r.dashSize+r.gapSize,a.scale.value=r.scale):r instanceof THREE.ParticleBasicMaterial?(a.psColor.value=r.color,a.opacity.value=r.opacity,a.size.value=r.size,a.scale.value=D.height/2,a.map.value=r.map):r instanceof THREE.MeshPhongMaterial?(a.shininess.value=r.shininess,U.gammaInput?(a.ambient.value.copyGammaToLinear(r.ambient),a.emissive.value.copyGammaToLinear(r.emissive),a.specular.value.copyGammaToLinear(r.specular)):(a.ambient.value=r.ambient,a.emissive.value=r.emissive,a.specular.value=r.specular),r.wrapAround&&a.wrapRGB.value.copy(r.wrapRGB)):r instanceof THREE.MeshLambertMaterial?(U.gammaInput?(a.ambient.value.copyGammaToLinear(r.ambient),a.emissive.value.copyGammaToLinear(r.emissive)):(a.ambient.value=r.ambient,a.emissive.value=r.emissive),r.wrapAround&&a.wrapRGB.value.copy(r.wrapRGB)):r instanceof THREE.MeshDepthMaterial?(a.mNear.value=e.near,a.mFar.value=e.far,a.opacity.value=r.opacity):r instanceof THREE.MeshNormalMaterial&&(a.opacity.value=r.opacity);if(i.receiveShadow&&!r._shadowPass&&a.shadowMatrix){n=Q=0;for(s=t.length;n<s;n++)if(f=t[n],f.castShadow&&(f instanceof THREE.SpotLight||f instanceof THREE.DirectionalLight&&!f.shadowCascade))a.shadowMap.value[Q]=f.shadowMap,a.shadowMapSize.value[Q]=f.shadowMapSize,a.shadowMatrix.value[Q]=f.shadowMatrix,a.shadowDarkness.value[Q]=f.shadowDarkness,a.shadowBias.value[Q]=f.shadowBias,Q++}t=r.uniformsList,a=0;for(Q=t.length;a<Q;a++)if(s=o.uniforms[t[a][1]])if(n=t[a][0],c=n.type,f=n.value,"i"===c)Tt.uniform1i(s,f);else if("f"===c)Tt.uniform1f(s,f);else if("v2"===c)Tt.uniform2f(s,f.x,f.y);else if("v3"===c)Tt.uniform3f(s,f.x,f.y,f.z);else if("v4"===c)Tt.uniform4f(s,f.x,f.y,f.z,f.w);else if("c"===c)Tt.uniform3f(s,f.r,f.g,f.b);else if("iv1"===c)Tt.uniform1iv(s,f);else if("iv"===c)Tt.uniform3iv(s,f);else if("fv1"===c)Tt.uniform1fv(s,f);else if("fv"===c)Tt.uniform3fv(s,f);else if("v2v"===c){void 0===n._array&&(n._array=new Float32Array(2*f.length)),c=0;for(h=f.length;c<h;c++)m=2*c,n._array[m]=f[c].x,n._array[m+1]=f[c].y;Tt.uniform2fv(s,n._array)}else if("v3v"===c){void 0===n._array&&(n._array=new Float32Array(3*f.length)),c=0;for(h=f.length;c<h;c++)m=3*c,n._array[m]=f[c].x,n._array[m+1]=f[c].y,n._array[m+2]=f[c].z;Tt.uniform3fv(s,n._array)}else if("v4v"===c){void 0===n._array&&(n._array=new Float32Array(4*f.length)),c=0;for(h=f.length;c<h;c++)m=4*c,n._array[m]=f[c].x,n._array[m+1]=f[c].y,n._array[m+2]=f[c].z,n._array[m+3]=f[c].w;Tt.uniform4fv(s,n._array)}else if("m4"===c)void 0===n._array&&(n._array=new Float32Array(16)),f.flattenToArray(n._array),Tt.uniformMatrix4fv(s,!1,n._array);else if("m4v"===c){void 0===n._array&&(n._array=new Float32Array(16*f.length)),c=0;for(h=f.length;c<h;c++)f[c].flattenToArrayOffset(n._array,16*c);Tt.uniformMatrix4fv(s,!1,n._array)}else if("t"===c){if(m=f,f=S(),Tt.uniform1i(s,f),m)if(m.image instanceof Array&&6===m.image.length){if(n=m,s=f,6===n.image.length)if(n.needsUpdate){n.image.__webglTextureCube||(n.image.__webglTextureCube=Tt.createTexture(),U.info.memory.textures++),Tt.activeTexture(Tt.TEXTURE0+s),Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,n.image.__webglTextureCube),Tt.pixelStorei(Tt.UNPACK_FLIP_Y_WEBGL,n.flipY),s=n instanceof THREE.CompressedTexture,f=[];for(c=0;6>c;c++)U.autoScaleCubemaps&&!s?(h=f,m=c,g=n.image[c],b=_t,g.width<=b&&g.height<=b||(w=Math.max(g.width,g.height),y=Math.floor(g.width*b/w),b=Math.floor(g.height*b/w),w=document.createElement("canvas"),w.width=y,w.height=b,w.getContext("2d").drawImage(g,0,0,g.width,g.height,0,0,y,b),g=w),h[m]=g):f[c]=n.image[c];c=f[0],h=0===(c.width&c.width-1)&&0===(c.height&c.height-1),m=_(n.format),g=_(n.type),A(Tt.TEXTURE_CUBE_MAP,n,h);for(c=0;6>c;c++)if(s){b=f[c].mipmaps,w=0;for(E=b.length;w<E;w++)y=b[w],Tt.compressedTexImage2D(Tt.TEXTURE_CUBE_MAP_POSITIVE_X+c,w,m,y.width,y.height,0,y.data)}else Tt.texImage2D(Tt.TEXTURE_CUBE_MAP_POSITIVE_X+c,0,m,m,g,f[c]);n.generateMipmaps&&h&&Tt.generateMipmap(Tt.TEXTURE_CUBE_MAP),n.needsUpdate=!1,n.onUpdate&&n.onUpdate()}else Tt.activeTexture(Tt.TEXTURE0+s),Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,n.image.__webglTextureCube)}else m instanceof THREE.WebGLRenderTargetCube?(n=m,Tt.activeTexture(Tt.TEXTURE0+f),Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,n.__webglTexture)):U.setTexture(m,f)}else if("tv"===c){void 0===n._array&&(n._array=[]),c=0;for(h=n.value.length;c<h;c++)n._array[c]=S();Tt.uniform1iv(s,n._array),c=0;for(h=n.value.length;c<h;c++)m=n.value[c],f=n._array[c],m&&U.setTexture(m,f)}(r instanceof THREE.ShaderMaterial||r instanceof THREE.MeshPhongMaterial||r.envMap)&&null!==u.cameraPosition&&(wt.getPositionFromMatrix(e.matrixWorld),Tt.uniform3f(u.cameraPosition,wt.x,wt.y,wt.z)),(r instanceof THREE.MeshPhongMaterial||r instanceof THREE.MeshLambertMaterial||r instanceof THREE.ShaderMaterial||r.skinning)&&null!==u.viewMatrix&&Tt.uniformMatrix4fv(u.viewMatrix,!1,e.matrixWorldInverse.elements)}return Tt.uniformMatrix4fv(u.modelViewMatrix,!1,i._modelViewMatrix.elements),u.normalMatrix&&Tt.uniformMatrix3fv(u.normalMatrix,!1,i._normalMatrix.elements),null!==u.modelMatrix&&Tt.uniformMatrix4fv(u.modelMatrix,!1,i.matrixWorld.elements),o}function S(){var e=G;return e>=Ot&&console.warn("WebGLRenderer: trying to use "+e+" texture units while this GPU supports only "+Ot),G+=1,e}function x(e,t,n,r){e[t]=n.r*n.r*r,e[t+1]=n.g*n.g*r,e[t+2]=n.b*n.b*r}function T(e,t,n,r){e[t]=n.r*r,e[t+1]=n.g*r,e[t+2]=n.b*r}function N(e){e!==ft&&(Tt.lineWidth(e),ft=e)}function C(e,t,n){ot!==e&&(e?Tt.enable(Tt.POLYGON_OFFSET_FILL):Tt.disable(Tt.POLYGON_OFFSET_FILL),ot=e),e&&(ut!==t||at!==n)&&(Tt.polygonOffset(t,n),ut=t,at=n)}function k(e){for(var e=e.split("\n"),t=0,n=e.length;t<n;t++)e[t]=t+1+": "+e[t];return e.join("\n")}function L(e,t){var n;return"fragment"===e?n=Tt.createShader(Tt.FRAGMENT_SHADER):"vertex"===e&&(n=Tt.createShader(Tt.VERTEX_SHADER)),Tt.shaderSource(n,t),Tt.compileShader(n),Tt.getShaderParameter(n,Tt.COMPILE_STATUS)?n:(console.error(Tt.getShaderInfoLog(n)),console.error(k(t)),null)}function A(e,t,n){n?(Tt.texParameteri(e,Tt.TEXTURE_WRAP_S,_(t.wrapS)),Tt.texParameteri(e,Tt.TEXTURE_WRAP_T,_(t.wrapT)),Tt.texParameteri(e,Tt.TEXTURE_MAG_FILTER,_(t.magFilter)),Tt.texParameteri(e,Tt.TEXTURE_MIN_FILTER,_(t.minFilter))):(Tt.texParameteri(e,Tt.TEXTURE_WRAP_S,Tt.CLAMP_TO_EDGE),Tt.texParameteri(e,Tt.TEXTURE_WRAP_T,Tt.CLAMP_TO_EDGE),Tt.texParameteri(e,Tt.TEXTURE_MAG_FILTER,M(t.magFilter)),Tt.texParameteri(e,Tt.TEXTURE_MIN_FILTER,M(t.minFilter))),kt&&t.type!==THREE.FloatType&&(1<t.anisotropy||t.__oldAnisotropy)&&(Tt.texParameterf(e,kt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,Dt)),t.__oldAnisotropy=t.anisotropy)}function O(e,t){Tt.bindRenderbuffer(Tt.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(Tt.renderbufferStorage(Tt.RENDERBUFFER,Tt.DEPTH_COMPONENT16,t.width,t.height),Tt.framebufferRenderbuffer(Tt.FRAMEBUFFER,Tt.DEPTH_ATTACHMENT,Tt.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(Tt.renderbufferStorage(Tt.RENDERBUFFER,Tt.DEPTH_STENCIL,t.width,t.height),Tt.framebufferRenderbuffer(Tt.FRAMEBUFFER,Tt.DEPTH_STENCIL_ATTACHMENT,Tt.RENDERBUFFER,e)):Tt.renderbufferStorage(Tt.RENDERBUFFER,Tt.RGBA4,t.width,t.height)}function M(e){return e===THREE.NearestFilter||e===THREE.NearestMipMapNearestFilter||e===THREE.NearestMipMapLinearFilter?Tt.NEAREST:Tt.LINEAR}function _(e){if(e===THREE.RepeatWrapping)return Tt.REPEAT;if(e===THREE.ClampToEdgeWrapping)return Tt.CLAMP_TO_EDGE;if(e===THREE.MirroredRepeatWrapping)return Tt.MIRRORED_REPEAT;if(e===THREE.NearestFilter)return Tt.NEAREST;if(e===THREE.NearestMipMapNearestFilter)return Tt.NEAREST_MIPMAP_NEAREST;if(e===THREE.NearestMipMapLinearFilter)return Tt.NEAREST_MIPMAP_LINEAR;if(e===THREE.LinearFilter)return Tt.LINEAR;if(e===THREE.LinearMipMapNearestFilter)return Tt.LINEAR_MIPMAP_NEAREST;if(e===THREE.LinearMipMapLinearFilter)return Tt.LINEAR_MIPMAP_LINEAR;if(e===THREE.UnsignedByteType)return Tt.UNSIGNED_BYTE;if(e===THREE.UnsignedShort4444Type)return Tt.UNSIGNED_SHORT_4_4_4_4;if(e===THREE.UnsignedShort5551Type)return Tt.UNSIGNED_SHORT_5_5_5_1;if(e===THREE.UnsignedShort565Type)return Tt.UNSIGNED_SHORT_5_6_5;if(e===THREE.ByteType)return Tt.BYTE;if(e===THREE.ShortType)return Tt.SHORT;if(e===THREE.UnsignedShortType)return Tt.UNSIGNED_SHORT;if(e===THREE.IntType)return Tt.INT;if(e===THREE.UnsignedIntType)return Tt.UNSIGNED_INT;if(e===THREE.FloatType)return Tt.FLOAT;if(e===THREE.AlphaFormat)return Tt.ALPHA;if(e===THREE.RGBFormat)return Tt.RGB;if(e===THREE.RGBAFormat)return Tt.RGBA;if(e===THREE.LuminanceFormat)return Tt.LUMINANCE;if(e===THREE.LuminanceAlphaFormat)return Tt.LUMINANCE_ALPHA;if(e===THREE.AddEquation)return Tt.FUNC_ADD;if(e===THREE.SubtractEquation)return Tt.FUNC_SUBTRACT;if(e===THREE.ReverseSubtractEquation)return Tt.FUNC_REVERSE_SUBTRACT;if(e===THREE.ZeroFactor)return Tt.ZERO;if(e===THREE.OneFactor)return Tt.ONE;if(e===THREE.SrcColorFactor)return Tt.SRC_COLOR;if(e===THREE.OneMinusSrcColorFactor)return Tt.ONE_MINUS_SRC_COLOR;if(e===THREE.SrcAlphaFactor)return Tt.SRC_ALPHA;if(e===THREE.OneMinusSrcAlphaFactor)return Tt.ONE_MINUS_SRC_ALPHA;if(e===THREE.DstAlphaFactor)return Tt.DST_ALPHA;if(e===THREE.OneMinusDstAlphaFactor)return Tt.ONE_MINUS_DST_ALPHA;if(e===THREE.DstColorFactor)return Tt.DST_COLOR;if(e===THREE.OneMinusDstColorFactor)return Tt.ONE_MINUS_DST_COLOR;if(e===THREE.SrcAlphaSaturateFactor)return Tt.SRC_ALPHA_SATURATE;if(void 0!==Lt){if(e===THREE.RGB_S3TC_DXT1_Format)return Lt.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT1_Format)return Lt.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===THREE.RGBA_S3TC_DXT3_Format)return Lt.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===THREE.RGBA_S3TC_DXT5_Format)return Lt.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);var e=e||{},D=void 0!==e.canvas?e.canvas:document.createElement("canvas"),P=void 0!==e.precision?e.precision:"highp",H=void 0!==e.alpha?e.alpha:!0,B=void 0!==e.premultipliedAlpha?e.premultipliedAlpha:!0,j=void 0!==e.antialias?e.antialias:!1,F=void 0!==e.stencil?e.stencil:!0,I=void 0!==e.preserveDrawingBuffer?e.preserveDrawingBuffer:!1,q=new THREE.Color(0),R=0;void 0!==e.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),q.setHex(e.clearColor)),void 0!==e.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),R=e.clearAlpha),this.domElement=D,this.context=null,this.devicePixelRatio=void 0!==e.devicePixelRatio?e.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1,this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1,this.shadowMapAutoUpdate=!0,this.shadowMapType=THREE.PCFShadowMap,this.shadowMapCullFace=THREE.CullFaceFront,this.shadowMapCascade=this.shadowMapDebug=!1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0,this.renderPluginsPre=[],this.renderPluginsPost=[],this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var U=this,z=[],W=0,X=null,V=null,$=-1,J=null,K=null,Q=0,G=0,Y=-1,Z=-1,et=-1,tt=-1,nt=-1,rt=-1,it=-1,st=-1,ot=null,ut=null,at=null,ft=null,lt=0,ct=0,ht=0,pt=0,dt=0,vt=0,mt={},gt=new THREE.Frustum,yt=new THREE.Matrix4,bt=new THREE.Matrix4,wt=new THREE.Vector3,Et=new THREE.Vector3,St=!0,xt={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},Tt,Nt,Ct,kt,Lt;try{if(!(Tt=D.getContext("experimental-webgl",{alpha:H,premultipliedAlpha:B,antialias:j,stencil:F,preserveDrawingBuffer:I})))throw"Error creating WebGL context."}catch(At){console.error(At)}Nt=Tt.getExtension("OES_texture_float"),Ct=Tt.getExtension("OES_standard_derivatives"),kt=Tt.getExtension("EXT_texture_filter_anisotropic")||Tt.getExtension("MOZ_EXT_texture_filter_anisotropic")||Tt.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),Lt=Tt.getExtension("WEBGL_compressed_texture_s3tc")||Tt.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||Tt.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),Nt||console.log("THREE.WebGLRenderer: Float textures not supported."),Ct||console.log("THREE.WebGLRenderer: Standard derivatives not supported."),kt||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported."),Lt||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported."),void 0===Tt.getShaderPrecisionFormat&&(Tt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),Tt.clearColor(0,0,0,1),Tt.clearDepth(1),Tt.clearStencil(0),Tt.enable(Tt.DEPTH_TEST),Tt.depthFunc(Tt.LEQUAL),Tt.frontFace(Tt.CCW),Tt.cullFace(Tt.BACK),Tt.enable(Tt.CULL_FACE),Tt.enable(Tt.BLEND),Tt.blendEquation(Tt.FUNC_ADD),Tt.blendFunc(Tt.SRC_ALPHA,Tt.ONE_MINUS_SRC_ALPHA),Tt.clearColor(q.r,q.g,q.b,R),this.context=Tt;var Ot=Tt.getParameter(Tt.MAX_TEXTURE_IMAGE_UNITS),Mt=Tt.getParameter(Tt.MAX_VERTEX_TEXTURE_IMAGE_UNITS);Tt.getParameter(Tt.MAX_TEXTURE_SIZE);var _t=Tt.getParameter(Tt.MAX_CUBE_MAP_TEXTURE_SIZE),Dt=kt?Tt.getParameter(kt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,Pt=0<Mt,Ht=Pt&&Nt;Lt&&Tt.getParameter(Tt.COMPRESSED_TEXTURE_FORMATS);var Bt=Tt.getShaderPrecisionFormat(Tt.VERTEX_SHADER,Tt.HIGH_FLOAT),jt=Tt.getShaderPrecisionFormat(Tt.VERTEX_SHADER,Tt.MEDIUM_FLOAT);Tt.getShaderPrecisionFormat(Tt.VERTEX_SHADER,Tt.LOW_FLOAT);var Ft=Tt.getShaderPrecisionFormat(Tt.FRAGMENT_SHADER,Tt.HIGH_FLOAT),It=Tt.getShaderPrecisionFormat(Tt.FRAGMENT_SHADER,Tt.MEDIUM_FLOAT);Tt.getShaderPrecisionFormat(Tt.FRAGMENT_SHADER,Tt.LOW_FLOAT),Tt.getShaderPrecisionFormat(Tt.VERTEX_SHADER,Tt.HIGH_INT),Tt.getShaderPrecisionFormat(Tt.VERTEX_SHADER,Tt.MEDIUM_INT),Tt.getShaderPrecisionFormat(Tt.VERTEX_SHADER,Tt.LOW_INT),Tt.getShaderPrecisionFormat(Tt.FRAGMENT_SHADER,Tt.HIGH_INT),Tt.getShaderPrecisionFormat(Tt.FRAGMENT_SHADER,Tt.MEDIUM_INT),Tt.getShaderPrecisionFormat(Tt.FRAGMENT_SHADER,Tt.LOW_INT);var qt=0<Bt.precision&&0<Ft.precision,Rt=0<jt.precision&&0<It.precision;"highp"===P&&!qt&&(Rt?(P="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(P="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp"))),"mediump"===P&&!Rt&&(P="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp")),this.getContext=function(){return Tt},this.supportsVertexTextures=function(){return Pt},this.supportsFloatTextures=function(){return Nt},this.supportsStandardDerivatives=function(){return Ct},this.supportsCompressedTextureS3TC=function(){return Lt},this.getMaxAnisotropy=function(){return Dt},this.getPrecision=function(){return P},this.setSize=function(e,t,n){D.width=e*this.devicePixelRatio,D.height=t*this.devicePixelRatio,1!==this.devicePixelRatio&&!1!==n&&(D.style.width=e+"px",D.style.height=t+"px"),this.setViewport(0,0,D.width,D.height)},this.setViewport=function(e,t,n,r){lt=void 0!==e?e:0,ct=void 0!==t?t:0,ht=void 0!==n?n:D.width,pt=void 0!==r?r:D.height,Tt.viewport(lt,ct,ht,pt)},this.setScissor=function(e,t,n,r){Tt.scissor(e,t,n,r)},this.enableScissorTest=function(e){e?Tt.enable(Tt.SCISSOR_TEST):Tt.disable(Tt.SCISSOR_TEST)},this.setClearColor=function(e,t){q.set(e),R=void 0!==t?t:1,Tt.clearColor(q.r,q.g,q.b,R)},this.setClearColorHex=function(e,t){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return q},this.getClearAlpha=function(){return R},this.clear=function(e,t,n){var r=0;if(void 0===e||e)r|=Tt.COLOR_BUFFER_BIT;if(void 0===t||t)r|=Tt.DEPTH_BUFFER_BIT;if(void 0===n||n)r|=Tt.STENCIL_BUFFER_BIT;Tt.clear(r)},this.clearTarget=function(e,t,n,r){this.setRenderTarget(e),this.clear(t,n,r)},this.addPostPlugin=function(e){e.init(this),this.renderPluginsPost.push(e)},this.addPrePlugin=function(e){e.init(this),this.renderPluginsPre.push(e)},this.updateShadowMap=function(e,t){X=null,$=J=st=it=et=-1,St=!0,Z=Y=-1,this.shadowMapPlugin.update(e,t)};var Ut=function(e){e=e.target,e.removeEventListener("dispose",Ut),e.__webglInit=void 0,void 0!==e.__webglVertexBuffer&&Tt.deleteBuffer(e.__webglVertexBuffer),void 0!==e.__webglNormalBuffer&&Tt.deleteBuffer(e.__webglNormalBuffer),void 0!==e.__webglTangentBuffer&&Tt.deleteBuffer(e.__webglTangentBuffer),void 0!==e.__webglColorBuffer&&Tt.deleteBuffer(e.__webglColorBuffer),void 0!==e.__webglUVBuffer&&Tt.deleteBuffer(e.__webglUVBuffer),void 0!==e.__webglUV2Buffer&&Tt.deleteBuffer(e.__webglUV2Buffer),void 0!==e.__webglSkinIndicesBuffer&&Tt.deleteBuffer(e.__webglSkinIndicesBuffer),void 0!==e.__webglSkinWeightsBuffer&&Tt.deleteBuffer(e.__webglSkinWeightsBuffer),void 0!==e.__webglFaceBuffer&&Tt.deleteBuffer(e.__webglFaceBuffer),void 0!==e.__webglLineBuffer&&Tt.deleteBuffer(e.__webglLineBuffer),void 0!==e.__webglLineDistanceBuffer&&Tt.deleteBuffer(e.__webglLineDistanceBuffer);if(void 0!==e.geometryGroups)for(var n in e.geometryGroups){var r=e.geometryGroups[n];if(void 0!==r.numMorphTargets)for(var i=0,s=r.numMorphTargets;i<s;i++)Tt.deleteBuffer(r.__webglMorphTargetsBuffers[i]);if(void 0!==r.numMorphNormals){i=0;for(s=r.numMorphNormals;i<s;i++)Tt.deleteBuffer(r.__webglMorphNormalsBuffers[i])}t(r)}t(e),U.info.memory.geometries--},zt=function(e){e=e.target,e.removeEventListener("dispose",zt),e.image&&e.image.__webglTextureCube?Tt.deleteTexture(e.image.__webglTextureCube):e.__webglInit&&(e.__webglInit=!1,Tt.deleteTexture(e.__webglTexture)),U.info.memory.textures--},Wt=function(e){e=e.target,e.removeEventListener("dispose",Wt);if(e&&e.__webglTexture)if(Tt.deleteTexture(e.__webglTexture),e instanceof THREE.WebGLRenderTargetCube)for(var t=0;6>t;t++)Tt.deleteFramebuffer(e.__webglFramebuffer[t]),Tt.deleteRenderbuffer(e.__webglRenderbuffer[t]);else Tt.deleteFramebuffer(e.__webglFramebuffer),Tt.deleteRenderbuffer(e.__webglRenderbuffer);U.info.memory.textures--},Xt=function(e){e=e.target,e.removeEventListener("dispose",Xt),Vt(e)},Vt=function(e){var t=e.program;if(void 0!==t){e.program=void 0;var n,r,i=!1,e=0;for(n=z.length;e<n;e++)if(r=z[e],r.program===t){r.usedTimes--,0===r.usedTimes&&(i=!0);break}if(!0===i){i=[],e=0;for(n=z.length;e<n;e++)r=z[e],r.program!==t&&i.push(r);z=i,Tt.deleteProgram(t),U.info.memory.programs--}}};this.renderBufferImmediate=function(e,t,n){e.hasPositions&&!e.__webglVertexBuffer&&(e.__webglVertexBuffer=Tt.createBuffer()),e.hasNormals&&!e.__webglNormalBuffer&&(e.__webglNormalBuffer=Tt.createBuffer()),e.hasUvs&&!e.__webglUvBuffer&&(e.__webglUvBuffer=Tt.createBuffer()),e.hasColors&&!e.__webglColorBuffer&&(e.__webglColorBuffer=Tt.createBuffer()),e.hasPositions&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,e.__webglVertexBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,e.positionArray,Tt.DYNAMIC_DRAW),Tt.enableVertexAttribArray(t.attributes.position),Tt.vertexAttribPointer(t.attributes.position,3,Tt.FLOAT,!1,0,0));if(e.hasNormals){Tt.bindBuffer(Tt.ARRAY_BUFFER,e.__webglNormalBuffer);if(n.shading===THREE.FlatShading){var r,i,s,o,u,a,f,l,c,h,p,d=3*e.count;for(p=0;p<d;p+=9)h=e.normalArray,r=h[p],i=h[p+1],s=h[p+2],o=h[p+3],a=h[p+4],l=h[p+5],u=h[p+6],f=h[p+7],c=h[p+8],r=(r+o+u)/3,i=(i+a+f)/3,s=(s+l+c)/3,h[p]=r,h[p+1]=i,h[p+2]=s,h[p+3]=r,h[p+4]=i,h[p+5]=s,h[p+6]=r,h[p+7]=i,h[p+8]=s}Tt.bufferData(Tt.ARRAY_BUFFER,e.normalArray,Tt.DYNAMIC_DRAW),Tt.enableVertexAttribArray(t.attributes.normal),Tt.vertexAttribPointer(t.attributes.normal,3,Tt.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,e.__webglUvBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,e.uvArray,Tt.DYNAMIC_DRAW),Tt.enableVertexAttribArray(t.attributes.uv),Tt.vertexAttribPointer(t.attributes.uv,2,Tt.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==THREE.NoColors&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,e.__webglColorBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,e.colorArray,Tt.DYNAMIC_DRAW),Tt.enableVertexAttribArray(t.attributes.color),Tt.vertexAttribPointer(t.attributes.color,3,Tt.FLOAT,!1,0,0)),Tt.drawArrays(Tt.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,s){if(!1!==r.visible){var o,f,l;o=E(e,t,n,r,s),e=o.attributes,t=i.attributes,n=!1,o=16777215*i.id+2*o.id+(r.wireframe?1:0),o!==J&&(J=o,n=!0),n&&a();if(s instanceof THREE.Mesh)if(r=t.index){i=i.offsets,1<i.length&&(n=!0);for(var c=0,h=i.length;c<h;c++){var p=i[c].index;if(n){for(f in t)"index"!==f&&(o=e[f],s=t[f],l=s.itemSize,0<=o&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,s.buffer),u(o),Tt.vertexAttribPointer(o,l,Tt.FLOAT,!1,0,4*p*l)));Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,r.buffer)}Tt.drawElements(Tt.TRIANGLES,i[c].count,Tt.UNSIGNED_SHORT,2*i[c].start),U.info.render.calls++,U.info.render.vertices+=i[c].count,U.info.render.faces+=i[c].count/3}}else{if(n)for(f in t)"index"!==f&&(o=e[f],s=t[f],l=s.itemSize,0<=o&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,s.buffer),u(o),Tt.vertexAttribPointer(o,l,Tt.FLOAT,!1,0,0)));f=i.attributes.position,Tt.drawArrays(Tt.TRIANGLES,0,f.numItems/3),U.info.render.calls++,U.info.render.vertices+=f.numItems/3,U.info.render.faces+=f.numItems/3/3}else if(s instanceof THREE.ParticleSystem){if(n){for(f in t)o=e[f],s=t[f],l=s.itemSize,0<=o&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,s.buffer),u(o),Tt.vertexAttribPointer(o,l,Tt.FLOAT,!1,0,0));f=t.position,Tt.drawArrays(Tt.POINTS,0,f.numItems/3),U.info.render.calls++,U.info.render.points+=f.numItems/3}}else if(s instanceof THREE.Line&&n){for(f in t)o=e[f],s=t[f],l=s.itemSize,0<=o&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,s.buffer),u(o),Tt.vertexAttribPointer(o,l,Tt.FLOAT,!1,0,0));N(r.linewidth),f=t.position,Tt.drawArrays(Tt.LINE_STRIP,0,f.numItems/3),U.info.render.calls++,U.info.render.points+=f.numItems}}},this.renderBuffer=function(e,t,n,r,i,s){if(!1!==r.visible){var o,f,n=E(e,t,n,r,s),e=n.attributes,t=!1,n=16777215*i.id+2*n.id+(r.wireframe?1:0);n!==J&&(J=n,t=!0),t&&a();if(!r.morphTargets&&0<=e.position)t&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglVertexBuffer),u(e.position),Tt.vertexAttribPointer(e.position,3,Tt.FLOAT,!1,0,0));else if(s.morphTargetBase){n=r.program.attributes,-1!==s.morphTargetBase&&0<=n.position?(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglMorphTargetsBuffers[s.morphTargetBase]),u(n.position),Tt.vertexAttribPointer(n.position,3,Tt.FLOAT,!1,0,0)):0<=n.position&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglVertexBuffer),u(n.position),Tt.vertexAttribPointer(n.position,3,Tt.FLOAT,!1,0,0));if(s.morphTargetForcedOrder.length){var c=0;f=s.morphTargetForcedOrder;for(o=s.morphTargetInfluences;c<r.numSupportedMorphTargets&&c<f.length;)0<=n["morphTarget"+c]&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglMorphTargetsBuffers[f[c]]),u(n["morphTarget"+c]),Tt.vertexAttribPointer(n["morphTarget"+c],3,Tt.FLOAT,!1,0,0)),0<=n["morphNormal"+c]&&r.morphNormals&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglMorphNormalsBuffers[f[c]]),u(n["morphNormal"+c]),Tt.vertexAttribPointer(n["morphNormal"+c],3,Tt.FLOAT,!1,0,0)),s.__webglMorphTargetInfluences[c]=o[f[c]],c++}else{f=[],o=s.morphTargetInfluences;var h,p=o.length;for(h=0;h<p;h++)c=o[h],0<c&&f.push([c,h]);f.length>r.numSupportedMorphTargets?(f.sort(l),f.length=r.numSupportedMorphTargets):f.length>r.numSupportedMorphNormals?f.sort(l):0===f.length&&f.push([0,0]);for(c=0;c<r.numSupportedMorphTargets;)f[c]?(h=f[c][1],0<=n["morphTarget"+c]&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglMorphTargetsBuffers[h]),u(n["morphTarget"+c]),Tt.vertexAttribPointer(n["morphTarget"+c],3,Tt.FLOAT,!1,0,0)),0<=n["morphNormal"+c]&&r.morphNormals&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglMorphNormalsBuffers[h]),u(n["morphNormal"+c]),Tt.vertexAttribPointer(n["morphNormal"+c],3,Tt.FLOAT,!1,0,0)),s.__webglMorphTargetInfluences[c]=o[h]):s.__webglMorphTargetInfluences[c]=0,c++}null!==r.program.uniforms.morphTargetInfluences&&Tt.uniform1fv(r.program.uniforms.morphTargetInfluences,s.__webglMorphTargetInfluences)}if(t){if(i.__webglCustomAttributesList){o=0;for(f=i.__webglCustomAttributesList.length;o<f;o++)n=i.__webglCustomAttributesList[o],0<=e[n.buffer.belongsToAttribute]&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,n.buffer),u(e[n.buffer.belongsToAttribute]),Tt.vertexAttribPointer(e[n.buffer.belongsToAttribute],n.size,Tt.FLOAT,!1,0,0))}0<=e.color&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglColorBuffer),u(e.color),Tt.vertexAttribPointer(e.color,3,Tt.FLOAT,!1,0,0)),0<=e.normal&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglNormalBuffer),u(e.normal),Tt.vertexAttribPointer(e.normal,3,Tt.FLOAT,!1,0,0)),0<=e.tangent&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglTangentBuffer),u(e.tangent),Tt.vertexAttribPointer(e.tangent,4,Tt.FLOAT,!1,0,0)),0<=e.uv&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglUVBuffer),u(e.uv),Tt.vertexAttribPointer(e.uv,2,Tt.FLOAT,!1,0,0)),0<=e.uv2&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglUV2Buffer),u(e.uv2),Tt.vertexAttribPointer(e.uv2,2,Tt.FLOAT,!1,0,0)),r.skinning&&0<=e.skinIndex&&0<=e.skinWeight&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglSkinIndicesBuffer),u(e.skinIndex),Tt.vertexAttribPointer(e.skinIndex,4,Tt.FLOAT,!1,0,0),Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglSkinWeightsBuffer),u(e.skinWeight),Tt.vertexAttribPointer(e.skinWeight,4,Tt.FLOAT,!1,0,0)),0<=e.lineDistance&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,i.__webglLineDistanceBuffer),u(e.lineDistance),Tt.vertexAttribPointer(e.lineDistance,1,Tt.FLOAT,!1,0,0))}s instanceof THREE.Mesh?(r.wireframe?(N(r.wireframeLinewidth),t&&Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,i.__webglLineBuffer),Tt.drawElements(Tt.LINES,i.__webglLineCount,Tt.UNSIGNED_SHORT,0)):(t&&Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,i.__webglFaceBuffer),Tt.drawElements(Tt.TRIANGLES,i.__webglFaceCount,Tt.UNSIGNED_SHORT,0)),U.info.render.calls++,U.info.render.vertices+=i.__webglFaceCount,U.info.render.faces+=i.__webglFaceCount/3):s instanceof THREE.Line?(s=s.type===THREE.LineStrip?Tt.LINE_STRIP:Tt.LINES,N(r.linewidth),Tt.drawArrays(s,0,i.__webglLineCount),U.info.render.calls++):s instanceof THREE.ParticleSystem?(Tt.drawArrays(Tt.POINTS,0,i.__webglParticleCount),U.info.render.calls++,U.info.render.points+=i.__webglParticleCount):s instanceof THREE.Ribbon&&(Tt.drawArrays(Tt.TRIANGLE_STRIP,0,i.__webglVertexCount),U.info.render.calls++)}},this.render=function(e,t,n,r){if(0==t instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var i,s,o,u,a=e.__lights,l=e.fog;$=-1,St=!0,!0===e.autoUpdate&&e.updateMatrixWorld(),void 0===t.parent&&t.updateMatrixWorld(),t.matrixWorldInverse.getInverse(t.matrixWorld),yt.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),gt.setFromMatrix(yt),this.autoUpdateObjects&&this.initWebGLObjects(e),c(this.renderPluginsPre,e,t),U.info.render.calls=0,U.info.render.vertices=0,U.info.render.faces=0,U.info.render.points=0,this.setRenderTarget(n),(this.autoClear||r)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),u=e.__webglObjects,r=0;for(i=u.length;r<i;r++)if(s=u[r],o=s.object,s.id=r,s.render=!1,o.visible&&(!(o instanceof THREE.Mesh||o instanceof THREE.ParticleSystem)||!o.frustumCulled||gt.intersectsObject(o))){var d=o;d._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,d.matrixWorld),d._normalMatrix.getNormalMatrix(d._modelViewMatrix);var d=s,v=d.buffer,m=void 0,g=m=void 0,g=d.object.material;if(g instanceof THREE.MeshFaceMaterial)m=v.materialIndex,m=g.materials[m],m.transparent?(d.transparent=m,d.opaque=null):(d.opaque=m,d.transparent=null);else if(m=g)m.transparent?(d.transparent=m,d.opaque=null):(d.opaque=m,d.transparent=null);s.render=!0,!0===this.sortObjects&&(null!==o.renderDepth?s.z=o.renderDepth:(wt.getPositionFromMatrix(o.matrixWorld),wt.applyProjection(yt),s.z=wt.z))}this.sortObjects&&u.sort(f),u=e.__webglObjectsImmediate,r=0;for(i=u.length;r<i;r++)s=u[r],o=s.object,o.visible&&(o._modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,o.matrixWorld),o._normalMatrix.getNormalMatrix(o._modelViewMatrix),o=s.object.material,o.transparent?(s.transparent=o,s.opaque=null):(s.opaque=o,s.transparent=null));e.overrideMaterial?(r=e.overrideMaterial,this.setBlending(r.blending,r.blendEquation,r.blendSrc,r.blendDst),this.setDepthTest(r.depthTest),this.setDepthWrite(r.depthWrite),C(r.polygonOffset,r.polygonOffsetFactor,r.polygonOffsetUnits),h(e.__webglObjects,!1,"",t,a,l,!0,r),p(e.__webglObjectsImmediate,"",t,a,l,!1,r)):(r=null,this.setBlending(THREE.NoBlending),h(e.__webglObjects,!0,"opaque",t,a,l,!1,r),p(e.__webglObjectsImmediate,"opaque",t,a,l,!1,r),h(e.__webglObjects,!1,"transparent",t,a,l,!0,r),p(e.__webglObjectsImmediate,"transparent",t,a,l,!0,r)),c(this.renderPluginsPost,e,t),n&&n.generateMipmaps&&n.minFilter!==THREE.NearestFilter&&n.minFilter!==THREE.LinearFilter&&(n instanceof THREE.WebGLRenderTargetCube?(Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,n.__webglTexture),Tt.generateMipmap(Tt.TEXTURE_CUBE_MAP),Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,null)):(Tt.bindTexture(Tt.TEXTURE_2D,n.__webglTexture),Tt.generateMipmap(Tt.TEXTURE_2D),Tt.bindTexture(Tt.TEXTURE_2D,null))),this.setDepthTest(!0),this.setDepthWrite(!0)}},this.renderImmediateObject=function(e,t,n,r,i){var s=E(e,t,n,r,i);J=-1,U.setMaterialFaces(r),i.immediateRenderCallback?i.immediateRenderCallback(s,Tt,gt):i.render(function(e){U.renderBufferImmediate(e,s,r)})},this.initWebGLObjects=function(e){e.__webglObjects||(e.__webglObjects=[],e.__webglObjectsImmediate=[],e.__webglSprites=[],e.__webglFlares=[]);for(;e.__objectsAdded.length;)d(e.__objectsAdded[0],e),e.__objectsAdded.splice(0,1);for(;e.__objectsRemoved.length;)y(e.__objectsRemoved[0],e),e.__objectsRemoved.splice(0,1);for(var t=0,n=e.__webglObjects.length;t<n;t++){var u=e.__webglObjects[t].object;void 0===u.__webglInit&&(void 0!==u.__webglActive&&y(u,e),d(u,e));var a=u,f=a.geometry,c=void 0,h=void 0,p=void 0;if(f instanceof THREE.BufferGeometry){var v=Tt.DYNAMIC_DRAW,b=!f.dynamic,w=f.attributes,E=void 0,S=void 0;for(E in w)S=w[E],S.needsUpdate&&("index"===E?(Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,S.buffer),Tt.bufferData(Tt.ELEMENT_ARRAY_BUFFER,S.array,v)):(Tt.bindBuffer(Tt.ARRAY_BUFFER,S.buffer),Tt.bufferData(Tt.ARRAY_BUFFER,S.array,v)),S.needsUpdate=!1),b&&!S.dynamic&&delete S.array}else if(a instanceof THREE.Mesh){for(var x=0,T=f.geometryGroupsList.length;x<T;x++)if(c=f.geometryGroupsList[x],p=i(a,c),f.buffersNeedUpdate&&r(c,a),h=p.attributes&&m(p),f.verticesNeedUpdate||f.morphTargetsNeedUpdate||f.elementsNeedUpdate||f.uvsNeedUpdate||f.normalsNeedUpdate||f.colorsNeedUpdate||f.tangentsNeedUpdate||h){var N=c,C=a,k=Tt.DYNAMIC_DRAW,L=!f.dynamic,A=p;if(N.__inittedArrays){var O=s(A),M=A.vertexColors?A.vertexColors:!1,_=o(A),D=O===THREE.SmoothShading,P=void 0,H=void 0,B=void 0,j=void 0,F=void 0,I=void 0,q=void 0,R=void 0,U=void 0,z=void 0,W=void 0,X=void 0,V=void 0,$=void 0,J=void 0,K=void 0,Q=void 0,G=void 0,Y=void 0,Z=void 0,et=void 0,tt=void 0,nt=void 0,rt=void 0,it=void 0,st=void 0,ot=void 0,ut=void 0,at=void 0,ft=void 0,lt=void 0,ct=void 0,ht=void 0,pt=void 0,dt=void 0,vt=void 0,mt=void 0,gt=void 0,Et=void 0,St=void 0,xt=void 0,Nt=void 0,Ct=void 0,kt=void 0,Lt=void 0,At=void 0,Ot=0,Mt=0,_t=0,Dt=0,Pt=0,Ht=0,Bt=0,jt=0,Ft=0,It=0,qt=0,Rt=0,Ut=void 0,zt=N.__vertexArray,Wt=N.__uvArray,Xt=N.__uv2Array,Vt=N.__normalArray,$t=N.__tangentArray,Jt=N.__colorArray,Kt=N.__skinIndexArray,Qt=N.__skinWeightArray,Gt=N.__morphTargetsArrays,Yt=N.__morphNormalsArrays,Zt=N.__webglCustomAttributesList,en=void 0,tn=N.__faceArray,nn=N.__lineArray,rn=C.geometry,sn=rn.elementsNeedUpdate,on=rn.uvsNeedUpdate,un=rn.normalsNeedUpdate,an=rn.tangentsNeedUpdate,fn=rn.colorsNeedUpdate,ln=rn.morphTargetsNeedUpdate,cn=rn.vertices,hn=N.faces3,pn=N.faces4,dn=rn.faces,vn=rn.faceVertexUvs[0],mn=rn.faceVertexUvs[1],gn=rn.skinIndices,yn=rn.skinWeights,bn=rn.morphTargets,wn=rn.morphNormals;if(rn.verticesNeedUpdate){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],X=cn[j.a],V=cn[j.b],$=cn[j.c],zt[Mt]=X.x,zt[Mt+1]=X.y,zt[Mt+2]=X.z,zt[Mt+3]=V.x,zt[Mt+4]=V.y,zt[Mt+5]=V.z,zt[Mt+6]=$.x,zt[Mt+7]=$.y,zt[Mt+8]=$.z,Mt+=9;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],X=cn[j.a],V=cn[j.b],$=cn[j.c],J=cn[j.d],zt[Mt]=X.x,zt[Mt+1]=X.y,zt[Mt+2]=X.z,zt[Mt+3]=V.x,zt[Mt+4]=V.y,zt[Mt+5]=V.z,zt[Mt+6]=$.x,zt[Mt+7]=$.y,zt[Mt+8]=$.z,zt[Mt+9]=J.x,zt[Mt+10]=J.y,zt[Mt+11]=J.z,Mt+=12;Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglVertexBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,zt,k)}if(ln){xt=0;for(Nt=bn.length;xt<Nt;xt++){P=qt=0;for(H=hn.length;P<H;P++)Lt=hn[P],j=dn[Lt],X=bn[xt].vertices[j.a],V=bn[xt].vertices[j.b],$=bn[xt].vertices[j.c],Ct=Gt[xt],Ct[qt]=X.x,Ct[qt+1]=X.y,Ct[qt+2]=X.z,Ct[qt+3]=V.x,Ct[qt+4]=V.y,Ct[qt+5]=V.z,Ct[qt+6]=$.x,Ct[qt+7]=$.y,Ct[qt+8]=$.z,A.morphNormals&&(D?(At=wn[xt].vertexNormals[Lt],Z=At.a,et=At.b,tt=At.c):tt=et=Z=wn[xt].faceNormals[Lt],kt=Yt[xt],kt[qt]=Z.x,kt[qt+1]=Z.y,kt[qt+2]=Z.z,kt[qt+3]=et.x,kt[qt+4]=et.y,kt[qt+5]=et.z,kt[qt+6]=tt.x,kt[qt+7]=tt.y,kt[qt+8]=tt.z),qt+=9;P=0;for(H=pn.length;P<H;P++)Lt=pn[P],j=dn[Lt],X=bn[xt].vertices[j.a],V=bn[xt].vertices[j.b],$=bn[xt].vertices[j.c],J=bn[xt].vertices[j.d],Ct=Gt[xt],Ct[qt]=X.x,Ct[qt+1]=X.y,Ct[qt+2]=X.z,Ct[qt+3]=V.x,Ct[qt+4]=V.y,Ct[qt+5]=V.z,Ct[qt+6]=$.x,Ct[qt+7]=$.y,Ct[qt+8]=$.z,Ct[qt+9]=J.x,Ct[qt+10]=J.y,Ct[qt+11]=J.z,A.morphNormals&&(D?(At=wn[xt].vertexNormals[Lt],Z=At.a,et=At.b,tt=At.c,nt=At.d):nt=tt=et=Z=wn[xt].faceNormals[Lt],kt=Yt[xt],kt[qt]=Z.x,kt[qt+1]=Z.y,kt[qt+2]=Z.z,kt[qt+3]=et.x,kt[qt+4]=et.y,kt[qt+5]=et.z,kt[qt+6]=tt.x,kt[qt+7]=tt.y,kt[qt+8]=tt.z,kt[qt+9]=nt.x,kt[qt+10]=nt.y,kt[qt+11]=nt.z),qt+=12;Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglMorphTargetsBuffers[xt]),Tt.bufferData(Tt.ARRAY_BUFFER,Gt[xt],k),A.morphNormals&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglMorphNormalsBuffers[xt]),Tt.bufferData(Tt.ARRAY_BUFFER,Yt[xt],k))}}if(yn.length){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],ut=yn[j.a],at=yn[j.b],ft=yn[j.c],Qt[It]=ut.x,Qt[It+1]=ut.y,Qt[It+2]=ut.z,Qt[It+3]=ut.w,Qt[It+4]=at.x,Qt[It+5]=at.y,Qt[It+6]=at.z,Qt[It+7]=at.w,Qt[It+8]=ft.x,Qt[It+9]=ft.y,Qt[It+10]=ft.z,Qt[It+11]=ft.w,ct=gn[j.a],ht=gn[j.b],pt=gn[j.c],Kt[It]=ct.x,Kt[It+1]=ct.y,Kt[It+2]=ct.z,Kt[It+3]=ct.w,Kt[It+4]=ht.x,Kt[It+5]=ht.y,Kt[It+6]=ht.z,Kt[It+7]=ht.w,Kt[It+8]=pt.x,Kt[It+9]=pt.y,Kt[It+10]=pt.z,Kt[It+11]=pt.w,It+=12;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],ut=yn[j.a],at=yn[j.b],ft=yn[j.c],lt=yn[j.d],Qt[It]=ut.x,Qt[It+1]=ut.y,Qt[It+2]=ut.z,Qt[It+3]=ut.w,Qt[It+4]=at.x,Qt[It+5]=at.y,Qt[It+6]=at.z,Qt[It+7]=at.w,Qt[It+8]=ft.x,Qt[It+9]=ft.y,Qt[It+10]=ft.z,Qt[It+11]=ft.w,Qt[It+12]=lt.x,Qt[It+13]=lt.y,Qt[It+14]=lt.z,Qt[It+15]=lt.w,ct=gn[j.a],ht=gn[j.b],pt=gn[j.c],dt=gn[j.d],Kt[It]=ct.x,Kt[It+1]=ct.y,Kt[It+2]=ct.z,Kt[It+3]=ct.w,Kt[It+4]=ht.x,Kt[It+5]=ht.y,Kt[It+6]=ht.z,Kt[It+7]=ht.w,Kt[It+8]=pt.x,Kt[It+9]=pt.y,Kt[It+10]=pt.z,Kt[It+11]=pt.w,Kt[It+12]=dt.x,Kt[It+13]=dt.y,Kt[It+14]=dt.z,Kt[It+15]=dt.w,It+=16;0<It&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglSkinIndicesBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Kt,k),Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglSkinWeightsBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Qt,k))}if(fn&&M){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],q=j.vertexColors,R=j.color,3===q.length&&M===THREE.VertexColors?(rt=q[0],it=q[1],st=q[2]):st=it=rt=R,Jt[Ft]=rt.r,Jt[Ft+1]=rt.g,Jt[Ft+2]=rt.b,Jt[Ft+3]=it.r,Jt[Ft+4]=it.g,Jt[Ft+5]=it.b,Jt[Ft+6]=st.r,Jt[Ft+7]=st.g,Jt[Ft+8]=st.b,Ft+=9;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],q=j.vertexColors,R=j.color,4===q.length&&M===THREE.VertexColors?(rt=q[0],it=q[1],st=q[2],ot=q[3]):ot=st=it=rt=R,Jt[Ft]=rt.r,Jt[Ft+1]=rt.g,Jt[Ft+2]=rt.b,Jt[Ft+3]=it.r,Jt[Ft+4]=it.g,Jt[Ft+5]=it.b,Jt[Ft+6]=st.r,Jt[Ft+7]=st.g,Jt[Ft+8]=st.b,Jt[Ft+9]=ot.r,Jt[Ft+10]=ot.g,Jt[Ft+11]=ot.b,Ft+=12;0<Ft&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglColorBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Jt,k))}if(an&&rn.hasTangents){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],U=j.vertexTangents,K=U[0],Q=U[1],G=U[2],$t[Bt]=K.x,$t[Bt+1]=K.y,$t[Bt+2]=K.z,$t[Bt+3]=K.w,$t[Bt+4]=Q.x,$t[Bt+5]=Q.y,$t[Bt+6]=Q.z,$t[Bt+7]=Q.w,$t[Bt+8]=G.x,$t[Bt+9]=G.y,$t[Bt+10]=G.z,$t[Bt+11]=G.w,Bt+=12;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],U=j.vertexTangents,K=U[0],Q=U[1],G=U[2],Y=U[3],$t[Bt]=K.x,$t[Bt+1]=K.y,$t[Bt+2]=K.z,$t[Bt+3]=K.w,$t[Bt+4]=Q.x,$t[Bt+5]=Q.y,$t[Bt+6]=Q.z,$t[Bt+7]=Q.w,$t[Bt+8]=G.x,$t[Bt+9]=G.y,$t[Bt+10]=G.z,$t[Bt+11]=G.w,$t[Bt+12]=Y.x,$t[Bt+13]=Y.y,$t[Bt+14]=Y.z,$t[Bt+15]=Y.w,Bt+=16;Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglTangentBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,$t,k)}if(un&&O){P=0;for(H=hn.length;P<H;P++)if(j=dn[hn[P]],F=j.vertexNormals,I=j.normal,3===F.length&&D)for(vt=0;3>vt;vt++)gt=F[vt],Vt[Ht]=gt.x,Vt[Ht+1]=gt.y,Vt[Ht+2]=gt.z,Ht+=3;else for(vt=0;3>vt;vt++)Vt[Ht]=I.x,Vt[Ht+1]=I.y,Vt[Ht+2]=I.z,Ht+=3;P=0;for(H=pn.length;P<H;P++)if(j=dn[pn[P]],F=j.vertexNormals,I=j.normal,4===F.length&&D)for(vt=0;4>vt;vt++)gt=F[vt],Vt[Ht]=gt.x,Vt[Ht+1]=gt.y,Vt[Ht+2]=gt.z,Ht+=3;else for(vt=0;4>vt;vt++)Vt[Ht]=I.x,Vt[Ht+1]=I.y,Vt[Ht+2]=I.z,Ht+=3;Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglNormalBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Vt,k)}if(on&&vn&&_){P=0;for(H=hn.length;P<H;P++)if(B=hn[P],z=vn[B],void 0!==z)for(vt=0;3>vt;vt++)Et=z[vt],Wt[_t]=Et.x,Wt[_t+1]=Et.y,_t+=2;P=0;for(H=pn.length;P<H;P++)if(B=pn[P],z=vn[B],void 0!==z)for(vt=0;4>vt;vt++)Et=z[vt],Wt[_t]=Et.x,Wt[_t+1]=Et.y,_t+=2;0<_t&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglUVBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Wt,k))}if(on&&mn&&_){P=0;for(H=hn.length;P<H;P++)if(B=hn[P],W=mn[B],void 0!==W)for(vt=0;3>vt;vt++)St=W[vt],Xt[Dt]=St.x,Xt[Dt+1]=St.y,Dt+=2;P=0;for(H=pn.length;P<H;P++)if(B=pn[P],W=mn[B],void 0!==W)for(vt=0;4>vt;vt++)St=W[vt],Xt[Dt]=St.x,Xt[Dt+1]=St.y,Dt+=2;0<Dt&&(Tt.bindBuffer(Tt.ARRAY_BUFFER,N.__webglUV2Buffer),Tt.bufferData(Tt.ARRAY_BUFFER,Xt,k))}if(sn){P=0;for(H=hn.length;P<H;P++)tn[Pt]=Ot,tn[Pt+1]=Ot+1,tn[Pt+2]=Ot+2,Pt+=3,nn[jt]=Ot,nn[jt+1]=Ot+1,nn[jt+2]=Ot,nn[jt+3]=Ot+2,nn[jt+4]=Ot+1,nn[jt+5]=Ot+2,jt+=6,Ot+=3;P=0;for(H=pn.length;P<H;P++)tn[Pt]=Ot,tn[Pt+1]=Ot+1,tn[Pt+2]=Ot+3,tn[Pt+3]=Ot+1,tn[Pt+4]=Ot+2,tn[Pt+5]=Ot+3,Pt+=6,nn[jt]=Ot,nn[jt+1]=Ot+1,nn[jt+2]=Ot,nn[jt+3]=Ot+3,nn[jt+4]=Ot+1,nn[jt+5]=Ot+2,nn[jt+6]=Ot+2,nn[jt+7]=Ot+3,jt+=8,Ot+=4;Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,N.__webglFaceBuffer),Tt.bufferData(Tt.ELEMENT_ARRAY_BUFFER,tn,k),Tt.bindBuffer(Tt.ELEMENT_ARRAY_BUFFER,N.__webglLineBuffer),Tt.bufferData(Tt.ELEMENT_ARRAY_BUFFER,nn,k)}if(Zt){vt=0;for(mt=Zt.length;vt<mt;vt++)if(en=Zt[vt],en.__original.needsUpdate){Rt=0;if(1===en.size){if(void 0===en.boundTo||"vertices"===en.boundTo){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],en.array[Rt]=en.value[j.a],en.array[Rt+1]=en.value[j.b],en.array[Rt+2]=en.value[j.c],Rt+=3;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],en.array[Rt]=en.value[j.a],en.array[Rt+1]=en.value[j.b],en.array[Rt+2]=en.value[j.c],en.array[Rt+3]=en.value[j.d],Rt+=4}else if("faces"===en.boundTo){P=0;for(H=hn.length;P<H;P++)Ut=en.value[hn[P]],en.array[Rt]=Ut,en.array[Rt+1]=Ut,en.array[Rt+2]=Ut,Rt+=3;P=0;for(H=pn.length;P<H;P++)Ut=en.value[pn[P]],en.array[Rt]=Ut,en.array[Rt+1]=Ut,en.array[Rt+2]=Ut,en.array[Rt+3]=Ut,Rt+=4}}else if(2===en.size){if(void 0===en.boundTo||"vertices"===en.boundTo){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],X=en.value[j.a],V=en.value[j.b],$=en.value[j.c],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=V.x,en.array[Rt+3]=V.y,en.array[Rt+4]=$.x,en.array[Rt+5]=$.y,Rt+=6;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],X=en.value[j.a],V=en.value[j.b],$=en.value[j.c],J=en.value[j.d],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=V.x,en.array[Rt+3]=V.y,en.array[Rt+4]=$.x,en.array[Rt+5]=$.y,en.array[Rt+6]=J.x,en.array[Rt+7]=J.y,Rt+=8}else if("faces"===en.boundTo){P=0;for(H=hn.length;P<H;P++)$=V=X=Ut=en.value[hn[P]],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=V.x,en.array[Rt+3]=V.y,en.array[Rt+4]=$.x,en.array[Rt+5]=$.y,Rt+=6;P=0;for(H=pn.length;P<H;P++)J=$=V=X=Ut=en.value[pn[P]],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=V.x,en.array[Rt+3]=V.y,en.array[Rt+4]=$.x,en.array[Rt+5]=$.y,en.array[Rt+6]=J.x,en.array[Rt+7]=J.y,Rt+=8}}else if(3===en.size){var En;En="c"===en.type?["r","g","b"]:["x","y","z"];if(void 0===en.boundTo||"vertices"===en.boundTo){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],X=en.value[j.a],V=en.value[j.b],$=en.value[j.c],en.array[Rt]=X[En[0]],en.array[Rt+1]=X[En[1]],en.array[Rt+2]=X[En[2]],en.array[Rt+3]=V[En[0]],en.array[Rt+4]=V[En[1]],en.array[Rt+5]=V[En[2]],en.array[Rt+6]=$[En[0]],en.array[Rt+7]=$[En[1]],en.array[Rt+8]=$[En[2]],Rt+=9;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],X=en.value[j.a],V=en.value[j.b],$=en.value[j.c],J=en.value[j.d],en.array[Rt]=X[En[0]],en.array[Rt+1]=X[En[1]],en.array[Rt+2]=X[En[2]],en.array[Rt+3]=V[En[0]],en.array[Rt+4]=V[En[1]],en.array[Rt+5]=V[En[2]],en.array[Rt+6]=$[En[0]],en.array[Rt+7]=$[En[1]],en.array[Rt+8]=$[En[2]],en.array[Rt+9]=J[En[0]],en.array[Rt+10]=J[En[1]],en.array[Rt+11]=J[En[2]],Rt+=12}else if("faces"===en.boundTo){P=0;for(H=hn.length;P<H;P++)$=V=X=Ut=en.value[hn[P]],en.array[Rt]=X[En[0]],en.array[Rt+1]=X[En[1]],en.array[Rt+2]=X[En[2]],en.array[Rt+3]=V[En[0]],en.array[Rt+4]=V[En[1]],en.array[Rt+5]=V[En[2]],en.array[Rt+6]=$[En[0]],en.array[Rt+7]=$[En[1]],en.array[Rt+8]=$[En[2]],Rt+=9;P=0;for(H=pn.length;P<H;P++)J=$=V=X=Ut=en.value[pn[P]],en.array[Rt]=X[En[0]],en.array[Rt+1]=X[En[1]],en.array[Rt+2]=X[En[2]],en.array[Rt+3]=V[En[0]],en.array[Rt+4]=V[En[1]],en.array[Rt+5]=V[En[2]],en.array[Rt+6]=$[En[0]],en.array[Rt+7]=$[En[1]],en.array[Rt+8]=$[En[2]],en.array[Rt+9]=J[En[0]],en.array[Rt+10]=J[En[1]],en.array[Rt+11]=J[En[2]],Rt+=12}else if("faceVertices"===en.boundTo){P=0;for(H=hn.length;P<H;P++)Ut=en.value[hn[P]],X=Ut[0],V=Ut[1],$=Ut[2],en.array[Rt]=X[En[0]],en.array[Rt+1]=X[En[1]],en.array[Rt+2]=X[En[2]],en.array[Rt+3]=V[En[0]],en.array[Rt+4]=V[En[1]],en.array[Rt+5]=V[En[2]],en.array[Rt+6]=$[En[0]],en.array[Rt+7]=$[En[1]],en.array[Rt+8]=$[En[2]],Rt+=9;P=0;for(H=pn.length;P<H;P++)Ut=en.value[pn[P]],X=Ut[0],V=Ut[1],$=Ut[2],J=Ut[3],en.array[Rt]=X[En[0]],en.array[Rt+1]=X[En[1]],en.array[Rt+2]=X[En[2]],en.array[Rt+3]=V[En[0]],en.array[Rt+4]=V[En[1]],en.array[Rt+5]=V[En[2]],en.array[Rt+6]=$[En[0]],en.array[Rt+7]=$[En[1]],en.array[Rt+8]=$[En[2]],en.array[Rt+9]=J[En[0]],en.array[Rt+10]=J[En[1]],en.array[Rt+11]=J[En[2]],Rt+=12}}else if(4===en.size)if(void 0===en.boundTo||"vertices"===en.boundTo){P=0;for(H=hn.length;P<H;P++)j=dn[hn[P]],X=en.value[j.a],V=en.value[j.b],$=en.value[j.c],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=X.z,en.array[Rt+3]=X.w,en.array[Rt+4]=V.x,en.array[Rt+5]=V.y,en.array[Rt+6]=V.z,en.array[Rt+7]=V.w,en.array[Rt+8]=$.x,en.array[Rt+9]=$.y,en.array[Rt+10]=$.z,en.array[Rt+11]=$.w,Rt+=12;P=0;for(H=pn.length;P<H;P++)j=dn[pn[P]],X=en.value[j.a],V=en.value[j.b],$=en.value[j.c],J=en.value[j.d],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=X.z,en.array[Rt+3]=X.w,en.array[Rt+4]=V.x,en.array[Rt+5]=V.y,en.array[Rt+6]=V.z,en.array[Rt+7]=V.w,en.array[Rt+8]=$.x,en.array[Rt+9]=$.y,en.array[Rt+10]=$.z,en.array[Rt+11]=$.w,en.array[Rt+12]=J.x,en.array[Rt+13]=J.y,en.array[Rt+14]=J.z,en.array[Rt+15]=J.w,Rt+=16}else if("faces"===en.boundTo){P=0;for(H=hn.length;P<H;P++)$=V=X=Ut=en.value[hn[P]],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=X.z,en.array[Rt+3]=X.w,en.array[Rt+4]=V.x,en.array[Rt+5]=V.y,en.array[Rt+6]=V.z,en.array[Rt+7]=V.w,en.array[Rt+8]=$.x,en.array[Rt+9]=$.y,en.array[Rt+10]=$.z,en.array[Rt+11]=$.w,Rt+=12;P=0;for(H=pn.length;P<H;P++)J=$=V=X=Ut=en.value[pn[P]],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=X.z,en.array[Rt+3]=X.w,en.array[Rt+4]=V.x,en.array[Rt+5]=V.y,en.array[Rt+6]=V.z,en.array[Rt+7]=V.w,en.array[Rt+8]=$.x,en.array[Rt+9]=$.y,en.array[Rt+10]=$.z,en.array[Rt+11]=$.w,en.array[Rt+12]=J.x,en.array[Rt+13]=J.y,en.array[Rt+14]=J.z,en.array[Rt+15]=J.w,Rt+=16}else if("faceVertices"===en.boundTo){P=0;for(H=hn.length;P<H;P++)Ut=en.value[hn[P]],X=Ut[0],V=Ut[1],$=Ut[2],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=X.z,en.array[Rt+3]=X.w,en.array[Rt+4]=V.x,en.array[Rt+5]=V.y,en.array[Rt+6]=V.z,en.array[Rt+7]=V.w,en.array[Rt+8]=$.x,en.array[Rt+9]=$.y,en.array[Rt+10]=$.z,en.array[Rt+11]=$.w,Rt+=12;P=0;for(H=pn.length;P<H;P++)Ut=en.value[pn[P]],X=Ut[0],V=Ut[1],$=Ut[2],J=Ut[3],en.array[Rt]=X.x,en.array[Rt+1]=X.y,en.array[Rt+2]=X.z,en.array[Rt+3]=X.w,en.array[Rt+4]=V.x,en.array[Rt+5]=V.y,en.array[Rt+6]=V.z,en.array[Rt+7]=V.w,en.array[Rt+8]=$.x,en.array[Rt+9]=$.y,en.array[Rt+10]=$.z,en.array[Rt+11]=$.w,en.array[Rt+12]=J.x,en.array[Rt+13]=J.y,en.array[Rt+14]=J.z,en.array[Rt+15]=J.w,Rt+=16}Tt.bindBuffer(Tt.ARRAY_BUFFER,en.buffer),Tt.bufferData(Tt.ARRAY_BUFFER,en.array,k)}}L&&(delete N.__inittedArrays,delete N.__colorArray,delete N.__normalArray,delete N.__tangentArray,delete N.__uvArray,delete N.__uv2Array,delete N.__faceArray,delete N.__vertexArray,delete N.__lineArray,delete N.__skinIndexArray,delete N.__skinWeightArray)}}f.verticesNeedUpdate=!1,f.morphTargetsNeedUpdate=!1,f.elementsNeedUpdate=!1,f.uvsNeedUpdate=!1,f.normalsNeedUpdate=!1,f.colorsNeedUpdate=!1,f.tangentsNeedUpdate=!1,f.buffersNeedUpdate=!1,p.attributes&&g(p)}else if(a instanceof THREE.Ribbon){p=i(a,f),h=p.attributes&&m(p);if(f.verticesNeedUpdate||f.colorsNeedUpdate||f.normalsNeedUpdate||h){var Sn=f,xn=Tt.DYNAMIC_DRAW,Tn=void 0,Nn=void 0,Cn=void 0,kn=void 0,Ln=void 0,An=void 0,On=void 0,Mn=void 0,_n=void 0,Dn=void 0,Pn=void 0,Hn=void 0,Bn=void 0,jn=Sn.vertices,Fn=Sn.colors,In=Sn.normals,qn=jn.length,Rn=Fn.length,Un=In.length,zn=Sn.__vertexArray,Wn=Sn.__colorArray,Xn=Sn.__normalArray,Vn=Sn.colorsNeedUpdate,$n=Sn.normalsNeedUpdate,Jn=Sn.__webglCustomAttributesList;if(Sn.verticesNeedUpdate){for(Tn=0;Tn<qn;Tn++)kn=jn[Tn],Ln=3*Tn,zn[Ln]=kn.x,zn[Ln+1]=kn.y,zn[Ln+2]=kn.z;Tt.bindBuffer(Tt.ARRAY_BUFFER,Sn.__webglVertexBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,zn,xn)}if(Vn){for(Nn=0;Nn<Rn;Nn++)An=Fn[Nn],Ln=3*Nn,Wn[Ln]=An.r,Wn[Ln+1]=An.g,Wn[Ln+2]=An.b;Tt.bindBuffer(Tt.ARRAY_BUFFER,Sn.__webglColorBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Wn,xn)}if($n){for(Cn=0;Cn<Un;Cn++)On=In[Cn],Ln=3*Cn,Xn[Ln]=On.x,Xn[Ln+1]=On.y,Xn[Ln+2]=On.z;Tt.bindBuffer(Tt.ARRAY_BUFFER,Sn.__webglNormalBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Xn,xn)}if(Jn){Mn=0;for(_n=Jn.length;Mn<_n;Mn++)if(Hn=Jn[Mn],Hn.needsUpdate&&(void 0===Hn.boundTo||"vertices"===Hn.boundTo)){Ln=0,Pn=Hn.value.length;if(1===Hn.size)for(Dn=0;Dn<Pn;Dn++)Hn.array[Dn]=Hn.value[Dn];else if(2===Hn.size)for(Dn=0;Dn<Pn;Dn++)Bn=Hn.value[Dn],Hn.array[Ln]=Bn.x,Hn.array[Ln+1]=Bn.y,Ln+=2;else if(3===Hn.size)if("c"===Hn.type)for(Dn=0;Dn<Pn;Dn++)Bn=Hn.value[Dn],Hn.array[Ln]=Bn.r,Hn.array[Ln+1]=Bn.g,Hn.array[Ln+2]=Bn.b,Ln+=3;else for(Dn=0;Dn<Pn;Dn++)Bn=Hn.value[Dn],Hn.array[Ln]=Bn.x,Hn.array[Ln+1]=Bn.y,Hn.array[Ln+2]=Bn.z,Ln+=3;else if(4===Hn.size)for(Dn=0;Dn<Pn;Dn++)Bn=Hn.value[Dn],Hn.array[Ln]=Bn.x,Hn.array[Ln+1]=Bn.y,Hn.array[Ln+2]=Bn.z,Hn.array[Ln+3]=Bn.w,Ln+=4;Tt.bindBuffer(Tt.ARRAY_BUFFER,Hn.buffer),Tt.bufferData(Tt.ARRAY_BUFFER,Hn.array,xn)}}}f.verticesNeedUpdate=!1,f.colorsNeedUpdate=!1,f.normalsNeedUpdate=!1,p.attributes&&g(p)}else if(a instanceof THREE.Line){p=i(a,f),h=p.attributes&&m(p);if(f.verticesNeedUpdate||f.colorsNeedUpdate||f.lineDistancesNeedUpdate||h){var Kn=f,Qn=Tt.DYNAMIC_DRAW,Gn=void 0,Yn=void 0,Zn=void 0,er=void 0,tr=void 0,nr=void 0,rr=Kn.vertices,ir=Kn.colors,sr=Kn.lineDistances,or=rr.length,ur=ir.length,ar=sr.length,fr=Kn.__vertexArray,lr=Kn.__colorArray,cr=Kn.__lineDistanceArray,hr=Kn.colorsNeedUpdate,pr=Kn.lineDistancesNeedUpdate,dr=Kn.__webglCustomAttributesList,vr=void 0,mr=void 0,gr=void 0,yr=void 0,br=void 0,wr=void 0;if(Kn.verticesNeedUpdate){for(Gn=0;Gn<or;Gn++)er=rr[Gn],tr=3*Gn,fr[tr]=er.x,fr[tr+1]=er.y,fr[tr+2]=er.z;Tt.bindBuffer(Tt.ARRAY_BUFFER,Kn.__webglVertexBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,fr,Qn)}if(hr){for(Yn=0;Yn<ur;Yn++)nr=ir[Yn],tr=3*Yn,lr[tr]=nr.r,lr[tr+1]=nr.g,lr[tr+2]=nr.b;Tt.bindBuffer(Tt.ARRAY_BUFFER,Kn.__webglColorBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,lr,Qn)}if(pr){for(Zn=0;Zn<ar;Zn++)cr[Zn]=sr[Zn];Tt.bindBuffer(Tt.ARRAY_BUFFER,Kn.__webglLineDistanceBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,cr,Qn)}if(dr){vr=0;for(mr=dr.length;vr<mr;vr++)if(wr=dr[vr],wr.needsUpdate&&(void 0===wr.boundTo||"vertices"===wr.boundTo)){tr=0,yr=wr.value.length;if(1===wr.size)for(gr=0;gr<yr;gr++)wr.array[gr]=wr.value[gr];else if(2===wr.size)for(gr=0;gr<yr;gr++)br=wr.value[gr],wr.array[tr]=br.x,wr.array[tr+1]=br.y,tr+=2;else if(3===wr.size)if("c"===wr.type)for(gr=0;gr<yr;gr++)br=wr.value[gr],wr.array[tr]=br.r,wr.array[tr+1]=br.g,wr.array[tr+2]=br.b,tr+=3;else for(gr=0;gr<yr;gr++)br=wr.value[gr],wr.array[tr]=br.x,wr.array[tr+1]=br.y,wr.array[tr+2]=br.z,tr+=3;else if(4===wr.size)for(gr=0;gr<yr;gr++)br=wr.value[gr],wr.array[tr]=br.x,wr.array[tr+1]=br.y,wr.array[tr+2]=br.z,wr.array[tr+3]=br.w,tr+=4;Tt.bindBuffer(Tt.ARRAY_BUFFER,wr.buffer),Tt.bufferData(Tt.ARRAY_BUFFER,wr.array,Qn)}}}f.verticesNeedUpdate=!1,f.colorsNeedUpdate=!1,f.lineDistancesNeedUpdate=!1,p.attributes&&g(p)}else if(a instanceof THREE.ParticleSystem){p=i(a,f),h=p.attributes&&m(p);if(f.verticesNeedUpdate||f.colorsNeedUpdate||a.sortParticles||h){var Er=f,Sr=Tt.DYNAMIC_DRAW,xr=a,Tr=void 0,Nr=void 0,Cr=void 0,kr=void 0,Lr=void 0,Ar=void 0,Or=Er.vertices,Mr=Or.length,_r=Er.colors,Dr=_r.length,Pr=Er.__vertexArray,Hr=Er.__colorArray,Br=Er.__sortArray,jr=Er.verticesNeedUpdate,Fr=Er.colorsNeedUpdate,Ir=Er.__webglCustomAttributesList,qr=void 0,Rr=void 0,Ur=void 0,zr=void 0,Wr=void 0,Xr=void 0;if(xr.sortParticles){bt.copy(yt),bt.multiply(xr.matrixWorld);for(Tr=0;Tr<Mr;Tr++)Cr=Or[Tr],wt.copy(Cr),wt.applyProjection(bt),Br[Tr]=[wt.z,Tr];Br.sort(l);for(Tr=0;Tr<Mr;Tr++)Cr=Or[Br[Tr][1]],kr=3*Tr,Pr[kr]=Cr.x,Pr[kr+1]=Cr.y,Pr[kr+2]=Cr.z;for(Nr=0;Nr<Dr;Nr++)kr=3*Nr,Ar=_r[Br[Nr][1]],Hr[kr]=Ar.r,Hr[kr+1]=Ar.g,Hr[kr+2]=Ar.b;if(Ir){qr=0;for(Rr=Ir.length;qr<Rr;qr++)if(Xr=Ir[qr],void 0===Xr.boundTo||"vertices"===Xr.boundTo)if(kr=0,zr=Xr.value.length,1===Xr.size)for(Ur=0;Ur<zr;Ur++)Lr=Br[Ur][1],Xr.array[Ur]=Xr.value[Lr];else if(2===Xr.size)for(Ur=0;Ur<zr;Ur++)Lr=Br[Ur][1],Wr=Xr.value[Lr],Xr.array[kr]=Wr.x,Xr.array[kr+1]=Wr.y,kr+=2;else if(3===Xr.size)if("c"===Xr.type)for(Ur=0;Ur<zr;Ur++)Lr=Br[Ur][1],Wr=Xr.value[Lr],Xr.array[kr]=Wr.r,Xr.array[kr+1]=Wr.g,Xr.array[kr+2]=Wr.b,kr+=3;else for(Ur=0;Ur<zr;Ur++)Lr=Br[Ur][1],Wr=Xr.value[Lr],Xr.array[kr]=Wr.x,Xr.array[kr+1]=Wr.y,Xr.array[kr+2]=Wr.z,kr+=3;else if(4===Xr.size)for(Ur=0;Ur<zr;Ur++)Lr=Br[Ur][1],Wr=Xr.value[Lr],Xr.array[kr]=Wr.x,Xr.array[kr+1]=Wr.y,Xr.array[kr+2]=Wr.z,Xr.array[kr+3]=Wr.w,kr+=4}}else{if(jr)for(Tr=0;Tr<Mr;Tr++)Cr=Or[Tr],kr=3*Tr,Pr[kr]=Cr.x,Pr[kr+1]=Cr.y,Pr[kr+2]=Cr.z;if(Fr)for(Nr=0;Nr<Dr;Nr++)Ar=_r[Nr],kr=3*Nr,Hr[kr]=Ar.r,Hr[kr+1]=Ar.g,Hr[kr+2]=Ar.b;if(Ir){qr=0;for(Rr=Ir.length;qr<Rr;qr++)if(Xr=Ir[qr],Xr.needsUpdate&&(void 0===Xr.boundTo||"vertices"===Xr.boundTo))if(zr=Xr.value.length,kr=0,1===Xr.size)for(Ur=0;Ur<zr;Ur++)Xr.array[Ur]=Xr.value[Ur];else if(2===Xr.size)for(Ur=0;Ur<zr;Ur++)Wr=Xr.value[Ur],Xr.array[kr]=Wr.x,Xr.array[kr+1]=Wr.y,kr+=2;else if(3===Xr.size)if("c"===Xr.type)for(Ur=0;Ur<zr;Ur++)Wr=Xr.value[Ur],Xr.array[kr]=Wr.r,Xr.array[kr+1]=Wr.g,Xr.array[kr+2]=Wr.b,kr+=3;else for(Ur=0;Ur<zr;Ur++)Wr=Xr.value[Ur],Xr.array[kr]=Wr.x,Xr.array[kr+1]=Wr.y,Xr.array[kr+2]=Wr.z,kr+=3;else if(4===Xr.size)for(Ur=0;Ur<zr;Ur++)Wr=Xr.value[Ur],Xr.array[kr]=Wr.x,Xr.array[kr+1]=Wr.y,Xr.array[kr+2]=Wr.z,Xr.array[kr+3]=Wr.w,kr+=4}}if(jr||xr.sortParticles)Tt.bindBuffer(Tt.ARRAY_BUFFER,Er.__webglVertexBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Pr,Sr);if(Fr||xr.sortParticles)Tt.bindBuffer(Tt.ARRAY_BUFFER,Er.__webglColorBuffer),Tt.bufferData(Tt.ARRAY_BUFFER,Hr,Sr);if(Ir){qr=0;for(Rr=Ir.length;qr<Rr;qr++)if(Xr=Ir[qr],Xr.needsUpdate||xr.sortParticles)Tt.bindBuffer(Tt.ARRAY_BUFFER,Xr.buffer),Tt.bufferData(Tt.ARRAY_BUFFER,Xr.array,Sr)}}f.verticesNeedUpdate=!1,f.colorsNeedUpdate=!1,p.attributes&&g(p)}}},this.initMaterial=function(e,t,n,r){var i,s,o,u;e.addEventListener("dispose",Xt);var a,f,l,c,h;e instanceof THREE.MeshDepthMaterial?h="depth":e instanceof THREE.MeshNormalMaterial?h="normal":e instanceof THREE.MeshBasicMaterial?h="basic":e instanceof THREE.MeshLambertMaterial?h="lambert":e instanceof THREE.MeshPhongMaterial?h="phong":e instanceof THREE.LineBasicMaterial?h="basic":e instanceof THREE.LineDashedMaterial?h="dashed":e instanceof THREE.ParticleBasicMaterial&&(h="particle_basic");if(h){var p=THREE.ShaderLib[h];e.uniforms=THREE.UniformsUtils.clone(p.uniforms),e.vertexShader=p.vertexShader,e.fragmentShader=p.fragmentShader}var d,v,m;i=o=v=m=p=0;for(s=t.length;i<s;i++)d=t[i],d.onlyShadow||(d instanceof THREE.DirectionalLight&&o++,d instanceof THREE.PointLight&&v++,d instanceof THREE.SpotLight&&m++,d instanceof THREE.HemisphereLight&&p++);i=o,s=v,o=m,u=p,p=d=0;for(m=t.length;p<m;p++)v=t[p],v.castShadow&&(v instanceof THREE.SpotLight&&d++,v instanceof THREE.DirectionalLight&&!v.shadowCascade&&d++);c=d,Ht&&r&&r.useVertexTexture?l=1024:(t=Tt.getParameter(Tt.MAX_VERTEX_UNIFORM_VECTORS),t=Math.floor((t-20)/4),void 0!==r&&r instanceof THREE.SkinnedMesh&&(t=Math.min(r.bones.length,t),t<r.bones.length&&console.warn("WebGLRenderer: too many bones - "+r.bones.length+", this GPU supports just "+t+" (try OpenGL instead of ANGLE)")),l=t);e:{m=e.fragmentShader,v=e.vertexShader,p=e.uniforms,t=e.attributes,d=e.defines;var n={map:!!e.map,envMap:!!e.envMap,lightMap:!!e.lightMap,bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,specularMap:!!e.specularMap,vertexColors:e.vertexColors,fog:n,useFog:e.fog,fogExp:n instanceof THREE.FogExp2,sizeAttenuation:e.sizeAttenuation,skinning:e.skinning,maxBones:l,useVertexTexture:Ht&&r&&r.useVertexTexture,boneTextureWidth:r&&r.boneTextureWidth,boneTextureHeight:r&&r.boneTextureHeight,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:i,maxPointLights:s,maxSpotLights:o,maxHemiLights:u,maxShadows:c,shadowMapEnabled:this.shadowMapEnabled&&r.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:e.alphaTest,metal:e.metal,perPixel:e.perPixel,wrapAround:e.wrapAround,doubleSided:e.side===THREE.DoubleSide,flipSided:e.side===THREE.BackSide},g,y,b,r=[];h?r.push(h):(r.push(m),r.push(v));for(y in d)r.push(y),r.push(d[y]);for(g in n)r.push(g),r.push(n[g]);h=r.join(),g=0;for(y=z.length;g<y;g++)if(r=z[g],r.code===h){r.usedTimes++,f=r.program;break e}g="SHADOWMAP_TYPE_BASIC",n.shadowMapType===THREE.PCFShadowMap?g="SHADOWMAP_TYPE_PCF":n.shadowMapType===THREE.PCFSoftShadowMap&&(g="SHADOWMAP_TYPE_PCF_SOFT"),y=[];for(b in d)r=d[b],!1!==r&&(r="#define "+b+" "+r,y.push(r));r=y.join("\n"),b=Tt.createProgram(),y=["precision "+P+" float;",r,Pt?"#define VERTEX_TEXTURES":"",U.gammaInput?"#define GAMMA_INPUT":"",U.gammaOutput?"#define GAMMA_OUTPUT":"",U.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_HEMI_LIGHTS "+n.maxHemiLights,"#define MAX_SHADOWS "+n.maxShadows,"#define MAX_BONES "+n.maxBones,n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.lightMap?"#define USE_LIGHTMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.vertexColors?"#define USE_COLOR":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.boneTextureWidth?"#define N_BONE_PIXEL_X "+n.boneTextureWidth.toFixed(1):"",n.boneTextureHeight?"#define N_BONE_PIXEL_Y "+n.boneTextureHeight.toFixed(1):"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals?"#define USE_MORPHNORMALS":"",n.perPixel?"#define PHONG_PER_PIXEL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+g:"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n"),g=["precision "+P+" float;",n.bumpMap||n.normalMap?"#extension GL_OES_standard_derivatives : enable":"",r,"#define MAX_DIR_LIGHTS "+n.maxDirLights,"#define MAX_POINT_LIGHTS "+n.maxPointLights,"#define MAX_SPOT_LIGHTS "+n.maxSpotLights,"#define MAX_HEMI_LIGHTS "+n.maxHemiLights,"#define MAX_SHADOWS "+n.maxShadows,n.alphaTest?"#define ALPHATEST "+n.alphaTest:"",U.gammaInput?"#define GAMMA_INPUT":"",U.gammaOutput?"#define GAMMA_OUTPUT":"",U.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.lightMap?"#define USE_LIGHTMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.vertexColors?"#define USE_COLOR":"",n.metal?"#define METAL":"",n.perPixel?"#define PHONG_PER_PIXEL":"",n.wrapAround?"#define WRAP_AROUND":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+g:"",n.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",n.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"),y=L("vertex",y+v),g=L("fragment",g+m),Tt.attachShader(b,y),Tt.attachShader(b,g),Tt.linkProgram(b),Tt.getProgramParameter(b,Tt.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+Tt.getProgramParameter(b,Tt.VALIDATE_STATUS)+", gl error ["+Tt.getError()+"]"),Tt.deleteShader(g),Tt.deleteShader(y),b.uniforms={},b.attributes={};var w;g="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" "),n.useVertexTexture?g.push("boneTexture"):g.push("boneGlobalMatrices");for(w in p)g.push(w);w=g,g=0;for(y=w.length;g<y;g++)p=w[g],b.uniforms[p]=Tt.getUniformLocation(b,p);g="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(w=0;w<n.maxMorphTargets;w++)g.push("morphTarget"+w);for(w=0;w<n.maxMorphNormals;w++)g.push("morphNormal"+w);for(f in t)g.push(f);f=g,w=0;for(t=f.length;w<t;w++)g=f[w],b.attributes[g]=Tt.getAttribLocation(b,g);b.id=W++,z.push({program:b,code:h,usedTimes:1}),U.info.memory.programs=z.length,f=b}e.program=f,w=e.program.attributes;if(e.morphTargets){e.numSupportedMorphTargets=0,t="morphTarget";for(f=0;f<this.maxMorphTargets;f++)b=t+f,0<=w[b]&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0,t="morphNormal";for(f=0;f<this.maxMorphNormals;f++)b=t+f,0<=w[b]&&e.numSupportedMorphNormals++}e.uniformsList=[];for(a in e.uniforms)e.uniformsList.push([e.uniforms[a],a])},this.setFaceCulling=function(e,t){e===THREE.CullFaceNone?Tt.disable(Tt.CULL_FACE):(t===THREE.FrontFaceDirectionCW?Tt.frontFace(Tt.CW):Tt.frontFace(Tt.CCW),e===THREE.CullFaceBack?Tt.cullFace(Tt.BACK):e===THREE.CullFaceFront?Tt.cullFace(Tt.FRONT):Tt.cullFace(Tt.FRONT_AND_BACK),Tt.enable(Tt.CULL_FACE))},this.setMaterialFaces=function(e){var t=e.side===THREE.DoubleSide,e=e.side===THREE.BackSide;Y!==t&&(t?Tt.disable(Tt.CULL_FACE):Tt.enable(Tt.CULL_FACE),Y=t),Z!==e&&(e?Tt.frontFace(Tt.CW):Tt.frontFace(Tt.CCW),Z=e)},this.setDepthTest=function(e){it!==e&&(e?Tt.enable(Tt.DEPTH_TEST):Tt.disable(Tt.DEPTH_TEST),it=e)},this.setDepthWrite=function(e){st!==e&&(Tt.depthMask(e),st=e)},this.setBlending=function(e,t,n,r){e!==et&&(e===THREE.NoBlending?Tt.disable(Tt.BLEND):e===THREE.AdditiveBlending?(Tt.enable(Tt.BLEND),Tt.blendEquation(Tt.FUNC_ADD),Tt.blendFunc(Tt.SRC_ALPHA,Tt.ONE)):e===THREE.SubtractiveBlending?(Tt.enable(Tt.BLEND),Tt.blendEquation(Tt.FUNC_ADD),Tt.blendFunc(Tt.ZERO,Tt.ONE_MINUS_SRC_COLOR)):e===THREE.MultiplyBlending?(Tt.enable(Tt.BLEND),Tt.blendEquation(Tt.FUNC_ADD),Tt.blendFunc(Tt.ZERO,Tt.SRC_COLOR)):e===THREE.CustomBlending?Tt.enable(Tt.BLEND):(Tt.enable(Tt.BLEND),Tt.blendEquationSeparate(Tt.FUNC_ADD,Tt.FUNC_ADD),Tt.blendFuncSeparate(Tt.SRC_ALPHA,Tt.ONE_MINUS_SRC_ALPHA,Tt.ONE,Tt.ONE_MINUS_SRC_ALPHA)),et=e);if(e===THREE.CustomBlending){if(t!==tt&&(Tt.blendEquation(_(t)),tt=t),n!==nt||r!==rt)Tt.blendFunc(_(n),_(r)),nt=n,rt=r}else rt=nt=tt=null},this.setTexture=function(e,t){if(e.needsUpdate){e.__webglInit||(e.__webglInit=!0,e.addEventListener("dispose",zt),e.__webglTexture=Tt.createTexture(),U.info.memory.textures++),Tt.activeTexture(Tt.TEXTURE0+t),Tt.bindTexture(Tt.TEXTURE_2D,e.__webglTexture),Tt.pixelStorei(Tt.UNPACK_FLIP_Y_WEBGL,e.flipY),Tt.pixelStorei(Tt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),Tt.pixelStorei(Tt.UNPACK_ALIGNMENT,e.unpackAlignment);var n=e.image,r=0===(n.width&n.width-1)&&0===(n.height&n.height-1),i=_(e.format),s=_(e.type);A(Tt.TEXTURE_2D,e,r);var o=e.mipmaps;if(e instanceof THREE.DataTexture)if(0<o.length&&r){for(var u=0,a=o.length;u<a;u++)n=o[u],Tt.texImage2D(Tt.TEXTURE_2D,u,i,n.width,n.height,0,i,s,n.data);e.generateMipmaps=!1}else Tt.texImage2D(Tt.TEXTURE_2D,0,i,n.width,n.height,0,i,s,n.data);else if(e instanceof THREE.CompressedTexture){u=0;for(a=o.length;u<a;u++)n=o[u],Tt.compressedTexImage2D(Tt.TEXTURE_2D,u,i,n.width,n.height,0,n.data)}else if(0<o.length&&r){u=0;for(a=o.length;u<a;u++)n=o[u],Tt.texImage2D(Tt.TEXTURE_2D,u,i,i,s,n);e.generateMipmaps=!1}else Tt.texImage2D(Tt.TEXTURE_2D,0,i,i,s,e.image);e.generateMipmaps&&r&&Tt.generateMipmap(Tt.TEXTURE_2D),e.needsUpdate=!1,e.onUpdate&&e.onUpdate()}else Tt.activeTexture(Tt.TEXTURE0+t),Tt.bindTexture(Tt.TEXTURE_2D,e.__webglTexture)},this.setRenderTarget=function(e){var t=e instanceof THREE.WebGLRenderTargetCube;if(e&&!e.__webglFramebuffer){void 0===e.depthBuffer&&(e.depthBuffer=!0),void 0===e.stencilBuffer&&(e.stencilBuffer=!0),e.addEventListener("dispose",Wt),e.__webglTexture=Tt.createTexture(),U.info.memory.textures++;var n=0===(e.width&e.width-1)&&0===(e.height&e.height-1),r=_(e.format),i=_(e.type);if(t){e.__webglFramebuffer=[],e.__webglRenderbuffer=[],Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,e.__webglTexture),A(Tt.TEXTURE_CUBE_MAP,e,n);for(var s=0;6>s;s++){e.__webglFramebuffer[s]=Tt.createFramebuffer(),e.__webglRenderbuffer[s]=Tt.createRenderbuffer(),Tt.texImage2D(Tt.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,r,e.width,e.height,0,r,i,null);var o=e,u=Tt.TEXTURE_CUBE_MAP_POSITIVE_X+s;Tt.bindFramebuffer(Tt.FRAMEBUFFER,e.__webglFramebuffer[s]),Tt.framebufferTexture2D(Tt.FRAMEBUFFER,Tt.COLOR_ATTACHMENT0,u,o.__webglTexture,0),O(e.__webglRenderbuffer[s],e)}n&&Tt.generateMipmap(Tt.TEXTURE_CUBE_MAP)}else e.__webglFramebuffer=Tt.createFramebuffer(),e.__webglRenderbuffer=e.shareDepthFrom?e.shareDepthFrom.__webglRenderbuffer:Tt.createRenderbuffer(),Tt.bindTexture(Tt.TEXTURE_2D,e.__webglTexture),A(Tt.TEXTURE_2D,e,n),Tt.texImage2D(Tt.TEXTURE_2D,0,r,e.width,e.height,0,r,i,null),r=Tt.TEXTURE_2D,Tt.bindFramebuffer(Tt.FRAMEBUFFER,e.__webglFramebuffer),Tt.framebufferTexture2D(Tt.FRAMEBUFFER,Tt.COLOR_ATTACHMENT0,r,e.__webglTexture,0),e.shareDepthFrom?e.depthBuffer&&!e.stencilBuffer?Tt.framebufferRenderbuffer(Tt.FRAMEBUFFER,Tt.DEPTH_ATTACHMENT,Tt.RENDERBUFFER,e.__webglRenderbuffer):e.depthBuffer&&e.stencilBuffer&&Tt.framebufferRenderbuffer(Tt.FRAMEBUFFER,Tt.DEPTH_STENCIL_ATTACHMENT,Tt.RENDERBUFFER,e.__webglRenderbuffer):O(e.__webglRenderbuffer,e),n&&Tt.generateMipmap(Tt.TEXTURE_2D);t?Tt.bindTexture(Tt.TEXTURE_CUBE_MAP,null):Tt.bindTexture(Tt.TEXTURE_2D,null),Tt.bindRenderbuffer(Tt.RENDERBUFFER,null),Tt.bindFramebuffer(Tt.FRAMEBUFFER,null)}e?(t=t?e.__webglFramebuffer[e.activeCubeFace]:e.__webglFramebuffer,n=e.width,e=e.height,i=r=0):(t=null,n=ht,e=pt,r=lt,i=ct),t!==V&&(Tt.bindFramebuffer(Tt.FRAMEBUFFER,t),Tt.viewport(r,i,n,e),V=t),dt=n,vt=e},this.shadowMapPlugin=new THREE.ShadowMapPlugin,this.addPrePlugin(this.shadowMapPlugin),this.addPostPlugin(new THREE.SpritePlugin),this.addPostPlugin(new THREE.LensFlarePlugin)},THREE.WebGLRenderTarget=function(e,t,n){this.width=e,this.height=t,n=n||{},this.wrapS=void 0!==n.wrapS?n.wrapS:THREE.ClampToEdgeWrapping,this.wrapT=void 0!==n.wrapT?n.wrapT:THREE.ClampToEdgeWrapping,this.magFilter=void 0!==n.magFilter?n.magFilter:THREE.LinearFilter,this.minFilter=void 0!==n.minFilter?n.minFilter:THREE.LinearMipMapLinearFilter,this.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,this.offset=new THREE.Vector2(0,0),this.repeat=new THREE.Vector2(1,1),this.format=void 0!==n.format?n.format:THREE.RGBAFormat,this.type=void 0!==n.type?n.type:THREE.UnsignedByteType,this.depthBuffer=void 0!==n.depthBuffer?n.depthBuffer:!0,this.stencilBuffer=void 0!==n.stencilBuffer?n.stencilBuffer:!0,this.generateMipmaps=!0,this.shareDepthFrom=null},THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(){var e=new THREE.WebGLRenderTarget(this.width,this.height);return e.wrapS=this.wrapS,e.wrapT=this.wrapT,e.magFilter=this.magFilter,e.minFilter=this.minFilter,e.anisotropy=this.anisotropy,e.offset.copy(this.offset),e.repeat.copy(this.repeat),e.format=this.format,e.type=this.type,e.depthBuffer=this.depthBuffer,e.stencilBuffer=this.stencilBuffer,e.generateMipmaps=this.generateMipmaps,e.shareDepthFrom=this.shareDepthFrom,e},dispose:function(){this.dispatchEvent({type:"dispose"})}},THREE.WebGLRenderTargetCube=function(e,t,n){THREE.WebGLRenderTarget.call(this,e,t,n),this.activeCubeFace=0},THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype),THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.material=this.color=null,this.uvs=[[]],this.z=null},THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.v4=new THREE.RenderableVertex,this.centroidModel=new THREE.Vector3,this.normalModel=new THREE.Vector3,this.normalModelView=new THREE.Vector3,this.vertexNormalsLength=0,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.material=this.color=null,this.uvs=[[]],this.z=null},THREE.RenderableObject=function(){this.z=this.object=null},THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=this.object=null,this.scale=new THREE.Vector2,this.material=null},THREE.RenderableLine=function(){this.z=null,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null},THREE.GeometryUtils={merge:function(e,t,n){var r,i,s=e.vertices.length,o=t instanceof THREE.Mesh?t.geometry:t,u=e.vertices,a=o.vertices,f=e.faces,l=o.faces,e=e.faceVertexUvs[0],o=o.faceVertexUvs[0];void 0===n&&(n=0),t instanceof THREE.Mesh&&(t.matrixAutoUpdate&&t.updateMatrix(),r=t.matrix,i=(new THREE.Matrix3).getNormalMatrix(r));for(var t=0,c=a.length;t<c;t++){var h=a[t].clone();r&&h.applyMatrix4(r),u.push(h)}t=0;for(c=l.length;t<c;t++){var h=l[t],p,d,v=h.vertexNormals,m=h.vertexColors;h instanceof THREE.Face3?p=new THREE.Face3(h.a+s,h.b+s,h.c+s):h instanceof THREE.Face4&&(p=new THREE.Face4(h.a+s,h.b+s,h.c+s,h.d+s)),p.normal.copy(h.normal),i&&p.normal.applyMatrix3(i).normalize(),u=0;for(a=v.length;u<a;u++)d=v[u].clone(),i&&d.applyMatrix3(i).normalize(),p.vertexNormals.push(d);p.color.copy(h.color),u=0;for(a=m.length;u<a;u++)d=m[u],p.vertexColors.push(d.clone());p.materialIndex=h.materialIndex+n,p.centroid.copy(h.centroid),r&&p.centroid.applyMatrix4(r),f.push(p)}t=0;for(c=o.length;t<c;t++){n=o[t],r=[],u=0;for(a=n.length;u<a;u++)r.push(new THREE.Vector2(n[u].x,n[u].y));e.push(r)}},removeMaterials:function(e,t){for(var n={},r=0,i=t.length;r<i;r++)n[t[r]]=!0;for(var s,o=[],r=0,i=e.faces.length;r<i;r++)s=e.faces[r],s.materialIndex in n||o.push(s);e.faces=o},randomPointInTriangle:function(e,t,n){var r,i,s,o=new THREE.Vector3,u=THREE.GeometryUtils.__v1;return r=THREE.GeometryUtils.random(),i=THREE.GeometryUtils.random(),1<r+i&&(r=1-r,i=1-i),s=1-r-i,o.copy(e),o.multiplyScalar(r),u.copy(t),u.multiplyScalar(i),o.add(u),u.copy(n),u.multiplyScalar(s),o.add(u),o},randomPointInFace:function(e,t,n){var r,i,s;if(e instanceof THREE.Face3)return r=t.vertices[e.a],i=t.vertices[e.b],s=t.vertices[e.c],THREE.GeometryUtils.randomPointInTriangle(r,i,s);if(e instanceof THREE.Face4){r=t.vertices[e.a],i=t.vertices[e.b],s=t.vertices[e.c];var t=t.vertices[e.d],o;return n?e._area1&&e._area2?(n=e._area1,o=e._area2):(n=THREE.GeometryUtils.triangleArea(r,i,t),o=THREE.GeometryUtils.triangleArea(i,s,t),e._area1=n,e._area2=o):(n=THREE.GeometryUtils.triangleArea(r,i,t),o=THREE.GeometryUtils.triangleArea(i,s,t)),THREE.GeometryUtils.random()*(n+o)<n?THREE.GeometryUtils.randomPointInTriangle(r,i,t):THREE.GeometryUtils.randomPointInTriangle(i,s,t)}},randomPointsInGeometry:function(e,t){function n(e){function t(n,r){if(r<n)return n;var i=n+Math.floor((r-n)/2);return f[i]>e?t(n,i-1):f[i]<e?t(i+1,r):i}return t(0,f.length-1)}var r,i,s=e.faces,o=e.vertices,u=s.length,a=0,f=[],l,c,h,p;for(i=0;i<u;i++)r=s[i],r instanceof THREE.Face3?(l=o[r.a],c=o[r.b],h=o[r.c],r._area=THREE.GeometryUtils.triangleArea(l,c,h)):r instanceof THREE.Face4&&(l=o[r.a],c=o[r.b],h=o[r.c],p=o[r.d],r._area1=THREE.GeometryUtils.triangleArea(l,c,p),r._area2=THREE.GeometryUtils.triangleArea(c,h,p),r._area=r._area1+r._area2),a+=r._area,f[i]=a;r=[];for(i=0;i<t;i++)o=THREE.GeometryUtils.random()*a,o=n(o),r[i]=THREE.GeometryUtils.randomPointInFace(s[o],e,!0);return r},triangleArea:function(e,t,n){var r=THREE.GeometryUtils.__v1,i=THREE.GeometryUtils.__v2;return r.subVectors(t,e),i.subVectors(n,e),r.cross(i),.5*r.length()},center:function(e){e.computeBoundingBox();var t=e.boundingBox,n=new THREE.Vector3;return n.addVectors(t.min,t.max),n.multiplyScalar(-0.5),e.applyMatrix((new THREE.Matrix4).makeTranslation(n.x,n.y,n.z)),e.computeBoundingBox(),n},normalizeUVs:function(e){for(var e=e.faceVertexUvs[0],t=0,n=e.length;t<n;t++)for(var r=e[t],i=0,s=r.length;i<s;i++)1!==r[i].x&&(r[i].x-=Math.floor(r[i].x)),1!==r[i].y&&(r[i].y-=Math.floor(r[i].y))},triangulateQuads:function(e){var t,n,r,i,s=[],o=[],u=[];t=0;for(n=e.faceUvs.length;t<n;t++)o[t]=[];t=0;for(n=e.faceVertexUvs.length;t<n;t++)u[t]=[];t=0;for(n=e.faces.length;t<n;t++)if(r=e.faces[t],r instanceof THREE.Face4){i=r.a;var a=r.b,f=r.c,l=r.d,c=new THREE.Face3,h=new THREE.Face3;c.color.copy(r.color),h.color.copy(r.color),c.materialIndex=r.materialIndex,h.materialIndex=r.materialIndex,c.a=i,c.b=a,c.c=l,h.a=a,h.b=f,h.c=l,4===r.vertexColors.length&&(c.vertexColors[0]=r.vertexColors[0].clone(),c.vertexColors[1]=r.vertexColors[1].clone(),c.vertexColors[2]=r.vertexColors[3].clone(),h.vertexColors[0]=r.vertexColors[1].clone(),h.vertexColors[1]=r.vertexColors[2].clone(),h.vertexColors[2]=r.vertexColors[3].clone()),s.push(c,h),r=0;for(i=e.faceVertexUvs.length;r<i;r++)e.faceVertexUvs[r].length&&(c=e.faceVertexUvs[r][t],a=c[1],f=c[2],l=c[3],c=[c[0].clone(),a.clone(),l.clone()],a=[a.clone(),f.clone(),l.clone()],u[r].push(c,a));r=0;for(i=e.faceUvs.length;r<i;r++)e.faceUvs[r].length&&(a=e.faceUvs[r][t],o[r].push(a,a))}else{s.push(r),r=0;for(i=e.faceUvs.length;r<i;r++)o[r].push(e.faceUvs[r][t]);r=0;for(i=e.faceVertexUvs.length;r<i;r++)u[r].push(e.faceVertexUvs[r][t])}e.faces=s,e.faceUvs=o,e.faceVertexUvs=u,e.computeCentroids(),e.computeFaceNormals(),e.computeVertexNormals(),e.hasTangents&&e.computeTangents()},setMaterialIndex:function(e,t,n,r){e=e.faces,r=r||e.length-1;for(n=n||0;n<=r;n++)e[n].materialIndex=t}},THREE.GeometryUtils.random=THREE.Math.random16,THREE.GeometryUtils.__v1=new THREE.Vector3,THREE.GeometryUtils.__v2=new THREE.Vector3,THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(e,t,n,r){var i=new Image,s=new THREE.Texture(i,t),t=new THREE.ImageLoader;return t.addEventListener("load",function(e){s.image=e.content,s.needsUpdate=!0,n&&n(s)}),t.addEventListener("error",function(e){r&&r(e.message)}),t.crossOrigin=this.crossOrigin,t.load(e,i),s.sourceFile=e,s},loadCompressedTexture:function(e,t,n,r){var i=new THREE.CompressedTexture;i.mapping=t;var s=new XMLHttpRequest;return s.onload=function(){var e=THREE.ImageUtils.parseDDS(s.response,!0);i.format=e.format,i.mipmaps=e.mipmaps,i.image.width=e.width,i.image.height=e.height,i.generateMipmaps=!1,i.needsUpdate=!0,n&&n(i)},s.onerror=r,s.open("GET",e,!0),s.responseType="arraybuffer",s.send(null),i},loadTextureCube:function(e,t,n,r){var i=[];i.loadCount=0;var s=new THREE.Texture;s.image=i,void 0!==t&&(s.mapping=t),s.flipY=!1;for(var t=0,o=e.length;t<o;++t){var u=new Image;i[t]=u,u.onload=function(){i.loadCount+=1,6===i.loadCount&&(s.needsUpdate=!0,n&&n(s))},u.onerror=r,u.crossOrigin=this.crossOrigin,u.src=e[t]}return s},loadCompressedTextureCube:function(e,t,n,r){var i=[];i.loadCount=0;var s=new THREE.CompressedTexture;s.image=i,void 0!==t&&(s.mapping=t),s.flipY=!1,s.generateMipmaps=!1,t=function(e,t){return function(){var r=THREE.ImageUtils.parseDDS(e.response,!0);t.format=r.format,t.mipmaps=r.mipmaps,t.width=r.width,t.height=r.height,i.loadCount+=1,6===i.loadCount&&(s.format=r.format,s.needsUpdate=!0,n&&n(s))}};if(e instanceof Array)for(var o=0,u=e.length;o<u;++o){var a={};i[o]=a;var f=new XMLHttpRequest;f.onload=t(f,a),f.onerror=r,a=e[o],f.open("GET",a,!0),f.responseType="arraybuffer",f.send(null)}else f=new XMLHttpRequest,f.onload=function(){var e=THREE.ImageUtils.parseDDS(f.response,!0);if(e.isCubemap){for(var t=e.mipmaps.length/e.mipmapCount,r=0;r<t;r++){i[r]={mipmaps:[]};for(var o=0;o<e.mipmapCount;o++)i[r].mipmaps.push(e.mipmaps[r*e.mipmapCount+o]),i[r].format=e.format,i[r].width=e.width,i[r].height=e.height}s.format=e.format,s.needsUpdate=!0,n&&n(s)}},f.onerror=r,f.open("GET",e,!0),f.responseType="arraybuffer",f.send(null);return s},parseDDS:function(e,t){function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var r={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},i=n("DXT1"),s=n("DXT3"),o=n("DXT5"),u=new Int32Array(e,0,31);if(542327876!==u[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),r;if(!u[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),r;var a=u[21];switch(a){case i:i=8,r.format=THREE.RGB_S3TC_DXT1_Format;break;case s:i=16,r.format=THREE.RGBA_S3TC_DXT3_Format;break;case o:i=16,r.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)),r}r.mipmapCount=1,u[2]&131072&&!1!==t&&(r.mipmapCount=Math.max(1,u[7])),r.isCubemap=u[28]&512?!0:!1,r.width=u[4],r.height=u[3];for(var u=u[1]+4,s=r.width,o=r.height,a=r.isCubemap?6:1,f=0;f<a;f++){for(var l=0;l<r.mipmapCount;l++){var c=Math.max(4,s)/4*Math.max(4,o)/4*i,h={data:new Uint8Array(e,u,c),width:s,height:o};r.mipmaps.push(h),u+=c,s=Math.max(.5*s,1),o=Math.max(.5*o,1)}s=r.width,o=r.height}return r},getNormalMap:function(e,t){var n=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]},t=t|1,r=e.width,i=e.height,s=document.createElement("canvas");s.width=r,s.height=i;var o=s.getContext("2d");o.drawImage(e,0,0);for(var u=o.getImageData(0,0,r,i).data,a=o.createImageData(r,i),f=a.data,l=0;l<r;l++)for(var c=0;c<i;c++){var h=0>c-1?0:c-1,p=c+1>i-1?i-1:c+1,d=0>l-1?0:l-1,v=l+1>r-1?r-1:l+1,m=[],g=[0,0,u[4*(c*r+l)]/255*t];m.push([-1,0,u[4*(c*r+d)]/255*t]),m.push([-1,-1,u[4*(h*r+d)]/255*t]),m.push([0,-1,u[4*(h*r+l)]/255*t]),m.push([1,-1,u[4*(h*r+v)]/255*t]),m.push([1,0,u[4*(c*r+v)]/255*t]),m.push([1,1,u[4*(p*r+v)]/255*t]),m.push([0,1,u[4*(p*r+l)]/255*t]),m.push([-1,1,u[4*(p*r+d)]/255*t]),h=[],d=m.length;for(p=0;p<d;p++){var v=m[p],y=m[(p+1)%d],v=[v[0]-g[0],v[1]-g[1],v[2]-g[2]],y=[y[0]-g[0],y[1]-g[1],y[2]-g[2]];h.push(n([v[1]*y[2]-v[2]*y[1],v[2]*y[0]-v[0]*y[2],v[0]*y[1]-v[1]*y[0]]))}m=[0,0,0];for(p=0;p<h.length;p++)m[0]+=h[p][0],m[1]+=h[p][1],m[2]+=h[p][2];m[0]/=h.length,m[1]/=h.length,m[2]/=h.length,g=4*(c*r+l),f[g]=255*((m[0]+1)/2)|0,f[g+1]=255*((m[1]+1)/2)|0,f[g+2]=255*m[2]|0,f[g+3]=255}return o.putImageData(a,0,0),s},generateDataTexture:function(e,t,n){for(var r=e*t,i=new Uint8Array(3*r),s=Math.floor(255*n.r),o=Math.floor(255*n.g),n=Math.floor(255*n.b),u=0;u<r;u++)i[3*u]=s,i[3*u+1]=o,i[3*u+2]=n;return e=new THREE.DataTexture(i,e,t,THREE.RGBFormat),e.needsUpdate=!0,e}},THREE.SceneUtils={createMultiMaterialObject:function(e,t){for(var n=new THREE.Object3D,r=0,i=t.length;r<i;r++)n.add(new THREE.Mesh(e,t[r]));return n},detach:function(e,t,n){e.applyMatrix(t.matrixWorld),t.remove(e),n.add(e)},attach:function(e,t,n){var r=new THREE.Matrix4;r.getInverse(n.matrixWorld),e.applyMatrix(r),t.remove(e),n.add(e)}},THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(e){var t=e.familyName.toLowerCase();return this.faces[t]=this.faces[t]||{},this.faces[t][e.cssFontWeight]=this.faces[t][e.cssFontWeight]||{},this.faces[t][e.cssFontWeight][e.cssFontStyle]=e,this.faces[t][e.cssFontWeight][e.cssFontStyle]=e},drawText:function(e){for(var t=this.getFace(),n=this.size/t.resolution,r=0,i=String(e).split(""),s=i.length,o=[],e=0;e<s;e++){var u=new THREE.Path,u=this.extractGlyphPoints(i[e],t,n,r,u),r=r+u.offset;o.push(u.path)}return{paths:o,offset:r/2}},extractGlyphPoints:function(e,t,n,r,i){var s=[],o,u,a,f,l,c,h,p,d,v,m,g=t.glyphs[e]||t.glyphs["?"];if(g){if(g.o){t=g._cachedOutline||(g._cachedOutline=g.o.split(" ")),f=t.length;for(e=0;e<f;)switch(a=t[e++],a){case"m":a=t[e++]*n+r,l=t[e++]*n,i.moveTo(a,l);break;case"l":a=t[e++]*n+r,l=t[e++]*n,i.lineTo(a,l);break;case"q":a=t[e++]*n+r,l=t[e++]*n,p=t[e++]*n+r,d=t[e++]*n,i.quadraticCurveTo(p,d,a,l);if(o=s[s.length-1]){c=o.x,h=o.y,o=1;for(u=this.divisions;o<=u;o++){var y=o/u;THREE.Shape.Utils.b2(y,c,p,a),THREE.Shape.Utils.b2(y,h,d,l)}}break;case"b":if(a=t[e++]*n+r,l=t[e++]*n,p=t[e++]*n+r,d=t[e++]*-n,v=t[e++]*n+r,m=t[e++]*-n,i.bezierCurveTo(a,l,p,d,v,m),o=s[s.length-1]){c=o.x,h=o.y,o=1;for(u=this.divisions;o<=u;o++)y=o/u,THREE.Shape.Utils.b3(y,c,p,v,a),THREE.Shape.Utils.b3(y,h,d,m,l)}}}return{offset:g.ha*n,path:i}}}},THREE.FontUtils.generateShapes=function(e,t){var t=t||{},n=void 0!==t.curveSegments?t.curveSegments:4,r=void 0!==t.font?t.font:"helvetiker",i=void 0!==t.weight?t.weight:"normal",s=void 0!==t.style?t.style:"normal";THREE.FontUtils.size=void 0!==t.size?t.size:100,THREE.FontUtils.divisions=n,THREE.FontUtils.face=r,THREE.FontUtils.weight=i,THREE.FontUtils.style=s,n=THREE.FontUtils.drawText(e).paths,r=[],i=0;for(s=n.length;i<s;i++)Array.prototype.push.apply(r,n[i].toShapes());return r},function(e){var t=function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n};return e.Triangulate=function(e,n){var r=e.length;if(3>r)return null;var i=[],s=[],o=[],u,a,f;if(0<t(e))for(a=0;a<r;a++)s[a]=a;else for(a=0;a<r;a++)s[a]=r-1-a;var l=2*r;for(a=r-1;2<r;){if(0>=l--){console.log("Warning, unable to triangulate polygon!");break}u=a,r<=u&&(u=0),a=u+1,r<=a&&(a=0),f=a+1,r<=f&&(f=0);var c;e:{var h=c=void 0,p=void 0,d=void 0,v=void 0,m=void 0,g=void 0,y=void 0,w=void 0,h=e[s[u]].x,p=e[s[u]].y,d=e[s[a]].x,v=e[s[a]].y,m=e[s[f]].x,g=e[s[f]].y;if(1e-10>(d-h)*(g-p)-(v-p)*(m-h))c=!1;else{var E=void 0,S=void 0,x=void 0,T=void 0,N=void 0,C=void 0,k=void 0,L=void 0,A=void 0,O=void 0,A=L=k=w=y=void 0,E=m-d,S=g-v,x=h-m,T=p-g,N=d-h,C=v-p;for(c=0;c<r;c++)if(c!==u&&c!==a&&c!==f)if(y=e[s[c]].x,w=e[s[c]].y,k=y-h,L=w-p,A=y-d,O=w-v,y-=m,w-=g,A=E*O-S*A,k=N*L-C*k,L=x*w-T*y,0<=A&&0<=L&&0<=k){c=!1;break e}c=!0}}if(c){i.push([e[s[u]],e[s[a]],e[s[f]]]),o.push([s[u],s[a],s[f]]),u=a;for(f=a+1;f<r;u++,f++)s[u]=s[f];r--,l=2*r}}return n?o:i},e.Triangulate.area=t,e}(THREE.FontUtils),self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace},THREE.typeface_js=self._typeface_js,THREE.Curve=function(){},THREE.Curve.prototype.getPoint=function(){return console.log("Warning, getPoint() not implemented!"),null},THREE.Curve.prototype.getPointAt=function(e){return e=this.getUtoTmapping(e),this.getPoint(e)},THREE.Curve.prototype.getPoints=function(e){e||(e=5);var t,n=[];for(t=0;t<=e;t++)n.push(this.getPoint(t/e));return n},THREE.Curve.prototype.getSpacedPoints=function(e){e||(e=5);var t,n=[];for(t=0;t<=e;t++)n.push(this.getPointAt(t/e));return n},THREE.Curve.prototype.getLength=function(){var e=this.getLengths();return e[e.length-1]},THREE.Curve.prototype.getLengths=function(e){e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],n,r=this.getPoint(0),i,s=0;t.push(0);for(i=1;i<=e;i++)n=this.getPoint(i/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t},THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0,this.getLengths()},THREE.Curve.prototype.getUtoTmapping=function(e,t){var n=this.getLengths(),r=0,i=n.length,s;s=t?t:e*n[i-1];for(var o=0,u=i-1,a;o<=u;)if(r=Math.floor(o+(u-o)/2),a=n[r]-s,0>a)o=r+1;else{if(!(0<a)){u=r;break}u=r-1}return r=u,n[r]==s?r/(i-1):(o=n[r],n=(r+(s-o)/(n[r+1]-o))/(i-1))},THREE.Curve.prototype.getTangent=function(e){var t=e-1e-4,e=e+1e-4;return 0>t&&(t=0),1<e&&(e=1),t=this.getPoint(t),this.getPoint(e).clone().sub(t).normalize()},THREE.Curve.prototype.getTangentAt=function(e){return e=this.getUtoTmapping(e),this.getTangent(e)},THREE.LineCurve=function(e,t){this.v1=e,this.v2=t},THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.LineCurve.prototype.getPoint=function(e){var t=this.v2.clone().sub(this.v1);return t.multiplyScalar(e).add(this.v1),t},THREE.LineCurve.prototype.getPointAt=function(e){return this.getPoint(e)},THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},THREE.QuadraticBezierCurve=function(e,t,n){this.v0=e,this.v1=t,this.v2=n},THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.QuadraticBezierCurve.prototype.getPoint=function(e){var t;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),e=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),new THREE.Vector2(t,e)},THREE.QuadraticBezierCurve.prototype.getTangent=function(e){var t;return t=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.x,this.v1.x,this.v2.x),e=THREE.Curve.Utils.tangentQuadraticBezier(e,this.v0.y,this.v1.y,this.v2.y),t=new THREE.Vector2(t,e),t.normalize(),t},THREE.CubicBezierCurve=function(e,t,n,r){this.v0=e,this.v1=t,this.v2=n,this.v3=r},THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype),THREE.CubicBezierCurve.prototype.getPoint=function(e){var t;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new THREE.Vector2(t,e)},THREE.CubicBezierCurve.prototype.getTangent=function(e){var t;return t=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e=THREE.Curve.Utils.tangentCubicBezier(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),t=new THREE.Vector2(t,e),t.normalize(),t},THREE.SplineCurve=function(e){this.points=void 0==e?[]:e},THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype),THREE.SplineCurve.prototype.getPoint=function(e){var t=new THREE.Vector2,n=[],r=this.points,i;return i=(r.length-1)*e,e=Math.floor(i),i-=e,n[0]=0==e?e:e-1,n[1]=e,n[2]=e>r.length-2?r.length-1:e+1,n[3]=e>r.length-3?r.length-1:e+2,t.x=THREE.Curve.Utils.interpolate(r[n[0]].x,r[n[1]].x,r[n[2]].x,r[n[3]].x,i),t.y=THREE.Curve.Utils.interpolate(r[n[0]].y,r[n[1]].y,r[n[2]].y,r[n[3]].y,i),t},THREE.EllipseCurve=function(e,t,n,r,i,s,o){this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=s,this.aClockwise=o},THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype),THREE.EllipseCurve.prototype.getPoint=function(e){var t=this.aEndAngle-this.aStartAngle;return this.aClockwise||(e=1-e),t=this.aStartAngle+e*t,e=this.aX+this.xRadius*Math.cos(t),t=this.aY+this.yRadius*Math.sin(t),new THREE.Vector2(e,t)},THREE.ArcCurve=function(e,t,n,r,i,s){THREE.EllipseCurve.call(this,e,t,n,n,r,i,s)},THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype),THREE.Curve.Utils={tangentQuadraticBezier:function(e,t,n,r){return 2*(1-e)*(n-t)+2*e*(r-n)},tangentCubicBezier:function(e,t,n,r,i){return-3*t*(1-e)*(1-e)+3*n*(1-e)*(1-e)-6*e*n*(1-e)+6*e*r*(1-e)-3*e*e*r+3*e*e*i},tangentSpline:function(e){return 6*e*e-6*e+(3*e*e-4*e+1)+(-6*e*e+6*e)+(3*e*e-2*e)},interpolate:function(e,t,n,r,i){var e=.5*(n-e),r=.5*(r-t),s=i*i;return(2*t-2*n+e+r)*i*s+(-3*t+3*n-2*e-r)*s+e*i+t}},THREE.Curve.create=function(e,t){return e.prototype=Object.create(THREE.Curve.prototype),e.prototype.getPoint=t,e},THREE.LineCurve3=THREE.Curve.create(function(e,t){this.v1=e,this.v2=t},function(e){var t=new THREE.Vector3;return t.subVectors(this.v2,this.v1),t.multiplyScalar(e),t.add(this.v1),t}),THREE.QuadraticBezierCurve3=THREE.Curve.create(function(e,t,n){this.v0=e,this.v1=t,this.v2=n},function(e){var t,n;return t=THREE.Shape.Utils.b2(e,this.v0.x,this.v1.x,this.v2.x),n=THREE.Shape.Utils.b2(e,this.v0.y,this.v1.y,this.v2.y),e=THREE.Shape.Utils.b2(e,this.v0.z,this.v1.z,this.v2.z),new THREE.Vector3(t,n,e)}),THREE.CubicBezierCurve3=THREE.Curve.create(function(e,t,n,r){this.v0=e,this.v1=t,this.v2=n,this.v3=r},function(e){var t,n;return t=THREE.Shape.Utils.b3(e,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=THREE.Shape.Utils.b3(e,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e=THREE.Shape.Utils.b3(e,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new THREE.Vector3(t,n,e)}),THREE.SplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3,n=[],r=this.points,i,e=(r.length-1)*e;i=Math.floor(e),e-=i,n[0]=0==i?i:i-1,n[1]=i,n[2]=i>r.length-2?r.length-1:i+1,n[3]=i>r.length-3?r.length-1:i+2,i=r[n[0]];var s=r[n[1]],o=r[n[2]],n=r[n[3]];return t.x=THREE.Curve.Utils.interpolate(i.x,s.x,o.x,n.x,e),t.y=THREE.Curve.Utils.interpolate(i.y,s.y,o.y,n.y,e),t.z=THREE.Curve.Utils.interpolate(i.z,s.z,o.z,n.z,e),t}),THREE.ClosedSplineCurve3=THREE.Curve.create(function(e){this.points=void 0==e?[]:e},function(e){var t=new THREE.Vector3,n=[],r=this.points,i;return i=(r.length-0)*e,e=Math.floor(i),i-=e,e+=0<e?0:(Math.floor(Math.abs(e)/r.length)+1)*r.length,n[0]=(e-1)%r.length,n[1]=e%r.length,n[2]=(e+1)%r.length,n[3]=(e+2)%r.length,t.x=THREE.Curve.Utils.interpolate(r[n[0]].x,r[n[1]].x,r[n[2]].x,r[n[3]].x,i),t.y=THREE.Curve.Utils.interpolate(r[n[0]].y,r[n[1]].y,r[n[2]].y,r[n[3]].y,i),t.z=THREE.Curve.Utils.interpolate(r[n[0]].z,r[n[1]].z,r[n[2]].z,r[n[3]].z,i),t}),THREE.CurvePath=function(){this.curves=[],this.bends=[],this.autoClose=!1},THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype),THREE.CurvePath.prototype.add=function(e){this.curves.push(e)},THREE.CurvePath.prototype.checkConnection=function(){},THREE.CurvePath.prototype.closePath=function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new THREE.LineCurve(t,e))},THREE.CurvePath.prototype.getPoint=function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),e=0;e<n.length;){if(n[e]>=t)return t=n[e]-t,e=this.curves[e],t=1-t/e.getLength(),e.getPointAt(t);e++}return null},THREE.CurvePath.prototype.getLength=function(){var e=this.getCurveLengths();return e[e.length-1]},THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e=[],t=0,n,r=this.curves.length;for(n=0;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},THREE.CurvePath.prototype.getBoundingBox=function(){var e=this.getPoints(),t,n,r,i,s,o;t=n=Number.NEGATIVE_INFINITY,i=s=Number.POSITIVE_INFINITY;var u,a,f,l,c=e[0]instanceof THREE.Vector3;l=c?new THREE.Vector3:new THREE.Vector2,a=0;for(f=e.length;a<f;a++)u=e[a],u.x>t?t=u.x:u.x<i&&(i=u.x),u.y>n?n=u.y:u.y<s&&(s=u.y),c&&(u.z>r?r=u.z:u.z<o&&(o=u.z)),l.add(u);return e={minX:i,minY:s,maxX:t,maxY:n,centroid:l.divideScalar(f)},c&&(e.maxZ=r,e.minZ=o),e},THREE.CurvePath.prototype.createPointsGeometry=function(e){return e=this.getPoints(e,!0),this.createGeometry(e)},THREE.CurvePath.prototype.createSpacedPointsGeometry=function(e){return e=this.getSpacedPoints(e,!0),this.createGeometry(e)},THREE.CurvePath.prototype.createGeometry=function(e){for(var t=new THREE.Geometry,n=0;n<e.length;n++)t.vertices.push(new THREE.Vector3(e[n].x,e[n].y,e[n].z||0));return t},THREE.CurvePath.prototype.addWrapPath=function(e){this.bends.push(e)},THREE.CurvePath.prototype.getTransformedPoints=function(e,t){var n=this.getPoints(e),r,i;t||(t=this.bends),r=0;for(i=t.length;r<i;r++)n=this.getWrapPoints(n,t[r]);return n},THREE.CurvePath.prototype.getTransformedSpacedPoints=function(e,t){var n=this.getSpacedPoints(e),r,i;t||(t=this.bends),r=0;for(i=t.length;r<i;r++)n=this.getWrapPoints(n,t[r]);return n},THREE.CurvePath.prototype.getWrapPoints=function(e,t){var n=this.getBoundingBox(),r,i,s,o,u,a;r=0;for(i=e.length;r<i;r++)s=e[r],o=s.x,u=s.y,a=o/n.maxX,a=t.getUtoTmapping(a,o),o=t.getPoint(a),u=t.getNormalVector(a).multiplyScalar(u),s.x=o.x+u.x,s.y=o.y+u.y;return e},THREE.Gyroscope=function(){THREE.Object3D.call(this)},THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype),THREE.Gyroscope.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.makeFromPositionQuaternionScale(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0;for(var t=0,n=this.children.length;t<n;t++)this.children[t].updateMatrixWorld(e)},THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3,THREE.Gyroscope.prototype.translationObject=new THREE.Vector3,THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion,THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion,THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3,THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3,THREE.Path=function(e){THREE.CurvePath.call(this),this.actions=[],e&&this.fromPoints(e)},THREE.Path.prototype=Object.create(THREE.CurvePath.prototype),THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"},THREE.Path.prototype.fromPoints=function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},THREE.Path.prototype.moveTo=function(e,t){var n=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:n})},THREE.Path.prototype.lineTo=function(e,t){var n=Array.prototype.slice.call(arguments),r=this.actions[this.actions.length-1].args,r=new THREE.LineCurve(new THREE.Vector2(r[r.length-2],r[r.length-1]),new THREE.Vector2(e,t));this.curves.push(r),this.actions.push({action:THREE.PathActions.LINE_TO,args:n})},THREE.Path.prototype.quadraticCurveTo=function(e,t,n,r){var i=Array.prototype.slice.call(arguments),s=this.actions[this.actions.length-1].args,s=new THREE.QuadraticBezierCurve(new THREE.Vector2(s[s.length-2],s[s.length-1]),new THREE.Vector2(e,t),new THREE.Vector2(n,r));this.curves.push(s),this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:i})},THREE.Path.prototype.bezierCurveTo=function(e,t,n,r,i,s){var o=Array.prototype.slice.call(arguments),u=this.actions[this.actions.length-1].args,u=new THREE.CubicBezierCurve(new THREE.Vector2(u[u.length-2],u[u.length-1]),new THREE.Vector2(e,t),new THREE.Vector2(n,r),new THREE.Vector2(i,s));this.curves.push(u),this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:o})},THREE.Path.prototype.splineThru=function(e){var t=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,n=[new THREE.Vector2(n[n.length-2],n[n.length-1])];Array.prototype.push.apply(n,e),n=new THREE.SplineCurve(n),this.curves.push(n),this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:t})},THREE.Path.prototype.arc=function(e,t,n,r,i,s){var o=this.actions[this.actions.length-1].args;this.absarc(e+o[o.length-2],t+o[o.length-1],n,r,i,s)},THREE.Path.prototype.absarc=function(e,t,n,r,i,s){this.absellipse(e,t,n,n,r,i,s)},THREE.Path.prototype.ellipse=function(e,t,n,r,i,s,o){var u=this.actions[this.actions.length-1].args;this.absellipse(e+u[u.length-2],t+u[u.length-1],n,r,i,s,o)},THREE.Path.prototype.absellipse=function(e,t,n,r,i,s,o){var u=Array.prototype.slice.call(arguments),a=new THREE.EllipseCurve(e,t,n,r,i,s,o);this.curves.push(a),a=a.getPoint(o?1:0),u.push(a.x),u.push(a.y),this.actions.push({action:THREE.PathActions.ELLIPSE,args:u})},THREE.Path.prototype.getSpacedPoints=function(e){e||(e=40);for(var t=[],n=0;n<e;n++)t.push(this.getPoint(n/e));return t},THREE.Path.prototype.getPoints=function(e,t){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(e,t);var e=e||12,n=[],r,i,s,o,u,a,f,l,c,h,p,d,v;r=0;for(i=this.actions.length;r<i;r++)switch(s=this.actions[r],o=s.action,s=s.args,o){case THREE.PathActions.MOVE_TO:n.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.LINE_TO:n.push(new THREE.Vector2(s[0],s[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:u=s[2],a=s[3],c=s[0],h=s[1],0<n.length?(o=n[n.length-1],p=o.x,d=o.y):(o=this.actions[r-1].args,p=o[o.length-2],d=o[o.length-1]);for(s=1;s<=e;s++)v=s/e,o=THREE.Shape.Utils.b2(v,p,c,u),v=THREE.Shape.Utils.b2(v,d,h,a),n.push(new THREE.Vector2(o,v));break;case THREE.PathActions.BEZIER_CURVE_TO:u=s[4],a=s[5],c=s[0],h=s[1],f=s[2],l=s[3],0<n.length?(o=n[n.length-1],p=o.x,d=o.y):(o=this.actions[r-1].args,p=o[o.length-2],d=o[o.length-1]);for(s=1;s<=e;s++)v=s/e,o=THREE.Shape.Utils.b3(v,p,c,f,u),v=THREE.Shape.Utils.b3(v,d,h,l,a),n.push(new THREE.Vector2(o,v));break;case THREE.PathActions.CSPLINE_THRU:o=this.actions[r-1].args,v=[new THREE.Vector2(o[o.length-2],o[o.length-1])],o=e*s[0].length,v=v.concat(s[0]),v=new THREE.SplineCurve(v);for(s=1;s<=o;s++)n.push(v.getPointAt(s/o));break;case THREE.PathActions.ARC:u=s[0],a=s[1],h=s[2],f=s[3],o=s[4],c=!!s[5],p=o-f,d=2*e;for(s=1;s<=d;s++)v=s/d,c||(v=1-v),v=f+v*p,o=u+h*Math.cos(v),v=a+h*Math.sin(v),n.push(new THREE.Vector2(o,v));break;case THREE.PathActions.ELLIPSE:u=s[0],a=s[1],h=s[2],l=s[3],f=s[4],o=s[5],c=!!s[6],p=o-f,d=2*e;for(s=1;s<=d;s++)v=s/d,c||(v=1-v),v=f+v*p,o=u+h*Math.cos(v),v=a+l*Math.sin(v),n.push(new THREE.Vector2(o,v))}return r=n[n.length-1],1e-10>Math.abs(r.x-n[0].x)&&1e-10>Math.abs(r.y-n[0].y)&&n.splice(n.length-1,1),t&&n.push(n[0]),n},THREE.Path.prototype.toShapes=function(){var e,t,n,r,i=[],s=new THREE.Path;e=0;for(t=this.actions.length;e<t;e++)n=this.actions[e],r=n.args,n=n.action,n==THREE.PathActions.MOVE_TO&&0!=s.actions.length&&(i.push(s),s=new THREE.Path),s[n].apply(s,r);0!=s.actions.length&&i.push(s);if(0==i.length)return[];var o;r=[],e=!THREE.Shape.Utils.isClockWise(i[0].getPoints());if(1==i.length)return s=i[0],o=new THREE.Shape,o.actions=s.actions,o.curves=s.curves,r.push(o),r;if(e){o=new THREE.Shape,e=0;for(t=i.length;e<t;e++)s=i[e],THREE.Shape.Utils.isClockWise(s.getPoints())?(o.actions=s.actions,o.curves=s.curves,r.push(o),o=new THREE.Shape):o.holes.push(s)}else{e=0;for(t=i.length;e<t;e++)s=i[e],THREE.Shape.Utils.isClockWise(s.getPoints())?(o&&r.push(o),o=new THREE.Shape,o.actions=s.actions,o.curves=s.curves):o.holes.push(s);r.push(o)}return r},THREE.Shape=function(){THREE.Path.apply(this,arguments),this.holes=[]},THREE.Shape.prototype=Object.create(THREE.Path.prototype),THREE.Shape.prototype.extrude=function(e){return new THREE.ExtrudeGeometry(this,e)},THREE.Shape.prototype.makeGeometry=function(e){return new THREE.ShapeGeometry(this,e)},THREE.Shape.prototype.getPointsHoles=function(e){var t,n=this.holes.length,r=[];for(t=0;t<n;t++)r[t]=this.holes[t].getTransformedPoints(e,this.bends);return r},THREE.Shape.prototype.getSpacedPointsHoles=function(e){var t,n=this.holes.length,r=[];for(t=0;t<n;t++)r[t]=this.holes[t].getTransformedSpacedPoints(e,this.bends);return r},THREE.Shape.prototype.extractAllPoints=function(e){return{shape:this.getTransformedPoints(e),holes:this.getPointsHoles(e)}},THREE.Shape.prototype.extractPoints=function(e){return this.useSpacedPoints?this.extractAllSpacedPoints(e):this.extractAllPoints(e)},THREE.Shape.prototype.extractAllSpacedPoints=function(e){return{shape:this.getTransformedSpacedPoints(e),holes:this.getSpacedPointsHoles(e)}},THREE.Shape.Utils={removeHoles:function(e,t){var n=e.concat(),r=n.concat(),i,s,o,u,a,f,l,c,h,p,d=[];for(a=0;a<t.length;a++){f=t[a],Array.prototype.push.apply(r,f),s=Number.POSITIVE_INFINITY;for(i=0;i<f.length;i++){h=f[i],p=[];for(c=0;c<n.length;c++)l=n[c],l=h.distanceToSquared(l),p.push(l),l<s&&(s=l,o=i,u=c)}i=0<=u-1?u-1:n.length-1,s=0<=o-1?o-1:f.length-1;var v=[f[o],n[u],n[i]];c=THREE.FontUtils.Triangulate.area(v);var m=[f[o],f[s],n[u]];h=THREE.FontUtils.Triangulate.area(m),p=u,l=o,u+=1,o+=-1,0>u&&(u+=n.length),u%=n.length,0>o&&(o+=f.length),o%=f.length,i=0<=u-1?u-1:n.length-1,s=0<=o-1?o-1:f.length-1,v=[f[o],n[u],n[i]],v=THREE.FontUtils.Triangulate.area(v),m=[f[o],f[s],n[u]],m=THREE.FontUtils.Triangulate.area(m),c+h>v+m&&(u=p,o=l,0>u&&(u+=n.length),u%=n.length,0>o&&(o+=f.length),o%=f.length,i=0<=u-1?u-1:n.length-1,s=0<=o-1?o-1:f.length-1),c=n.slice(0,u),h=n.slice(u),p=f.slice(o),l=f.slice(0,o),s=[f[o],f[s],n[u]],d.push([f[o],n[u],n[i]]),d.push(s),n=c.concat(p).concat(l).concat(h)}return{shape:n,isolatedPts:d,allpoints:r}},triangulateShape:function(e,t){var n=THREE.Shape.Utils.removeHoles(e,t),r=n.allpoints,i=n.isolatedPts,n=THREE.FontUtils.Triangulate(n.shape,!1),s,o,u,a,f={};s=0;for(o=r.length;s<o;s++)a=r[s].x+":"+r[s].y,void 0!==f[a]&&console.log("Duplicate point",a),f[a]=s;s=0;for(o=n.length;s<o;s++){u=n[s];for(r=0;3>r;r++)a=u[r].x+":"+u[r].y,a=f[a],void 0!==a&&(u[r]=a)}s=0;for(o=i.length;s<o;s++){u=i[s];for(r=0;3>r;r++)a=u[r].x+":"+u[r].y,a=f[a],void 0!==a&&(u[r]=a)}return n.concat(i)},isClockWise:function(e){return 0>THREE.FontUtils.Triangulate.area(e)},b2p0:function(e,t){var n=1-e;return n*n*t},b2p1:function(e,t){return 2*(1-e)*e*t},b2p2:function(e,t){return e*e*t},b2:function(e,t,n,r){return this.b2p0(e,t)+this.b2p1(e,n)+this.b2p2(e,r)},b3p0:function(e,t){var n=1-e;return n*n*n*t},b3p1:function(e,t){var n=1-e;return 3*n*n*e*t},b3p2:function(e,t){return 3*(1-e)*e*e*t},b3p3:function(e,t){return e*e*e*t},b3:function(e,t,n,r,i){return this.b3p0(e,t)+this.b3p1(e,n)+this.b3p2(e,r)+this.b3p3(e,i)}},THREE.AnimationHandler=function(){var e=[],t={},n={update:function(t){for(var n=0;n<e.length;n++)e[n].update(t)},addToUpdate:function(t){-1===e.indexOf(t)&&e.push(t)},removeFromUpdate:function(t){t=e.indexOf(t),-1!==t&&e.splice(t,1)},add:function(e){void 0!==t[e.name]&&console.log("THREE.AnimationHandler.add: Warning! "+e.name+" already exists in library. Overwriting."),t[e.name]=e;if(!0!==e.initialized){for(var n=0;n<e.hierarchy.length;n++){for(var r=0;r<e.hierarchy[n].keys.length;r++)if(0>e.hierarchy[n].keys[r].time&&(e.hierarchy[n].keys[r].time=0),void 0!==e.hierarchy[n].keys[r].rot&&!(e.hierarchy[n].keys[r].rot instanceof THREE.Quaternion)){var i=e.hierarchy[n].keys[r].rot;e.hierarchy[n].keys[r].rot=new THREE.Quaternion(i[0],i[1],i[2],i[3])}if(e.hierarchy[n].keys.length&&void 0!==e.hierarchy[n].keys[0].morphTargets){i={};for(r=0;r<e.hierarchy[n].keys.length;r++)for(var s=0;s<e.hierarchy[n].keys[r].morphTargets.length;s++){var o=e.hierarchy[n].keys[r].morphTargets[s];i[o]=-1}e.hierarchy[n].usedMorphTargets=i;for(r=0;r<e.hierarchy[n].keys.length;r++){var u={};for(o in i){for(s=0;s<e.hierarchy[n].keys[r].morphTargets.length;s++)if(e.hierarchy[n].keys[r].morphTargets[s]===o){u[o]=e.hierarchy[n].keys[r].morphTargetsInfluences[s];break}s===e.hierarchy[n].keys[r].morphTargets.length&&(u[o]=0)}e.hierarchy[n].keys[r].morphTargetsInfluences=u}}for(r=1;r<e.hierarchy[n].keys.length;r++)e.hierarchy[n].keys[r].time===e.hierarchy[n].keys[r-1].time&&(e.hierarchy[n].keys.splice(r,1),r--);for(r=0;r<e.hierarchy[n].keys.length;r++)e.hierarchy[n].keys[r].index=r}r=parseInt(e.length*e.fps,10),e.JIT={},e.JIT.hierarchy=[];for(n=0;n<e.hierarchy.length;n++)e.JIT.hierarchy.push(Array(r));e.initialized=!0}},get:function(e){if("string"==typeof e)return t[e]?t[e]:(console.log("THREE.AnimationHandler.get: Couldn't find animation "+e),null)},parse:function(e){var t=[];if(e instanceof THREE.SkinnedMesh)for(var n=0;n<e.bones.length;n++)t.push(e.bones[n]);else r(e,t);return t}},r=function(e,t){t.push(e);for(var n=0;n<e.children.length;n++)r(e.children[n],t)};return n.LINEAR=0,n.CATMULLROM=1,n.CATMULLROM_FORWARD=2,n}(),THREE.Animation=function(e,t,n){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=1,this.isPlaying=!1,this.loop=this.isPaused=!0,this.interpolationType=void 0!==n?n:THREE.AnimationHandler.LINEAR,this.points=[],this.target=new THREE.Vector3},THREE.Animation.prototype.play=function(e,t){if(!1===this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0;var n,r=this.hierarchy.length,i;for(n=0;n<r;n++){i=this.hierarchy[n],this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(i.useQuaternion=!0),i.matrixAutoUpdate=!0,void 0===i.animationCache&&(i.animationCache={},i.animationCache.prevKey={pos:0,rot:0,scl:0},i.animationCache.nextKey={pos:0,rot:0,scl:0},i.animationCache.originalMatrix=i instanceof THREE.Bone?i.skinMatrix:i.matrix);var s=i.animationCache.prevKey;i=i.animationCache.nextKey,s.pos=this.data.hierarchy[n].keys[0],s.rot=this.data.hierarchy[n].keys[0],s.scl=this.data.hierarchy[n].keys[0],i.pos=this.getNextKeyWith("pos",n,1),i.rot=this.getNextKeyWith("rot",n,1),i.scl=this.getNextKeyWith("scl",n,1)}this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1,THREE.AnimationHandler.removeFromUpdate(this)},THREE.Animation.prototype.update=function(e){if(!1!==this.isPlaying){var t=["pos","rot","scl"],n,r,i,s,o,u,a,f,l;l=this.currentTime+=e*this.timeScale,f=this.currentTime%=this.data.length,parseInt(Math.min(f*this.data.fps,this.data.length*this.data.fps),10);for(var c=0,h=this.hierarchy.length;c<h;c++){e=this.hierarchy[c],a=e.animationCache;for(var p=0;3>p;p++){n=t[p],o=a.prevKey[n],u=a.nextKey[n];if(u.time<=l){if(f<l){if(!this.loop){this.stop();return}o=this.data.hierarchy[c].keys[0];for(u=this.getNextKeyWith(n,c,1);u.time<f;)o=u,u=this.getNextKeyWith(n,c,u.index+1)}else do o=u,u=this.getNextKeyWith(n,c,u.index+1);while(u.time<f);a.prevKey[n]=o,a.nextKey[n]=u}e.matrixAutoUpdate=!0,e.matrixWorldNeedsUpdate=!0,r=(f-o.time)/(u.time-o.time),i=o[n],s=u[n];if(0>r||1<r)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+r+" on bone "+c),r=0>r?0:1;if("pos"===n){if(n=e.position,this.interpolationType===THREE.AnimationHandler.LINEAR)n.x=i[0]+(s[0]-i[0])*r,n.y=i[1]+(s[1]-i[1])*r,n.z=i[2]+(s[2]-i[2])*r;else if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)this.points[0]=this.getPrevKeyWith("pos",c,o.index-1).pos,this.points[1]=i,this.points[2]=s,this.points[3]=this.getNextKeyWith("pos",c,u.index+1).pos,r=.33*r+.33,i=this.interpolateCatmullRom(this.points,r),n.x=i[0],n.y=i[1],n.z=i[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(r=this.interpolateCatmullRom(this.points,1.01*r),this.target.set(r[0],r[1],r[2]),this.target.sub(n),this.target.y=0,this.target.normalize(),r=Math.atan2(this.target.x,this.target.z),e.rotation.set(0,r,0))}else"rot"===n?THREE.Quaternion.slerp(i,s,e.quaternion,r):"scl"===n&&(n=e.scale,n.x=i[0]+(s[0]-i[0])*r,n.y=i[1]+(s[1]-i[1])*r,n.z=i[2]+(s[2]-i[2])*r)}}}},THREE.Animation.prototype.interpolateCatmullRom=function(e,t){var n=[],r=[],i,s,o,u,a,f;return i=(e.length-1)*t,s=Math.floor(i),i-=s,n[0]=0===s?s:s-1,n[1]=s,n[2]=s>e.length-2?s:s+1,n[3]=s>e.length-3?s:s+2,s=e[n[0]],u=e[n[1]],a=e[n[2]],f=e[n[3]],n=i*i,o=i*n,r[0]=this.interpolate(s[0],u[0],a[0],f[0],i,n,o),r[1]=this.interpolate(s[1],u[1],a[1],f[1],i,n,o),r[2]=this.interpolate(s[2],u[2],a[2],f[2],i,n,o),r},THREE.Animation.prototype.interpolate=function(e,t,n,r,i,s,o){return e=.5*(n-e),r=.5*(r-t),(2*(t-n)+e+r)*o+(-3*(t-n)-2*e-r)*s+e*i+t},THREE.Animation.prototype.getNextKeyWith=function(e,t,n){for(var r=this.data.hierarchy[t].keys,n=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?n<r.length-1?n:r.length-1:n%r.length;n<r.length;n++)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[0]},THREE.Animation.prototype.getPrevKeyWith=function(e,t,n){for(var r=this.data.hierarchy[t].keys,n=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<n?n:0:0<=n?n:n+r.length;0<=n;n--)if(void 0!==r[n][e])return r[n];return this.data.hierarchy[t].keys[r.length-1]},THREE.KeyFrameAnimation=function(e,t,n){this.root=e,this.data=THREE.AnimationHandler.get(t),this.hierarchy=THREE.AnimationHandler.parse(e),this.currentTime=0,this.timeScale=.001,this.isPlaying=!1,this.loop=this.isPaused=!0,this.JITCompile=void 0!==n?n:!0,e=0;for(t=this.hierarchy.length;e<t;e++){var n=this.data.hierarchy[e].sids,r=this.hierarchy[e];if(this.data.hierarchy[e].keys.length&&n){for(var i=0;i<n.length;i++){var s=n[i],o=this.getNextKeyWith(s,e,0);o&&o.apply(s)}r.matrixAutoUpdate=!1,this.data.hierarchy[e].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}},THREE.KeyFrameAnimation.prototype.play=function(e,t){if(!this.isPlaying){this.isPlaying=!0,this.loop=void 0!==e?e:!0,this.currentTime=void 0!==t?t:0,this.startTimeMs=t,this.startTime=1e7,this.endTime=-this.startTime;var n,r=this.hierarchy.length,i,s;for(n=0;n<r;n++)i=this.hierarchy[n],s=this.data.hierarchy[n],i.useQuaternion=!0,void 0===s.animationCache&&(s.animationCache={},s.animationCache.prevKey=null,s.animationCache.nextKey=null,s.animationCache.originalMatrix=i instanceof THREE.Bone?i.skinMatrix:i.matrix),i=this.data.hierarchy[n].keys,i.length&&(s.animationCache.prevKey=i[0],s.animationCache.nextKey=i[1],this.startTime=Math.min(i[0].time,this.startTime),this.endTime=Math.max(i[i.length-1].time,this.endTime));this.update(0)}this.isPaused=!1,THREE.AnimationHandler.addToUpdate(this)},THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this),this.isPaused=!this.isPaused},THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1,THREE.AnimationHandler.removeFromUpdate(this);for(var e=0;e<this.data.hierarchy.length;e++){var t=this.hierarchy[e],n=this.data.hierarchy[e];if(void 0!==n.animationCache){var r=n.animationCache.originalMatrix;t instanceof THREE.Bone?(r.copy(t.skinMatrix),t.skinMatrix=r):(r.copy(t.matrix),t.matrix=r),delete n.animationCache}}},THREE.KeyFrameAnimation.prototype.update=function(e){if(this.isPlaying){var t,n,r,i,s=this.data.JIT.hierarchy,o,u,a;u=this.currentTime+=e*this.timeScale,o=this.currentTime%=this.data.length,o<this.startTimeMs&&(o=this.currentTime=this.startTimeMs+o),i=parseInt(Math.min(o*this.data.fps,this.data.length*this.data.fps),10);if((a=o<u)&&!this.loop){for(var e=0,f=this.hierarchy.length;e<f;e++){var l=this.data.hierarchy[e].keys,s=this.data.hierarchy[e].sids;r=l.length-1,i=this.hierarchy[e];if(l.length){for(l=0;l<s.length;l++)o=s[l],(u=this.getPrevKeyWith(o,e,r))&&u.apply(o);this.data.hierarchy[e].node.updateMatrix(),i.matrixWorldNeedsUpdate=!0}}this.stop()}else if(!(o<this.startTime)){e=0;for(f=this.hierarchy.length;e<f;e++){r=this.hierarchy[e],t=this.data.hierarchy[e];var l=t.keys,c=t.animationCache;if(this.JITCompile&&void 0!==s[e][i])r instanceof THREE.Bone?(r.skinMatrix=s[e][i],r.matrixWorldNeedsUpdate=!1):(r.matrix=s[e][i],r.matrixWorldNeedsUpdate=!0);else if(l.length){this.JITCompile&&c&&(r instanceof THREE.Bone?r.skinMatrix=c.originalMatrix:r.matrix=c.originalMatrix),t=c.prevKey,n=c.nextKey;if(t&&n){if(n.time<=u){if(a&&this.loop){t=l[0];for(n=l[1];n.time<o;)t=n,n=l[t.index+1]}else if(!a)for(var h=l.length-1;n.time<o&&n.index!==h;)t=n,n=l[t.index+1];c.prevKey=t,c.nextKey=n}n.time>=o?t.interpolate(n,o):t.interpolate(n,n.time)}this.data.hierarchy[e].node.updateMatrix(),r.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===s[0][i]){this.hierarchy[0].updateMatrixWorld(!0);for(e=0;e<this.hierarchy.length;e++)s[e][i]=this.hierarchy[e]instanceof THREE.Bone?this.hierarchy[e].skinMatrix.clone():this.hierarchy[e].matrix.clone()}}}},THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(e,t,n){t=this.data.hierarchy[t].keys;for(n%=t.length;n<t.length;n++)if(t[n].hasTarget(e))return t[n];return t[0]},THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(e,t,n){t=this.data.hierarchy[t].keys;for(n=0<=n?n:n+t.length;0<=n;n--)if(t[n].hasTarget(e))return t[n];return t[t.length-1]},THREE.CubeCamera=function(e,t,n){THREE.Object3D.call(this);var r=new THREE.PerspectiveCamera(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new THREE.Vector3(1,0,0)),this.add(r);var i=new THREE.PerspectiveCamera(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new THREE.Vector3(-1,0,0)),this.add(i);var s=new THREE.PerspectiveCamera(90,1,e,t);s.up.set(0,0,1),s.lookAt(new THREE.Vector3(0,1,0)),this.add(s);var o=new THREE.PerspectiveCamera(90,1,e,t);o.up.set(0,0,-1),o.lookAt(new THREE.Vector3(0,-1,0)),this.add(o);var u=new THREE.PerspectiveCamera(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new THREE.Vector3(0,0,1)),this.add(u);var a=new THREE.PerspectiveCamera(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new THREE.Vector3(0,0,-1)),this.add(a),this.renderTarget=new THREE.WebGLRenderTargetCube(n,n,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter}),this.updateCubeMap=function(e,t){var n=this.renderTarget,l=n.generateMipmaps;n.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,r,n),n.activeCubeFace=1,e.render(t,i,n),n.activeCubeFace=2,e.render(t,s,n),n.activeCubeFace=3,e.render(t,o,n),n.activeCubeFace=4,e.render(t,u,n),n.generateMipmaps=l,n.activeCubeFace=5,e.render(t,a,n)}},THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype),THREE.CombinedCamera=function(e,t,n,r,i,s,o){THREE.Camera.call(this),this.fov=n,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2,this.cameraO=new THREE.OrthographicCamera(e/-2,e/2,t/2,t/-2,s,o),this.cameraP=new THREE.PerspectiveCamera(n,e/t,r,i),this.zoom=1,this.toPerspective()},THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype),THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near,this.far=this.cameraP.far,this.cameraP.fov=this.fov/this.zoom,this.cameraP.updateProjectionMatrix(),this.projectionMatrix=this.cameraP.projectionMatrix,this.inPerspectiveMode=!0,this.inOrthographicMode=!1},THREE.CombinedCamera.prototype.toOrthographic=function(){var e=this.cameraP.aspect,t=(this.cameraP.near+this.cameraP.far)/2,t=Math.tan(this.fov/2)*t,e=2*t*e/2,t=t/this.zoom,e=e/this.zoom;this.cameraO.left=-e,this.cameraO.right=e,this.cameraO.top=t,this.cameraO.bottom=-t,this.cameraO.updateProjectionMatrix(),this.near=this.cameraO.near,this.far=this.cameraO.far,this.projectionMatrix=this.cameraO.projectionMatrix,this.inPerspectiveMode=!1,this.inOrthographicMode=!0},THREE.CombinedCamera.prototype.setSize=function(e,t){this.cameraP.aspect=e/t,this.left=-e/2,this.right=e/2,this.top=t/2,this.bottom=-t/2},THREE.CombinedCamera.prototype.setFov=function(e){this.fov=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())},THREE.CombinedCamera.prototype.setLens=function(e,t){void 0===t&&(t=24);var n=2*THREE.Math.radToDeg(Math.atan(t/(2*e)));return this.setFov(n),n},THREE.CombinedCamera.prototype.setZoom=function(e){this.zoom=e,this.inPerspectiveMode?this.toPerspective():this.toOrthographic()},THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0,this.rotation.y=Math.PI,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0,this.rotation.y=-Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0,this.rotation.y=Math.PI/2,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2,this.rotation.y=0,this.rotation.z=0,this.rotationAutoUpdate=!1},THREE.CircleGeometry=function(e,t,n,r){THREE.Geometry.call(this);var e=e||50,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,t=void 0!==t?Math.max(3,t):8,i,s=[];i=new THREE.Vector3;var o=new THREE.Vector2(.5,.5);this.vertices.push(i),s.push(o);for(i=0;i<=t;i++){var u=new THREE.Vector3,a=n+i/t*r;u.x=e*Math.cos(a),u.y=e*Math.sin(a),this.vertices.push(u),s.push(new THREE.Vector2((u.x/e+1)/2,(u.y/e+1)/2))}n=new THREE.Vector3(0,0,1);for(i=1;i<=t;i++)this.faces.push(new THREE.Face3(i,i+1,0,[n,n,n])),this.faceVertexUvs[0].push([s[i],s[i+1],o]);this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CubeGeometry=function(e,t,n,r,i,s){function o(e,t,n,r,i,s,o,a){var f,l=u.widthSegments,c=u.heightSegments,p=i/2,d=s/2,v=u.vertices.length;if("x"===e&&"y"===t||"y"===e&&"x"===t)f="z";else if("x"===e&&"z"===t||"z"===e&&"x"===t)f="y",c=u.depthSegments;else if("z"===e&&"y"===t||"y"===e&&"z"===t)f="x",l=u.depthSegments;var m=l+1,g=c+1,y=i/l,b=s/c,w=new THREE.Vector3;w[f]=0<o?1:-1;for(i=0;i<g;i++)for(s=0;s<m;s++){var E=new THREE.Vector3;E[e]=(s*y-p)*n,E[t]=(i*b-d)*r,E[f]=o,u.vertices.push(E)}for(i=0;i<c;i++)for(s=0;s<l;s++)e=new THREE.Face4(s+m*i+v,s+m*(i+1)+v,s+1+m*(i+1)+v,s+1+m*i+v),e.normal.copy(w),e.vertexNormals.push(w.clone(),w.clone(),w.clone(),w.clone()),e.materialIndex=a,u.faces.push(e),u.faceVertexUvs[0].push([new THREE.Vector2(s/l,1-i/c),new THREE.Vector2(s/l,1-(i+1)/c),new THREE.Vector2((s+1)/l,1-(i+1)/c),new THREE.Vector2((s+1)/l,1-i/c)])}THREE.Geometry.call(this);var u=this;this.width=e,this.height=t,this.depth=n,this.widthSegments=r||1,this.heightSegments=i||1,this.depthSegments=s||1,e=this.width/2,t=this.height/2,n=this.depth/2,o("z","y",-1,-1,this.depth,this.height,e,0),o("z","y",1,-1,this.depth,this.height,-e,1),o("x","z",1,1,this.width,this.depth,t,2),o("x","z",1,-1,this.width,this.depth,-t,3),o("x","y",1,-1,this.width,this.height,n,4),o("x","y",-1,-1,this.width,this.height,-n,5),this.computeCentroids(),this.mergeVertices()},THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.CylinderGeometry=function(e,t,n,r,i,s){THREE.Geometry.call(this),this.radiusTop=e=void 0!==e?e:20,this.radiusBottom=t=void 0!==t?t:20,this.height=n=void 0!==n?n:100,this.radiusSegments=r=r||8,this.heightSegments=i=i||1,this.openEnded=s=void 0!==s?s:!1;var o=n/2,u,a,f=[],l=[];for(a=0;a<=i;a++){var c=[],h=[],p=a/i,d=p*(t-e)+e;for(u=0;u<=r;u++){var v=u/r,m=new THREE.Vector3;m.x=d*Math.sin(2*v*Math.PI),m.y=-p*n+o,m.z=d*Math.cos(2*v*Math.PI),this.vertices.push(m),c.push(this.vertices.length-1),h.push(new THREE.Vector2(v,1-p))}f.push(c),l.push(h)}n=(t-e)/n;for(u=0;u<r;u++){0!==e?(c=this.vertices[f[0][u]].clone(),h=this.vertices[f[0][u+1]].clone()):(c=this.vertices[f[1][u]].clone(),h=this.vertices[f[1][u+1]].clone()),c.setY(Math.sqrt(c.x*c.x+c.z*c.z)*n).normalize(),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*n).normalize();for(a=0;a<i;a++){var p=f[a][u],d=f[a+1][u],v=f[a+1][u+1],m=f[a][u+1],g=c.clone(),y=c.clone(),b=h.clone(),w=h.clone(),E=l[a][u].clone(),S=l[a+1][u].clone(),x=l[a+1][u+1].clone(),T=l[a][u+1].clone();this.faces.push(new THREE.Face4(p,d,v,m,[g,y,b,w])),this.faceVertexUvs[0].push([E,S,x,T])}}if(!1===s&&0<e){this.vertices.push(new THREE.Vector3(0,o,0));for(u=0;u<r;u++)p=f[0][u],d=f[0][u+1],v=this.vertices.length-1,g=new THREE.Vector3(0,1,0),y=new THREE.Vector3(0,1,0),b=new THREE.Vector3(0,1,0),E=l[0][u].clone(),S=l[0][u+1].clone(),x=new THREE.Vector2(S.u,0),this.faces.push(new THREE.Face3(p,d,v,[g,y,b])),this.faceVertexUvs[0].push([E,S,x])}if(!1===s&&0<t){this.vertices.push(new THREE.Vector3(0,-o,0));for(u=0;u<r;u++)p=f[a][u+1],d=f[a][u],v=this.vertices.length-1,g=new THREE.Vector3(0,-1,0),y=new THREE.Vector3(0,-1,0),b=new THREE.Vector3(0,-1,0),E=l[a][u+1].clone(),S=l[a][u].clone(),x=new THREE.Vector2(S.u,1),this.faces.push(new THREE.Face3(p,d,v,[g,y,b])),this.faceVertexUvs[0].push([E,S,x])}this.computeCentroids(),this.computeFaceNormals()},THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry=function(e,t){"undefined"!=typeof e&&(THREE.Geometry.call(this),e=e instanceof Array?e:[e],this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals())},THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ExtrudeGeometry.prototype.addShapeList=function(e,t){for(var n=e.length,r=0;r<n;r++)this.addShape(e[r],t)},THREE.ExtrudeGeometry.prototype.addShape=function(e,t){function n(e,t,n){return t||console.log("die"),t.clone().multiplyScalar(n).add(e)}function r(e,t,n){var r=THREE.ExtrudeGeometry.__v1,i=THREE.ExtrudeGeometry.__v2,s=THREE.ExtrudeGeometry.__v3,o=THREE.ExtrudeGeometry.__v4,u=THREE.ExtrudeGeometry.__v5,a=THREE.ExtrudeGeometry.__v6;return r.set(e.x-t.x,e.y-t.y),i.set(e.x-n.x,e.y-n.y),r=r.normalize(),i=i.normalize(),s.set(-r.y,r.x),o.set(i.y,-i.x),u.copy(e).add(s),a.copy(e).add(o),u.equals(a)?o.clone():(u.copy(t).add(s),a.copy(n).add(o),s=r.dot(o),o=a.sub(u).dot(o),0===s&&(console.log("Either infinite or no solutions!"),0===o?console.log("Its finite solutions."):console.log("Too bad, no solutions.")),o/=s,0>o?(t=Math.atan2(t.y-e.y,t.x-e.x),e=Math.atan2(n.y-e.y,n.x-e.x),t>e&&(e+=2*Math.PI),n=(t+e)/2,e=-Math.cos(n),n=-Math.sin(n),new THREE.Vector2(e,n)):r.multiplyScalar(o).add(u).sub(e).clone())}function i(n,r){var i,s;for(F=n.length;0<=--F;){i=F,s=F-1,0>s&&(s=n.length-1);for(var o=0,u=p+2*l,o=0;o<u;o++){var a=H*o,f=H*(o+1),c=r+i+a,a=r+s+a,h=r+s+f,f=r+i+f,d=n,v=o,m=u,g=i,w=s,c=c+L,a=a+L,h=h+L,f=f+L;k.faces.push(new THREE.Face4(c,a,h,f,null,null,y)),c=b.generateSideWallUV(k,e,d,t,c,a,h,f,v,m,g,w),k.faceVertexUvs[0].push(c)}}}function s(e,t,n){k.vertices.push(new THREE.Vector3(e,t,n))}function o(n,r,i,s){n+=L,r+=L,i+=L,k.faces.push(new THREE.Face3(n,r,i,null,null,g)),n=s?b.generateBottomUV(k,e,t,n,r,i):b.generateTopUV(k,e,t,n,r,i),k.faceVertexUvs[0].push(n)}var u=void 0!==t.amount?t.amount:100,a=void 0!==t.bevelThickness?t.bevelThickness:6,f=void 0!==t.bevelSize?t.bevelSize:a-2,l=void 0!==t.bevelSegments?t.bevelSegments:3,c=void 0!==t.bevelEnabled?t.bevelEnabled:!0,h=void 0!==t.curveSegments?t.curveSegments:12,p=void 0!==t.steps?t.steps:1,d=t.extrudePath,v,m=!1,g=t.material,y=t.extrudeMaterial,b=void 0!==t.UVGenerator?t.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,w,E,S,x;d&&(v=d.getSpacedPoints(p),m=!0,c=!1,w=void 0!==t.frames?t.frames:new THREE.TubeGeometry.FrenetFrames(d,p,!1),E=new THREE.Vector3,S=new THREE.Vector3,x=new THREE.Vector3),c||(f=a=l=0);var T,N,C,k=this,L=this.vertices.length,h=e.extractPoints(h),A=h.shape,h=h.holes;if(d=!THREE.Shape.Utils.isClockWise(A)){A=A.reverse(),N=0;for(C=h.length;N<C;N++)T=h[N],THREE.Shape.Utils.isClockWise(T)&&(h[N]=T.reverse());d=!1}var O=THREE.Shape.Utils.triangulateShape(A,h),d=A;N=0;for(C=h.length;N<C;N++)T=h[N],A=A.concat(T);var M,_,D,P,H=A.length,B=O.length,j=[],F=0,I=d.length;M=I-1;for(_=F+1;F<I;F++,M++,_++)M===I&&(M=0),_===I&&(_=0),j[F]=r(d[F],d[M],d[_]);var q=[],R,U=j.concat();N=0;for(C=h.length;N<C;N++){T=h[N],R=[],F=0,I=T.length,M=I-1;for(_=F+1;F<I;F++,M++,_++)M===I&&(M=0),_===I&&(_=0),R[F]=r(T[F],T[M],T[_]);q.push(R),U=U.concat(R)}for(M=0;M<l;M++){T=M/l,D=a*(1-T),_=f*Math.sin(T*Math.PI/2),F=0;for(I=d.length;F<I;F++)P=n(d[F],j[F],_),s(P.x,P.y,-D);N=0;for(C=h.length;N<C;N++){T=h[N],R=q[N],F=0;for(I=T.length;F<I;F++)P=n(T[F],R[F],_),s(P.x,P.y,-D)}}_=f;for(F=0;F<H;F++)P=c?n(A[F],U[F],_):A[F],m?(S.copy(w.normals[0]).multiplyScalar(P.x),E.copy(w.binormals[0]).multiplyScalar(P.y),x.copy(v[0]).add(S).add(E),s(x.x,x.y,x.z)):s(P.x,P.y,0);for(T=1;T<=p;T++)for(F=0;F<H;F++)P=c?n(A[F],U[F],_):A[F],m?(S.copy(w.normals[T]).multiplyScalar(P.x),E.copy(w.binormals[T]).multiplyScalar(P.y),x.copy(v[T]).add(S).add(E),s(x.x,x.y,x.z)):s(P.x,P.y,u/p*T);for(M=l-1;0<=M;M--){T=M/l,D=a*(1-T),_=f*Math.sin(T*Math.PI/2),F=0;for(I=d.length;F<I;F++)P=n(d[F],j[F],_),s(P.x,P.y,u+D);N=0;for(C=h.length;N<C;N++){T=h[N],R=q[N],F=0;for(I=T.length;F<I;F++)P=n(T[F],R[F],_),m?s(P.x,P.y+v[p-1].y,v[p-1].x+D):s(P.x,P.y,u+D)}}if(c){a=0*H;for(F=0;F<B;F++)u=O[F],o(u[2]+a,u[1]+a,u[0]+a,!0);a=H*(p+2*l);for(F=0;F<B;F++)u=O[F],o(u[0]+a,u[1]+a,u[2]+a,!1)}else{for(F=0;F<B;F++)u=O[F],o(u[2],u[1],u[0],!0);for(F=0;F<B;F++)u=O[F],o(u[0]+H*p,u[1]+H*p,u[2]+H*p,!1)}u=0,i(d,u),u+=d.length,N=0;for(C=h.length;N<C;N++)T=h[N],i(T,u),u+=T.length},THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(e,t,n,r,i,s){return t=e.vertices[i].x,i=e.vertices[i].y,n=e.vertices[s].x,s=e.vertices[s].y,[new THREE.Vector2(e.vertices[r].x,e.vertices[r].y),new THREE.Vector2(t,i),new THREE.Vector2(n,s)]},generateBottomUV:function(e,t,n,r,i,s){return this.generateTopUV(e,t,n,r,i,s)},generateSideWallUV:function(e,t,n,r,i,s,o,u){var t=e.vertices[i].x,n=e.vertices[i].y,i=e.vertices[i].z,r=e.vertices[s].x,a=e.vertices[s].y,s=e.vertices[s].z,f=e.vertices[o].x,l=e.vertices[o].y,o=e.vertices[o].z,c=e.vertices[u].x,h=e.vertices[u].y,e=e.vertices[u].z;return.01>Math.abs(n-a)?[new THREE.Vector2(t,1-i),new THREE.Vector2(r,1-s),new THREE.Vector2(f,1-o),new THREE.Vector2(c,1-e)]:[new THREE.Vector2(n,1-i),new THREE.Vector2(a,1-s),new THREE.Vector2(l,1-o),new THREE.Vector2(h,1-e)]}},THREE.ExtrudeGeometry.__v1=new THREE.Vector2,THREE.ExtrudeGeometry.__v2=new THREE.Vector2,THREE.ExtrudeGeometry.__v3=new THREE.Vector2,THREE.ExtrudeGeometry.__v4=new THREE.Vector2,THREE.ExtrudeGeometry.__v5=new THREE.Vector2,THREE.ExtrudeGeometry.__v6=new THREE.Vector2,THREE.ShapeGeometry=function(e,t){THREE.Geometry.call(this),0==e instanceof Array&&(e=[e]),this.shapebb=e[e.length-1].getBoundingBox(),this.addShapeList(e,t),this.computeCentroids(),this.computeFaceNormals()},THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ShapeGeometry.prototype.addShapeList=function(e,t){for(var n=0,r=e.length;n<r;n++)this.addShape(e[n],t);return this},THREE.ShapeGeometry.prototype.addShape=function(e,t){void 0===t&&(t={});var n=t.material,r=void 0===t.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:t.UVGenerator,i,s,o,u=this.vertices.length;i=e.extractPoints(void 0!==t.curveSegments?t.curveSegments:12);var a=i.shape,f=i.holes;if(!THREE.Shape.Utils.isClockWise(a)){a=a.reverse(),i=0;for(s=f.length;i<s;i++)o=f[i],THREE.Shape.Utils.isClockWise(o)&&(f[i]=o.reverse())}var l=THREE.Shape.Utils.triangulateShape(a,f);i=0;for(s=f.length;i<s;i++)o=f[i],a=a.concat(o);f=a.length,s=l.length;for(i=0;i<f;i++)o=a[i],this.vertices.push(new THREE.Vector3(o.x,o.y,0));for(i=0;i<s;i++)f=l[i],a=f[0]+u,o=f[1]+u,f=f[2]+u,this.faces.push(new THREE.Face3(a,o,f,null,null,n)),this.faceVertexUvs[0].push(r.generateBottomUV(this,e,t,a,o,f))},THREE.LatheGeometry=function(e,t,n,r){THREE.Geometry.call(this);for(var t=t||12,n=n||0,r=r||2*Math.PI,i=1/(e.length-1),s=1/t,o=0,u=t;o<=u;o++)for(var a=n+o*s*r,f=Math.cos(a),l=Math.sin(a),a=0,c=e.length;a<c;a++){var h=e[a],p=new THREE.Vector3;p.x=f*h.x-l*h.y,p.y=l*h.x+f*h.y,p.z=h.z,this.vertices.push(p)}n=e.length,o=0;for(u=t;o<u;o++){a=0;for(c=e.length-1;a<c;a++)r=t=a+n*o,l=t+n,f=t+1+n,this.faces.push(new THREE.Face4(r,l,f,t+1)),f=o*s,t=a*i,r=f+s,l=t+i,this.faceVertexUvs[0].push([new THREE.Vector2(f,t),new THREE.Vector2(r,t),new THREE.Vector2(r,l),new THREE.Vector2(f,l)])}this.mergeVertices(),this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.PlaneGeometry=function(e,t,n,r){THREE.Geometry.call(this),this.width=e,this.height=t,this.widthSegments=n||1,this.heightSegments=r||1;for(var n=e/2,i=t/2,r=this.widthSegments,s=this.heightSegments,o=r+1,u=s+1,a=this.width/r,f=this.height/s,l=new THREE.Vector3(0,0,1),e=0;e<u;e++)for(t=0;t<o;t++)this.vertices.push(new THREE.Vector3(t*a-n,-(e*f-i),0));for(e=0;e<s;e++)for(t=0;t<r;t++)n=new THREE.Face4(t+o*e,t+o*(e+1),t+1+o*(e+1),t+1+o*e),n.normal.copy(l),n.vertexNormals.push(l.clone(),l.clone(),l.clone(),l.clone()),this.faces.push(n),this.faceVertexUvs[0].push([new THREE.Vector2(t/r,1-e/s),new THREE.Vector2(t/r,1-(e+1)/s),new THREE.Vector2((t+1)/r,1-(e+1)/s),new THREE.Vector2((t+1)/r,1-e/s)]);this.computeCentroids()},THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.RingGeometry=function(e,t,n,r,i,s){THREE.Geometry.call(this);for(var e=e||0,t=t||50,i=void 0!==i?i:0,s=void 0!==s?s:2*Math.PI,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?Math.max(3,r):8,o=[],u=e,a=(t-e)/r,e=0;e<=r;e++){for(t=0;t<=n;t++){var f=new THREE.Vector3,l=i+t/n*s;f.x=u*Math.cos(l),f.y=u*Math.sin(l),this.vertices.push(f),o.push(new THREE.Vector2((f.x/u+1)/2,-(f.y/u+1)/2+1))}u+=a}i=new THREE.Vector3(0,0,1);for(e=0;e<r;e++){s=e*n;for(t=0;t<=n;t++){var l=t+s,a=l+e,f=l+n+e,c=l+n+1+e;this.faces.push(new THREE.Face3(a,f,c,[i,i,i])),this.faceVertexUvs[0].push([o[a],o[f],o[c]]),a=l+e,f=l+n+1+e,c=l+1+e,this.faces.push(new THREE.Face3(a,f,c,[i,i,i])),this.faceVertexUvs[0].push([o[a],o[f],o[c]])}}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,u)},THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.SphereGeometry=function(e,t,n,r,i,s,o){THREE.Geometry.call(this),this.radius=e=e||50,this.widthSegments=t=Math.max(3,Math.floor(t)||8),this.heightSegments=n=Math.max(2,Math.floor(n)||6),this.phiStart=r=void 0!==r?r:0,this.phiLength=i=void 0!==i?i:2*Math.PI,this.thetaStart=s=void 0!==s?s:0,this.thetaLength=o=void 0!==o?o:Math.PI;var u,a,f=[],l=[];for(a=0;a<=n;a++){var c=[],h=[];for(u=0;u<=t;u++){var p=u/t,d=a/n,v=new THREE.Vector3;v.x=-e*Math.cos(r+p*i)*Math.sin(s+d*o),v.y=e*Math.cos(s+d*o),v.z=e*Math.sin(r+p*i)*Math.sin(s+d*o),this.vertices.push(v),c.push(this.vertices.length-1),h.push(new THREE.Vector2(p,1-d))}f.push(c),l.push(h)}for(a=0;a<this.heightSegments;a++)for(u=0;u<this.widthSegments;u++){var t=f[a][u+1],n=f[a][u],r=f[a+1][u],i=f[a+1][u+1],s=this.vertices[t].clone().normalize(),o=this.vertices[n].clone().normalize(),c=this.vertices[r].clone().normalize(),h=this.vertices[i].clone().normalize(),p=l[a][u+1].clone(),d=l[a][u].clone(),v=l[a+1][u].clone(),m=l[a+1][u+1].clone();Math.abs(this.vertices[t].y)===this.radius?(this.faces.push(new THREE.Face3(t,r,i,[s,c,h])),this.faceVertexUvs[0].push([p,v,m])):Math.abs(this.vertices[r].y)===this.radius?(this.faces.push(new THREE.Face3(t,n,r,[s,o,c])),this.faceVertexUvs[0].push([p,d,v])):(this.faces.push(new THREE.Face4(t,n,r,i,[s,o,c,h])),this.faceVertexUvs[0].push([p,d,v,m]))}this.computeCentroids(),this.computeFaceNormals(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,e)},THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TextGeometry=function(e,t){var t=t||{},n=THREE.FontUtils.generateShapes(e,t);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),THREE.ExtrudeGeometry.call(this,n,t)},THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype),THREE.TorusGeometry=function(e,t,n,r,i){THREE.Geometry.call(this),this.radius=e||100,this.tube=t||40,this.radialSegments=n||8,this.tubularSegments=r||6,this.arc=i||2*Math.PI,i=new THREE.Vector3,e=[],t=[];for(n=0;n<=this.radialSegments;n++)for(r=0;r<=this.tubularSegments;r++){var s=r/this.tubularSegments*this.arc,o=2*n/this.radialSegments*Math.PI;i.x=this.radius*Math.cos(s),i.y=this.radius*Math.sin(s);var u=new THREE.Vector3;u.x=(this.radius+this.tube*Math.cos(o))*Math.cos(s),u.y=(this.radius+this.tube*Math.cos(o))*Math.sin(s),u.z=this.tube*Math.sin(o),this.vertices.push(u),e.push(new THREE.Vector2(r/this.tubularSegments,n/this.radialSegments)),t.push(u.clone().sub(i).normalize())}for(n=1;n<=this.radialSegments;n++)for(r=1;r<=this.tubularSegments;r++){var i=(this.tubularSegments+1)*n+r-1,s=(this.tubularSegments+1)*(n-1)+r-1,o=(this.tubularSegments+1)*(n-1)+r,u=(this.tubularSegments+1)*n+r,a=new THREE.Face4(i,s,o,u,[t[i],t[s],t[o],t[u]]);a.normal.add(t[i]),a.normal.add(t[s]),a.normal.add(t[o]),a.normal.add(t[u]),a.normal.normalize(),this.faces.push(a),this.faceVertexUvs[0].push([e[i].clone(),e[s].clone(),e[o].clone(),e[u].clone()])}this.computeCentroids()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TorusKnotGeometry=function(e,t,n,r,i,s,o){function u(e,t,n,r,i,s){var o=Math.cos(e);return Math.cos(t),t=Math.sin(e),e*=n/r,n=Math.cos(e),o*=.5*i*(2+n),t=.5*i*(2+n)*t,i=.5*s*i*Math.sin(e),new THREE.Vector3(o,t,i)}THREE.Geometry.call(this),this.radius=e||100,this.tube=t||40,this.radialSegments=n||64,this.tubularSegments=r||8,this.p=i||2,this.q=s||3,this.heightScale=o||1,this.grid=Array(this.radialSegments),n=new THREE.Vector3,r=new THREE.Vector3,i=new THREE.Vector3;for(e=0;e<this.radialSegments;++e){this.grid[e]=Array(this.tubularSegments);for(t=0;t<this.tubularSegments;++t){var a=2*(e/this.radialSegments)*this.p*Math.PI,o=2*(t/this.tubularSegments)*Math.PI,s=u(a,o,this.q,this.p,this.radius,this.heightScale),a=u(a+.01,o,this.q,this.p,this.radius,this.heightScale);n.subVectors(a,s),r.addVectors(a,s),i.crossVectors(n,r),r.crossVectors(i,n),i.normalize(),r.normalize(),a=-this.tube*Math.cos(o),o=this.tube*Math.sin(o),s.x+=a*r.x+o*i.x,s.y+=a*r.y+o*i.y,s.z+=a*r.z+o*i.z,this.grid[e][t]=this.vertices.push(new THREE.Vector3(s.x,s.y,s.z))-1}}for(e=0;e<this.radialSegments;++e)for(t=0;t<this.tubularSegments;++t){var i=(e+1)%this.radialSegments,s=(t+1)%this.tubularSegments,n=this.grid[e][t],r=this.grid[i][t],i=this.grid[i][s],s=this.grid[e][s],o=new THREE.Vector2(e/this.radialSegments,t/this.tubularSegments),a=new THREE.Vector2((e+1)/this.radialSegments,t/this.tubularSegments),f=new THREE.Vector2((e+1)/this.radialSegments,(t+1)/this.tubularSegments),l=new THREE.Vector2(e/this.radialSegments,(t+1)/this.tubularSegments);this.faces.push(new THREE.Face4(n,r,i,s)),this.faceVertexUvs[0].push([o,a,f,l])}this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry=function(e,t,n,r,i,s){THREE.Geometry.call(this),this.path=e,this.segments=t||64,this.radius=n||1,this.radiusSegments=r||8,this.closed=i||!1,s&&(this.debug=new THREE.Object3D),this.grid=[];var o,u,i=this.segments+1,a,f,l,s=new THREE.Vector3,c,h,p,t=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);c=t.tangents,h=t.normals,p=t.binormals,this.tangents=c,this.normals=h,this.binormals=p;for(t=0;t<i;t++){this.grid[t]=[],r=t/(i-1),l=e.getPointAt(r),r=c[t],o=h[t],u=p[t],this.debug&&(this.debug.add(new THREE.ArrowHelper(r,l,n,255)),this.debug.add(new THREE.ArrowHelper(o,l,n,16711680)),this.debug.add(new THREE.ArrowHelper(u,l,n,65280)));for(r=0;r<this.radiusSegments;r++)a=2*(r/this.radiusSegments)*Math.PI,f=-this.radius*Math.cos(a),a=this.radius*Math.sin(a),s.copy(l),s.x+=f*o.x+a*u.x,s.y+=f*o.y+a*u.y,s.z+=f*o.z+a*u.z,this.grid[t][r]=this.vertices.push(new THREE.Vector3(s.x,s.y,s.z))-1}for(t=0;t<this.segments;t++)for(r=0;r<this.radiusSegments;r++)i=this.closed?(t+1)%this.segments:t+1,s=(r+1)%this.radiusSegments,e=this.grid[t][r],n=this.grid[i][r],i=this.grid[i][s],s=this.grid[t][s],c=new THREE.Vector2(t/this.segments,r/this.radiusSegments),h=new THREE.Vector2((t+1)/this.segments,r/this.radiusSegments),p=new THREE.Vector2((t+1)/this.segments,(r+1)/this.radiusSegments),o=new THREE.Vector2(t/this.segments,(r+1)/this.radiusSegments),this.faces.push(new THREE.Face4(e,n,i,s)),this.faceVertexUvs[0].push([c,h,p,o]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TubeGeometry.FrenetFrames=function(e,t,n){new THREE.Vector3;var r=new THREE.Vector3;new THREE.Vector3;var i=[],s=[],o=[],u=new THREE.Vector3,a=new THREE.Matrix4,t=t+1,f,l,c;this.tangents=i,this.normals=s,this.binormals=o;for(f=0;f<t;f++)l=f/(t-1),i[f]=e.getTangentAt(l),i[f].normalize();s[0]=new THREE.Vector3,o[0]=new THREE.Vector3,e=Number.MAX_VALUE,f=Math.abs(i[0].x),l=Math.abs(i[0].y),c=Math.abs(i[0].z),f<=e&&(e=f,r.set(1,0,0)),l<=e&&(e=l,r.set(0,1,0)),c<=e&&r.set(0,0,1),u.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],u),o[0].crossVectors(i[0],s[0]);for(f=1;f<t;f++)s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),u.crossVectors(i[f-1],i[f]),1e-4<u.length()&&(u.normalize(),r=Math.acos(i[f-1].dot(i[f])),s[f].applyMatrix4(a.makeRotationAxis(u,r))),o[f].crossVectors(i[f],s[f]);if(n){r=Math.acos(s[0].dot(s[t-1])),r/=t-1,0<i[0].dot(u.crossVectors(s[0],s[t-1]))&&(r=-r);for(f=1;f<t;f++)s[f].applyMatrix4(a.makeRotationAxis(i[f],r*f)),o[f].crossVectors(i[f],s[f])}},THREE.PolyhedronGeometry=function(e,t,n,r){function i(e){var t=e.normalize().clone();t.index=u.vertices.push(t)-1;var n=Math.atan2(e.z,-e.x)/2/Math.PI+.5,e=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5;return t.uv=new THREE.Vector2(n,1-e),t}function s(e,t,n){var r=new THREE.Face3(e.index,t.index,n.index,[e.clone(),t.clone(),n.clone()]);r.centroid.add(e).add(t).add(n).divideScalar(3),r.normal.copy(r.centroid).normalize(),u.faces.push(r),r=Math.atan2(r.centroid.z,-r.centroid.x),u.faceVertexUvs[0].push([o(e.uv,e,r),o(t.uv,t,r),o(n.uv,n,r)])}function o(e,t,n){return 0>n&&1===e.x&&(e=new THREE.Vector2(e.x-1,e.y)),0===t.x&&0===t.z&&(e=new THREE.Vector2(n/2/Math.PI+.5,e.y)),e.clone()}THREE.Geometry.call(this);for(var n=n||1,r=r||0,u=this,a=0,f=e.length;a<f;a++)i(new THREE.Vector3(e[a][0],e[a][1],e[a][2]));for(var l=this.vertices,e=[],a=0,f=t.length;a<f;a++){var c=l[t[a][0]],h=l[t[a][1]],p=l[t[a][2]];e[a]=new THREE.Face3(c.index,h.index,p.index,[c.clone(),h.clone(),p.clone()])}a=0;for(f=e.length;a<f;a++){h=e[a],l=r,t=Math.pow(2,l),Math.pow(4,l);for(var l=i(u.vertices[h.a]),c=i(u.vertices[h.b]),d=i(u.vertices[h.c]),h=[],p=0;p<=t;p++){h[p]=[];for(var v=i(l.clone().lerp(d,p/t)),m=i(c.clone().lerp(d,p/t)),g=t-p,y=0;y<=g;y++)h[p][y]=0==y&&p==t?v:i(v.clone().lerp(m,y/g))}for(p=0;p<t;p++)for(y=0;y<2*(t-p)-1;y++)l=Math.floor(y/2),0==y%2?s(h[p][l+1],h[p+1][l],h[p][l]):s(h[p][l+1],h[p+1][l+1],h[p+1][l])}a=0;for(f=this.faceVertexUvs[0].length;a<f;a++)r=this.faceVertexUvs[0][a],e=r[0].x,t=r[1].x,l=r[2].x,c=Math.max(e,Math.max(t,l)),h=Math.min(e,Math.min(t,l)),.9<c&&.1>h&&(.2>e&&(r[0].x+=1),.2>t&&(r[1].x+=1),.2>l&&(r[2].x+=1));this.mergeVertices(),a=0;for(f=this.vertices.length;a<f;a++)this.vertices[a].multiplyScalar(n);this.computeCentroids(),this.boundingSphere=new THREE.Sphere(new THREE.Vector3,n)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.IcosahedronGeometry=function(e,t){this.radius=e,this.detail=t;var n=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,n,0],[1,n,0],[-1,-n,0],[1,-n,0],[0,-1,n],[0,1,n],[0,-1,-n],[0,1,-n],[n,0,-1],[n,0,1],[-n,0,-1],[-n,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],e,t)},THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.OctahedronGeometry=function(e,t){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],e,t)},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.TetrahedronGeometry=function(e,t){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],e,t)},THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ParametricGeometry=function(e,t,n,r){THREE.Geometry.call(this);var i=this.vertices,s=this.faces,o=this.faceVertexUvs[0],r=void 0===r?!1:r,u,a,f,l,c=t+1;for(u=0;u<=n;u++){l=u/n;for(a=0;a<=t;a++)f=a/t,f=e(f,l),i.push(f)}var h,p,d,v;for(u=0;u<n;u++)for(a=0;a<t;a++)e=u*c+a,i=u*c+a+1,l=(u+1)*c+a,f=(u+1)*c+a+1,h=new THREE.Vector2(a/t,u/n),p=new THREE.Vector2((a+1)/t,u/n),d=new THREE.Vector2(a/t,(u+1)/n),v=new THREE.Vector2((a+1)/t,(u+1)/n),r?(s.push(new THREE.Face3(e,i,l)),s.push(new THREE.Face3(i,f,l)),o.push([h,p,d]),o.push([p,v,d])):(s.push(new THREE.Face4(e,i,f,l)),o.push([h,p,v,d]));this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.ConvexGeometry=function(e){function t(e){var t=e.length();return new THREE.Vector2(e.x/t,e.y/t)}THREE.Geometry.call(this);for(var n=[[0,1,2],[0,2,1]],r=3;r<e.length;r++){var i=r,s=e[i].clone(),o=s.length();s.x+=o*2e-6*(Math.random()-.5),s.y+=o*2e-6*(Math.random()-.5),s.z+=o*2e-6*(Math.random()-.5);for(var o=[],u=0;u<n.length;){var a=n[u],f=s,l=e[a[0]],c;c=l;var h=e[a[1]],p=e[a[2]],d=new THREE.Vector3,v=new THREE.Vector3;d.subVectors(p,h),v.subVectors(c,h),d.cross(v),d.normalize(),c=d,l=c.dot(l);if(c.dot(f)>=l){for(f=0;3>f;f++){l=[a[f],a[(f+1)%3]],c=!0;for(h=0;h<o.length;h++)if(o[h][0]===l[1]&&o[h][1]===l[0]){o[h]=o[o.length-1],o.pop(),c=!1;break}c&&o.push(l)}n[u]=n[n.length-1],n.pop()}else u++}for(h=0;h<o.length;h++)n.push([o[h][0],o[h][1],i])}i=0,s=Array(e.length);for(r=0;r<n.length;r++){o=n[r];for(u=0;3>u;u++)void 0===s[o[u]]&&(s[o[u]]=i++,this.vertices.push(e[o[u]])),o[u]=s[o[u]]}for(r=0;r<n.length;r++)this.faces.push(new THREE.Face3(n[r][0],n[r][1],n[r][2]));for(r=0;r<this.faces.length;r++)o=this.faces[r],this.faceVertexUvs[0].push([t(this.vertices[o.a]),t(this.vertices[o.b]),t(this.vertices[o.c])]);this.computeCentroids(),this.computeFaceNormals(),this.computeVertexNormals()},THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype),THREE.AxisHelper=function(e){var e=e||1,t=new THREE.Geometry;t.vertices.push(new THREE.Vector3,new THREE.Vector3(e,0,0),new THREE.Vector3,new THREE.Vector3(0,e,0),new THREE.Vector3,new THREE.Vector3(0,0,e)),t.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775)),e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),THREE.Line.call(this,t,e,THREE.LinePieces)},THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype),THREE.ArrowHelper=function(e,t,n,r){THREE.Object3D.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),this.position=t,this.useQuaternion=!0,t=new THREE.Geometry,t.vertices.push(new THREE.Vector3(0,0,0)),t.vertices.push(new THREE.Vector3(0,1,0)),this.line=new THREE.Line(t,new THREE.LineBasicMaterial({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),t=new THREE.CylinderGeometry(0,.05,.25,5,1),t.applyMatrix((new THREE.Matrix4).makeTranslation(0,.875,0)),this.cone=new THREE.Mesh(t,new THREE.MeshBasicMaterial({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n)},THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.ArrowHelper.prototype.setDirection=function(){var e=new THREE.Vector3,t;return function(n){.999<n.y?this.quaternion.set(0,0,0,1):-0.999>n.y?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),THREE.ArrowHelper.prototype.setLength=function(e){this.scale.set(e,e,e)},THREE.ArrowHelper.prototype.setColor=function(e){this.line.material.color.setHex(e),this.cone.material.color.setHex(e)},THREE.BoxHelper=function(e){var e=e||1,t=new THREE.Geometry,e=[new THREE.Vector3(e,e,e),new THREE.Vector3(-e,e,e),new THREE.Vector3(-e,-e,e),new THREE.Vector3(e,-e,e),new THREE.Vector3(e,e,-e),new THREE.Vector3(-e,e,-e),new THREE.Vector3(-e,-e,-e),new THREE.Vector3(e,-e,-e)];t.vertices.push(e[0],e[1],e[1],e[2],e[2],e[3],e[3],e[0],e[4],e[5],e[5],e[6],e[6],e[7],e[7],e[4],e[0],e[4],e[1],e[5],e[2],e[6],e[3],e[7]),this.vertices=e,THREE.Line.call(this,t,new THREE.LineBasicMaterial,THREE.LinePieces)},THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype),THREE.BoxHelper.prototype.update=function(e){var t=e.geometry;null===t.boundingBox&&t.computeBoundingBox();var n=t.boundingBox.min,t=t.boundingBox.max,r=this.vertices;r[0].set(t.x,t.y,t.z),r[1].set(n.x,t.y,t.z),r[2].set(n.x,n.y,t.z),r[3].set(t.x,n.y,t.z),r[4].set(t.x,t.y,n.z),r[5].set(n.x,t.y,n.z),r[6].set(n.x,n.y,n.z),r[7].set(t.x,n.y,n.z),this.geometry.computeBoundingSphere(),this.geometry.verticesNeedUpdate=!0,this.matrixAutoUpdate=!1,this.matrixWorld=e.matrixWorld},THREE.CameraHelper=function(e){function t(e,t,r){n(e,r),n(t,r)}function n(e,t){r.vertices.push(new THREE.Vector3),r.colors.push(new THREE.Color(t)),void 0===s[e]&&(s[e]=[]),s[e].push(r.vertices.length-1)}THREE.Line.call(this);var r=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),s={};t("n1","n2",16755200),t("n2","n4",16755200),t("n4","n3",16755200),t("n3","n1",16755200),t("f1","f2",16755200),t("f2","f4",16755200),t("f4","f3",16755200),t("f3","f1",16755200),t("n1","f1",16755200),t("n2","f2",16755200),t("n3","f3",16755200),t("n4","f4",16755200),t("p","n1",16711680),t("p","n2",16711680),t("p","n3",16711680),t("p","n4",16711680),t("u1","u2",43775),t("u2","u3",43775),t("u3","u1",43775),t("c","t",16777215),t("p","c",3355443),t("cn1","cn2",3355443),t("cn3","cn4",3355443),t("cf1","cf2",3355443),t("cf3","cf4",3355443),THREE.Line.call(this,r,i,THREE.LinePieces),this.camera=e,this.matrixWorld=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()},THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype),THREE.CameraHelper.prototype.update=function(){var e=new THREE.Vector3,t=new THREE.Camera,n=new THREE.Projector;return function(){function r(r,s,o,u){e.set(s,o,u),n.unprojectVector(e,t),r=i.pointMap[r];if(void 0!==r){s=0;for(o=r.length;s<o;s++)i.geometry.vertices[r[s]].copy(e)}}var i=this;t.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-0.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),this.geometry.verticesNeedUpdate=!0}}(),THREE.DirectionalLightHelper=function(e,t){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=e;var n=new THREE.SphereGeometry(t,4,2),r=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(n,r),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere),n=new THREE.Geometry,n.vertices.push(this.light.position),n.vertices.push(this.light.target.position),n.computeLineDistances(),r=new THREE.LineDashedMaterial({dashSize:4,gapSize:4,opacity:.75,transparent:!0,fog:!1}),r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new THREE.Line(n,r),this.add(this.targetLine)},THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.DirectionalLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.computeLineDistances(),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.GridHelper=function(e,t){for(var n=new THREE.Geometry,r=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),i=new THREE.Color(4473924),s=new THREE.Color(8947848),o=-e;o<=e;o+=t){n.vertices.push(new THREE.Vector3(-e,0,o)),n.vertices.push(new THREE.Vector3(e,0,o)),n.vertices.push(new THREE.Vector3(o,0,-e)),n.vertices.push(new THREE.Vector3(o,0,e));var u=0===o?i:s;n.colors.push(u,u,u,u)}THREE.Line.call(this,n,r,THREE.LinePieces)},THREE.GridHelper.prototype=Object.create(THREE.Line.prototype),THREE.HemisphereLightHelper=function(e,t){THREE.Object3D.call(this),this.light=e;var n=new THREE.SphereGeometry(t,4,2);n.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var r=0;8>r;r++)n.faces[r].materialIndex=4>r?0:1;r=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0}),r.color.copy(e.color).multiplyScalar(e.intensity);var i=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});i.color.copy(e.groundColor).multiplyScalar(e.intensity),this.lightSphere=new THREE.Mesh(n,new THREE.MeshFaceMaterial([r,i])),this.lightSphere.position=e.position,this.lightSphere.lookAt(new THREE.Vector3),this.add(this.lightSphere)},THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.HemisphereLightHelper.prototype.update=function(){this.lightSphere.lookAt(new THREE.Vector3),this.lightSphere.material.materials[0].color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere.material.materials[1].color.copy(this.light.groundColor).multiplyScalar(this.light.intensity)},THREE.PointLightHelper=function(e,t){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=e;var n=new THREE.SphereGeometry(t,4,2),r=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(n,r),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere)},THREE.PointLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.PointLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.SpotLightHelper=function(e,t){THREE.Object3D.call(this),this.matrixAutoUpdate=!1,this.light=e;var n=new THREE.SphereGeometry(t,4,2),r=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightSphere=new THREE.Mesh(n,r),this.lightSphere.matrixWorld=this.light.matrixWorld,this.lightSphere.matrixAutoUpdate=!1,this.add(this.lightSphere),n=new THREE.CylinderGeometry(1e-4,1,1,8,1,!0),n.applyMatrix((new THREE.Matrix4).makeTranslation(0,-0.5,0)),n.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),r=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0,opacity:.3,transparent:!0}),r.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightCone=new THREE.Mesh(n,r),this.lightCone.position=this.light.position,n=e.distance?e.distance:1e4,r=n*Math.tan(e.angle),this.lightCone.scale.set(r,r,n),this.lightCone.lookAt(this.light.target.position),this.add(this.lightCone)},THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype),THREE.SpotLightHelper.prototype.update=function(){var e=this.light.distance?this.light.distance:1e4,t=e*Math.tan(this.light.angle);this.lightCone.scale.set(t,t,e),this.lightCone.lookAt(this.light.target.position),this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightCone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this),this.render=function(){}},THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare=function(e,t,n,r,i){THREE.Object3D.call(this),this.lensFlares=[],this.positionScreen=new THREE.Vector3,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,n,r,i)},THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype),THREE.LensFlare.prototype.add=function(e,t,n,r,i,s){void 0===t&&(t=-1),void 0===n&&(n=0),void 0===s&&(s=1),void 0===i&&(i=new THREE.Color(16777215)),void 0===r&&(r=THREE.NormalBlending),n=Math.min(n,Math.max(0,n)),this.lensFlares.push({texture:e,size:t,distance:n,x:0,y:0,z:0,scale:1,rotation:1,opacity:s,color:i,blending:r})},THREE.LensFlare.prototype.updateLensFlares=function(){var e,t=this.lensFlares.length,n,r=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;e<t;e++)n=this.lensFlares[e],n.x=this.positionScreen.x+r*n.distance,n.y=this.positionScreen.y+i*n.distance,n.wantedRotation=.25*n.x*Math.PI,n.rotation+=.25*(n.wantedRotation-n.rotation)},THREE.MorphBlendMesh=function(e,t){THREE.Mesh.call(this,e,t),this.animationsMap={},this.animationsList=[];var n=this.geometry.morphTargets.length;this.createAnimation("__default",0,n-1,n/1),this.setAnimationWeight("__default",1)},THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype),THREE.MorphBlendMesh.prototype.createAnimation=function(e,t,n,r){t={startFrame:t,endFrame:n,length:n-t+1,fps:r,duration:(n-t)/r,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1},this.animationsMap[e]=t,this.animationsList.push(t)},THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(e){for(var t=/([a-z]+)(\d+)/,n,r={},i=this.geometry,s=0,o=i.morphTargets.length;s<o;s++){var u=i.morphTargets[s].name.match(t);if(u&&1<u.length){var a=u[1];r[a]||(r[a]={start:Infinity,end:-Infinity}),u=r[a],s<u.start&&(u.start=s),s>u.end&&(u.end=s),n||(n=a)}}for(a in r)u=r[a],this.createAnimation(a,u.start,u.end,e);this.firstAnimation=n},THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(e){if(e=this.animationsMap[e])e.direction=1,e.directionBackwards=!1},THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(e){if(e=this.animationsMap[e])e.direction=-1,e.directionBackwards=!0},THREE.MorphBlendMesh.prototype.setAnimationFPS=function(e,t){var n=this.animationsMap[e];n&&(n.fps=t,n.duration=(n.end-n.start)/n.fps)},THREE.MorphBlendMesh.prototype.setAnimationDuration=function(e,t){var n=this.animationsMap[e];n&&(n.duration=t,n.fps=(n.end-n.start)/n.duration)},THREE.MorphBlendMesh.prototype.setAnimationWeight=function(e,t){var n=this.animationsMap[e];n&&(n.weight=t)},THREE.MorphBlendMesh.prototype.setAnimationTime=function(e,t){var n=this.animationsMap[e];n&&(n.time=t)},THREE.MorphBlendMesh.prototype.getAnimationTime=function(e){var t=0;if(e=this.animationsMap[e])t=e.time;return t},THREE.MorphBlendMesh.prototype.getAnimationDuration=function(e){var t=-1;if(e=this.animationsMap[e])t=e.duration;return t},THREE.MorphBlendMesh.prototype.playAnimation=function(e){var t=this.animationsMap[e];t?(t.time=0,t.active=!0):console.warn("animation["+e+"] undefined")},THREE.MorphBlendMesh.prototype.stopAnimation=function(e){if(e=this.animationsMap[e])e.active=!1},THREE.MorphBlendMesh.prototype.update=function(e){for(var t=0,n=this.animationsList.length;t<n;t++){var r=this.animationsList[t];if(r.active){var i=r.duration/r.length;r.time+=r.direction*e;if(r.mirroredLoop){if(r.time>r.duration||0>r.time)r.direction*=-1,r.time>r.duration&&(r.time=r.duration,r.directionBackwards=!0),0>r.time&&(r.time=0,r.directionBackwards=!1)}else r.time%=r.duration,0>r.time&&(r.time+=r.duration);var s=r.startFrame+THREE.Math.clamp(Math.floor(r.time/i),0,r.length-1),o=r.weight;s!==r.currentFrame&&(this.morphTargetInfluences[r.lastFrame]=0,this.morphTargetInfluences[r.currentFrame]=1*o,this.morphTargetInfluences[s]=0,r.lastFrame=r.currentFrame,r.currentFrame=s),i=r.time%i/i,r.directionBackwards&&(i=1-i),this.morphTargetInfluences[r.currentFrame]=i*o,this.morphTargetInfluences[r.lastFrame]=(1-i)*o}}},THREE.LensFlarePlugin=function(){function e(e,n){var r=t.createProgram(),i=t.createShader(t.FRAGMENT_SHADER),s=t.createShader(t.VERTEX_SHADER),o="precision "+n+" float;\n";return t.shaderSource(i,o+e.fragmentShader),t.shaderSource(s,o+e.vertexShader),t.compileShader(i),t.compileShader(s),t.attachShader(r,i),t.attachShader(r,s),t.linkProgram(r),r}var t,n,r,i,s,o,u,a,f,l,c,h,p;this.init=function(v){t=v.context,n=v,r=v.getPrecision(),i=new Float32Array(16),s=new Uint16Array(6),v=0,i[v++]=-1,i[v++]=-1,i[v++]=0,i[v++]=0,i[v++]=1,i[v++]=-1,i[v++]=1,i[v++]=0,i[v++]=1,i[v++]=1,i[v++]=1,i[v++]=1,i[v++]=-1,i[v++]=1,i[v++]=0,i[v++]=1,v=0,s[v++]=0,s[v++]=1,s[v++]=2,s[v++]=0,s[v++]=2,s[v++]=3,o=t.createBuffer(),u=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW),a=t.createTexture(),f=t.createTexture(),t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,f),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),0>=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(l=!1,c=e(THREE.ShaderFlares.lensFlare,r)):(l=!0,c=e(THREE.ShaderFlares.lensFlareVertexTexture,r)),h={},p={},h.vertex=t.getAttribLocation(c,"position"),h.uv=t.getAttribLocation(c,"uv"),p.renderType=t.getUniformLocation(c,"renderType"),p.map=t.getUniformLocation(c,"map"),p.occlusionMap=t.getUniformLocation(c,"occlusionMap"),p.opacity=t.getUniformLocation(c,"opacity"),p.color=t.getUniformLocation(c,"color"),p.scale=t.getUniformLocation(c,"scale"),p.rotation=t.getUniformLocation(c,"rotation"),p.screenPosition=t.getUniformLocation(c,"screenPosition")},this.render=function(e,r,i,s){var e=e.__webglFlares,d=e.length;if(d){var v=new THREE.Vector3,y=s/i,w=.5*i,E=.5*s,S=16/s,x=new THREE.Vector2(S*y,S),T=new THREE.Vector3(1,1,0),N=new THREE.Vector2(1,1),C=p,S=h;t.useProgram(c),t.enableVertexAttribArray(h.vertex),t.enableVertexAttribArray(h.uv),t.uniform1i(C.occlusionMap,0),t.uniform1i(C.map,1),t.bindBuffer(t.ARRAY_BUFFER,o),t.vertexAttribPointer(S.vertex,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(S.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.disable(t.CULL_FACE),t.depthMask(!1);var k,L,A,O,M;for(k=0;k<d;k++)if(S=16/s,x.set(S*y,S),O=e[k],v.set(O.matrixWorld.elements[12],O.matrixWorld.elements[13],O.matrixWorld.elements[14]),v.applyMatrix4(r.matrixWorldInverse),v.applyProjection(r.projectionMatrix),T.copy(v),N.x=T.x*w+w,N.y=T.y*E+E,l||0<N.x&&N.x<i&&0<N.y&&N.y<s){t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,a),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,N.x-8,N.y-8,16,16,0),t.uniform1i(C.renderType,0),t.uniform2f(C.scale,x.x,x.y),t.uniform3f(C.screenPosition,T.x,T.y,T.z),t.disable(t.BLEND),t.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,f),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,N.x-8,N.y-8,16,16,0),t.uniform1i(C.renderType,1),t.disable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,a),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),O.positionScreen.copy(T),O.customUpdateCallback?O.customUpdateCallback(O):O.updateLensFlares(),t.uniform1i(C.renderType,2),t.enable(t.BLEND),L=0;for(A=O.lensFlares.length;L<A;L++)M=O.lensFlares[L],.001<M.opacity&&.001<M.scale&&(T.x=M.x,T.y=M.y,T.z=M.z,S=M.size*M.scale/s,x.x=S*y,x.y=S,t.uniform3f(C.screenPosition,T.x,T.y,T.z),t.uniform2f(C.scale,x.x,x.y),t.uniform1f(C.rotation,M.rotation),t.uniform1f(C.opacity,M.opacity),t.uniform3f(C.color,M.color.r,M.color.g,M.color.b),n.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst),n.setTexture(M.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),t.depthMask(!0)}}},THREE.ShadowMapPlugin=function(){var e,t,n,r,i,s,o=new THREE.Frustum,u=new THREE.Matrix4,a=new THREE.Vector3,f=new THREE.Vector3,l=new THREE.Vector3;this.init=function(o){e=o.context,t=o;var o=THREE.ShaderLib.depthRGBA,u=THREE.UniformsUtils.clone(o.uniforms);n=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u}),r=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0}),i=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,skinning:!0}),s=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,i._shadowPass=!0,s._shadowPass=!0},this.render=function(e,n){t.shadowMapEnabled&&t.shadowMapAutoUpdate&&this.update(e,n)},this.update=function(p,v){var y,w,E,S,x,T,N,C,k,L=[];S=0,e.clearColor(1,1,1,1),e.disable(e.BLEND),e.enable(e.CULL_FACE),e.frontFace(e.CCW),t.shadowMapCullFace===THREE.CullFaceFront?e.cullFace(e.FRONT):e.cullFace(e.BACK),t.setDepthTest(!0),y=0;for(w=p.__lights.length;y<w;y++)if(E=p.__lights[y],E.castShadow)if(E instanceof THREE.DirectionalLight&&E.shadowCascade)for(x=0;x<E.shadowCascadeCount;x++){var A;if(E.shadowCascadeArray[x])A=E.shadowCascadeArray[x];else{k=E,N=x,A=new THREE.DirectionalLight,A.isVirtual=!0,A.onlyShadow=!0,A.castShadow=!0,A.shadowCameraNear=k.shadowCameraNear,A.shadowCameraFar=k.shadowCameraFar,A.shadowCameraLeft=k.shadowCameraLeft,A.shadowCameraRight=k.shadowCameraRight,A.shadowCameraBottom=k.shadowCameraBottom,A.shadowCameraTop=k.shadowCameraTop,A.shadowCameraVisible=k.shadowCameraVisible,A.shadowDarkness=k.shadowDarkness,A.shadowBias=k.shadowCascadeBias[N],A.shadowMapWidth=k.shadowCascadeWidth[N],A.shadowMapHeight=k.shadowCascadeHeight[N],A.pointsWorld=[],A.pointsFrustum=[],C=A.pointsWorld,T=A.pointsFrustum;for(var O=0;8>O;O++)C[O]=new THREE.Vector3,T[O]=new THREE.Vector3;C=k.shadowCascadeNearZ[N],k=k.shadowCascadeFarZ[N],T[0].set(-1,-1,C),T[1].set(1,-1,C),T[2].set(-1,1,C),T[3].set(1,1,C),T[4].set(-1,-1,k),T[5].set(1,-1,k),T[6].set(-1,1,k),T[7].set(1,1,k),A.originalCamera=v,T=new THREE.Gyroscope,T.position=E.shadowCascadeOffset,T.add(A),T.add(A.target),v.add(T),E.shadowCascadeArray[x]=A,console.log("Created virtualLight",A)}N=E,C=x,k=N.shadowCascadeArray[C],k.position.copy(N.position),k.target.position.copy(N.target.position),k.lookAt(k.target),k.shadowCameraVisible=N.shadowCameraVisible,k.shadowDarkness=N.shadowDarkness,k.shadowBias=N.shadowCascadeBias[C],T=N.shadowCascadeNearZ[C],N=N.shadowCascadeFarZ[C],k=k.pointsFrustum,k[0].z=T,k[1].z=T,k[2].z=T,k[3].z=T,k[4].z=N,k[5].z=N,k[6].z=N,k[7].z=N,L[S]=A,S++}else L[S]=E,S++;y=0;for(w=L.length;y<w;y++){E=L[y],E.shadowMap||(x=THREE.LinearFilter,t.shadowMapType===THREE.PCFSoftShadowMap&&(x=THREE.NearestFilter),E.shadowMap=new THREE.WebGLRenderTarget(E.shadowMapWidth,E.shadowMapHeight,{minFilter:x,magFilter:x,format:THREE.RGBAFormat}),E.shadowMapSize=new THREE.Vector2(E.shadowMapWidth,E.shadowMapHeight),E.shadowMatrix=new THREE.Matrix4);if(!E.shadowCamera){if(E instanceof THREE.SpotLight)E.shadowCamera=new THREE.PerspectiveCamera(E.shadowCameraFov,E.shadowMapWidth/E.shadowMapHeight,E.shadowCameraNear,E.shadowCameraFar);else{if(!(E instanceof THREE.DirectionalLight)){console.error("Unsupported light type for shadow");continue}E.shadowCamera=new THREE.OrthographicCamera(E.shadowCameraLeft,E.shadowCameraRight,E.shadowCameraTop,E.shadowCameraBottom,E.shadowCameraNear,E.shadowCameraFar)}p.add(E.shadowCamera),!0===p.autoUpdate&&p.updateMatrixWorld()}E.shadowCameraVisible&&!E.cameraHelper&&(E.cameraHelper=new THREE.CameraHelper(E.shadowCamera),E.shadowCamera.add(E.cameraHelper));if(E.isVirtual&&A.originalCamera==v){x=v,S=E.shadowCamera,T=E.pointsFrustum,k=E.pointsWorld,a.set(Infinity,Infinity,Infinity),f.set(-Infinity,-Infinity,-Infinity);for(N=0;8>N;N++)C=k[N],C.copy(T[N]),THREE.ShadowMapPlugin.__projector.unprojectVector(C,x),C.applyMatrix4(S.matrixWorldInverse),C.x<a.x&&(a.x=C.x),C.x>f.x&&(f.x=C.x),C.y<a.y&&(a.y=C.y),C.y>f.y&&(f.y=C.y),C.z<a.z&&(a.z=C.z),C.z>f.z&&(f.z=C.z);S.left=a.x,S.right=f.x,S.top=f.y,S.bottom=a.y,S.updateProjectionMatrix()}S=E.shadowMap,T=E.shadowMatrix,x=E.shadowCamera,x.position.getPositionFromMatrix(E.matrixWorld),l.getPositionFromMatrix(E.target.matrixWorld),x.lookAt(l),x.updateMatrixWorld(),x.matrixWorldInverse.getInverse(x.matrixWorld),E.cameraHelper&&(E.cameraHelper.visible=E.shadowCameraVisible),E.shadowCameraVisible&&E.cameraHelper.update(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(x.projectionMatrix),T.multiply(x.matrixWorldInverse),u.multiplyMatrices(x.projectionMatrix,x.matrixWorldInverse),o.setFromMatrix(u),t.setRenderTarget(S),t.clear(),k=p.__webglObjects,E=0;for(S=k.length;E<S;E++)if(N=k[E],T=N.object,N.render=!1,T.visible&&T.castShadow&&(!(T instanceof THREE.Mesh||T instanceof THREE.ParticleSystem)||!T.frustumCulled||o.intersectsObject(T)))T._modelViewMatrix.multiplyMatrices(x.matrixWorldInverse,T.matrixWorld),N.render=!0;E=0;for(S=k.length;E<S;E++)N=k[E],N.render&&(T=N.object,N=N.buffer,O=T.material instanceof THREE.MeshFaceMaterial?T.material.materials[0]:T.material,C=0<T.geometry.morphTargets.length&&O.morphTargets,O=T instanceof THREE.SkinnedMesh&&O.skinning,C=T.customDepthMaterial?T.customDepthMaterial:O?C?s:i:C?r:n,N instanceof THREE.BufferGeometry?t.renderBufferDirect(x,p.__lights,null,C,N,T):t.renderBuffer(x,p.__lights,null,C,N,T));k=p.__webglObjectsImmediate,E=0;for(S=k.length;E<S;E++)N=k[E],T=N.object,T.visible&&T.castShadow&&(T._modelViewMatrix.multiplyMatrices(x.matrixWorldInverse,T.matrixWorld),t.renderImmediateObject(x,p.__lights,null,n,T))}y=t.getClearColor(),w=t.getClearAlpha(),e.clearColor(y.r,y.g,y.b,w),e.enable(e.BLEND),t.shadowMapCullFace===THREE.CullFaceFront&&e.cullFace(e.BACK)}},THREE.ShadowMapPlugin.__projector=new THREE.Projector,THREE.SpritePlugin=function(){function e(e,t){return e.z!==t.z?t.z-e.z:t.id-e.id}var t,n,r,i,s,o,u,a,f,l;this.init=function(e){t=e.context,n=e,r=e.getPrecision(),i=new Float32Array(16),s=new Uint16Array(6),e=0,i[e++]=-1,i[e++]=-1,i[e++]=0,i[e++]=0,i[e++]=1,i[e++]=-1,i[e++]=1,i[e++]=0,i[e++]=1,i[e++]=1,i[e++]=1,i[e++]=1,i[e++]=-1,i[e++]=1,i[e++]=0,i[e++]=1,e=0,s[e++]=0,s[e++]=1,s[e++]=2,s[e++]=0,s[e++]=2,s[e++]=3,o=t.createBuffer(),u=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.bufferData(t.ELEMENT_ARRAY_BUFFER,s,t.STATIC_DRAW);var e=THREE.ShaderSprite.sprite,p=t.createProgram(),v=t.createShader(t.FRAGMENT_SHADER),y=t.createShader(t.VERTEX_SHADER),w="precision "+r+" float;\n";t.shaderSource(v,w+e.fragmentShader),t.shaderSource(y,w+e.vertexShader),t.compileShader(v),t.compileShader(y),t.attachShader(p,v),t.attachShader(p,y),t.linkProgram(p),a=p,f={},l={},f.position=t.getAttribLocation(a,"position"),f.uv=t.getAttribLocation(a,"uv"),l.uvOffset=t.getUniformLocation(a,"uvOffset"),l.uvScale=t.getUniformLocation(a,"uvScale"),l.rotation=t.getUniformLocation(a,"rotation"),l.scale=t.getUniformLocation(a,"scale"),l.alignment=t.getUniformLocation(a,"alignment"),l.color=t.getUniformLocation(a,"color"),l.map=t.getUniformLocation(a,"map"),l.opacity=t.getUniformLocation(a,"opacity"),l.useScreenCoordinates=t.getUniformLocation(a,"useScreenCoordinates"),l.sizeAttenuation=t.getUniformLocation(a,"sizeAttenuation"),l.screenPosition=t.getUniformLocation(a,"screenPosition"),l.modelViewMatrix=t.getUniformLocation(a,"modelViewMatrix"),l.projectionMatrix=t.getUniformLocation(a,"projectionMatrix"),l.fogType=t.getUniformLocation(a,"fogType"),l.fogDensity=t.getUniformLocation(a,"fogDensity"),l.fogNear=t.getUniformLocation(a,"fogNear"),l.fogFar=t.getUniformLocation(a,"fogFar"),l.fogColor=t.getUniformLocation(a,"fogColor"),l.alphaTest=t.getUniformLocation(a,"alphaTest")},this.render=function(r,i,s,p){var d=r.__webglSprites,v=d.length;if(v){var y=f,w=l,E=p/s,s=.5*s,S=.5*p;t.useProgram(a),t.enableVertexAttribArray(y.position),t.enableVertexAttribArray(y.uv),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,o),t.vertexAttribPointer(y.position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(y.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u),t.uniformMatrix4fv(w.projectionMatrix,!1,i.projectionMatrix.elements),t.activeTexture(t.TEXTURE0),t.uniform1i(w.map,0);var x=y=0,T=r.fog;T?(t.uniform3f(w.fogColor,T.color.r,T.color.g,T.color.b),T instanceof THREE.Fog?(t.uniform1f(w.fogNear,T.near),t.uniform1f(w.fogFar,T.far),t.uniform1i(w.fogType,1),x=y=1):T instanceof THREE.FogExp2&&(t.uniform1f(w.fogDensity,T.density),t.uniform1i(w.fogType,2),x=y=2)):(t.uniform1i(w.fogType,0),x=y=0);for(var N,C,k=[],T=0;T<v;T++)N=d[T],C=N.material,N.visible&&0!==C.opacity&&(C.useScreenCoordinates?N.z=-N.position.z:(N._modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,N.matrixWorld),N.z=-N._modelViewMatrix.elements[14]));d.sort(e);for(T=0;T<v;T++)N=d[T],C=N.material,N.visible&&0!==C.opacity&&C.map&&C.map.image&&C.map.image.width&&(t.uniform1f(w.alphaTest,C.alphaTest),!0===C.useScreenCoordinates?(t.uniform1i(w.useScreenCoordinates,1),t.uniform3f(w.screenPosition,(N.position.x*n.devicePixelRatio-s)/s,(S-N.position.y*n.devicePixelRatio)/S,Math.max(0,Math.min(1,N.position.z))),k[0]=n.devicePixelRatio,k[1]=n.devicePixelRatio):(t.uniform1i(w.useScreenCoordinates,0),t.uniform1i(w.sizeAttenuation,C.sizeAttenuation?1:0),t.uniformMatrix4fv(w.modelViewMatrix,!1,N._modelViewMatrix.elements),k[0]=1,k[1]=1),i=r.fog&&C.fog?x:0,y!==i&&(t.uniform1i(w.fogType,i),y=i),i=1/(C.scaleByViewport?p:1),k[0]*=i*E*N.scale.x,k[1]*=i*N.scale.y,t.uniform2f(w.uvScale,C.uvScale.x,C.uvScale.y),t.uniform2f(w.uvOffset,C.uvOffset.x,C.uvOffset.y),t.uniform2f(w.alignment,C.alignment.x,C.alignment.y),t.uniform1f(w.opacity,C.opacity),t.uniform3f(w.color,C.color.r,C.color.g,C.color.b),t.uniform1f(w.rotation,N.rotation),t.uniform2fv(w.scale,k),n.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),n.setDepthTest(C.depthTest),n.setDepthWrite(C.depthWrite),n.setTexture(C.map,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0));t.enable(t.CULL_FACE)}}},THREE.DepthPassPlugin=function(){this.enabled=!1,this.renderTarget=null;var e,t,n,r,i,s,o=new THREE.Frustum,u=new THREE.Matrix4;this.init=function(o){e=o.context,t=o;var o=THREE.ShaderLib.depthRGBA,u=THREE.UniformsUtils.clone(o.uniforms);n=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u}),r=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0}),i=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,skinning:!0}),s=new THREE.ShaderMaterial({fragmentShader:o.fragmentShader,vertexShader:o.vertexShader,uniforms:u,morphTargets:!0,skinning:!0}),n._shadowPass=!0,r._shadowPass=!0,i._shadowPass=!0,s._shadowPass=!0},this.render=function(e,t){this.enabled&&this.update(e,t)},this.update=function(l,p){var v,m,y,w,E,S;e.clearColor(1,1,1,1),e.disable(e.BLEND),t.setDepthTest(!0),!0===l.autoUpdate&&l.updateMatrixWorld(),p.matrixWorldInverse.getInverse(p.matrixWorld),u.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),o.setFromMatrix(u),t.setRenderTarget(this.renderTarget),t.clear(),S=l.__webglObjects,v=0;for(m=S.length;v<m;v++)if(y=S[v],E=y.object,y.render=!1,E.visible&&(!(E instanceof THREE.Mesh||E instanceof THREE.ParticleSystem)||!E.frustumCulled||o.intersectsObject(E)))E._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,E.matrixWorld),y.render=!0;var x;v=0;for(m=S.length;v<m;v++)if(y=S[v],y.render&&(E=y.object,y=y.buffer,!(E instanceof THREE.ParticleSystem)||E.customDepthMaterial))(x=E.material instanceof THREE.MeshFaceMaterial?E.material.materials[0]:E.material)&&t.setMaterialFaces(E.material),w=0<E.geometry.morphTargets.length&&x.morphTargets,x=E instanceof THREE.SkinnedMesh&&x.skinning,w=E.customDepthMaterial?E.customDepthMaterial:x?w?s:i:w?r:n,y instanceof THREE.BufferGeometry?t.renderBufferDirect(p,l.__lights,null,w,y,E):t.renderBuffer(p,l.__lights,null,w,y,E);S=l.__webglObjectsImmediate,v=0;for(m=S.length;v<m;v++)y=S[v],E=y.object,E.visible&&(E._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,E.matrixWorld),t.renderImmediateObject(p,l.__lights,null,n,E));v=t.getClearColor(),m=t.getClearAlpha(),e.clearColor(v.r,v.g,v.b,m),e.enable(e.BLEND)}},THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}},THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}},define("three",function(){});var TWEEN=TWEEN||function(){var e=[];return{REVISION:"10",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){t=e.indexOf(t),-1!==t&&e.splice(t,1)},update:function(t){if(0===e.length)return!1;for(var n=0,r=e.length,t=void 0!==t?t:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();n<r;)e[n].update(t)?n++:(e.splice(n,1),r--);return!0}}}();TWEEN.Tween=function(e){var t={},n={},r={},i=1e3,s=0,o=0,u=null,a=TWEEN.Easing.Linear.None,f=TWEEN.Interpolation.Linear,l=[],c=null,h=!1,p=null,d=null,v;for(v in e)t[v]=parseFloat(e[v],10);this.to=function(e,t){return void 0!==t&&(i=t),n=e,this},this.start=function(i){TWEEN.add(this),h=!1,u=void 0!==i?i:void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),u+=o;for(var s in n){if(n[s]instanceof Array){if(0===n[s].length)continue;n[s]=[e[s]].concat(n[s])}t[s]=e[s],0==t[s]instanceof Array&&(t[s]*=1),r[s]=t[s]||0}return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(e){return o=e,this},this.repeat=function(e){return s=e,this},this.easing=function(e){return a=e,this},this.interpolation=function(e){return f=e,this},this.chain=function(){return l=arguments,this},this.onStart=function(e){return c=e,this},this.onUpdate=function(e){return p=e,this},this.onComplete=function(e){return d=e,this},this.update=function(v){if(v<u)return!0;!1===h&&(null!==c&&c.call(e),h=!0);var m=(v-u)/i,m=1<m?1:m,y=a(m),w;for(w in n){var E=t[w]||0,S=n[w];S instanceof Array?e[w]=f(S,y):("string"==typeof S&&(S=E+parseFloat(S,10)),e[w]=E+(S-E)*y)}null!==p&&p.call(e,y);if(1==m){if(!(0<s)){null!==d&&d.call(e),m=0;for(y=l.length;m<y;m++)l[m].start(v);return!1}isFinite(s)&&s--;for(w in r)"string"==typeof n[w]&&(r[w]+=parseFloat(n[w],10)),t[w]=r[w];u=v+o}return!0}},TWEEN.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return 1>(e*=2)?.5*e*e:-0.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e:-0.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return 1>(e*=2)?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:1>(e*=2)?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return 1>(e*=2)?-0.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/.4)))},Out:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*2*Math.PI/.4)+1)},InOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),1>(e*=2)?-0.5*n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*2*Math.PI/.4):.5*n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*2*Math.PI/.4)+1)}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){return 1>(e*=2)?.5*e*e*(3.5949095*e-2.5949095):.5*((e-=2)*e*(3.5949095*e+2.5949095)+2)}},Bounce:{In:function(e){return 1-TWEEN.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*TWEEN.Easing.Bounce.In(2*e):.5*TWEEN.Easing.Bounce.Out(2*e-1)+.5}}},TWEEN.Interpolation={Linear:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),s=TWEEN.Interpolation.Utils.Linear;return 0>t?s(e[0],e[1],r):1<t?s(e[n],e[n-1],n-r):s(e[i],e[i+1>n?n:i+1],r-i)},Bezier:function(e,t){var n=0,r=e.length-1,i=Math.pow,s=TWEEN.Interpolation.Utils.Bernstein,o;for(o=0;o<=r;o++)n+=i(1-t,r-o)*i(t,o)*e[o]*s(r,o);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,i=Math.floor(r),s=TWEEN.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(0>t&&(i=Math.floor(r=n*(1+t))),s(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],r-i)):0>t?e[0]-(s(e[0],e[0],e[1],e[1],-r)-e[0]):1<t?e[n]-(s(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):s(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],r-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=TWEEN.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1,r;if(e[t])return e[t];for(r=t;1<r;r--)n*=r;return e[t]=n}}(),CatmullRom:function(e,t,n,r,i){var e=.5*(n-e),r=.5*(r-t),s=i*i;return(2*t-2*n+e+r)*i*s+(-3*t+3*n-2*e-r)*s+e*i+t}}},define("tween",function(){}),THREE.EffectComposer=function(e,t){this.renderer=e;if(t===undefined){var n=window.innerWidth||1,r=window.innerHeight||1,i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1};t=new THREE.WebGLRenderTarget(n,r,i)}this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],THREE.CopyShader===undefined&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader)},THREE.EffectComposer.prototype={swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var t=!1,n,r,i=this.passes.length;for(r=0;r<i;r++){n=this.passes[r];if(!n.enabled)continue;n.render(this.renderer,this.writeBuffer,this.readBuffer,e,t);if(n.needsSwap){if(t){var s=this.renderer.context;s.stencilFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.stencilFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}n instanceof THREE.MaskPass?t=!0:n instanceof THREE.ClearMaskPass&&(t=!1)}},reset:function(e){e===undefined&&(e=this.renderTarget1.clone(),e.width=window.innerWidth,e.height=window.innerHeight),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){var n=this.renderTarget1.clone();n.width=e,n.height=t,this.reset(n)}},THREE.EffectComposer.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1),THREE.EffectComposer.quad=new THREE.Mesh(new THREE.PlaneGeometry(2,2),null),THREE.EffectComposer.scene=new THREE.Scene,THREE.EffectComposer.scene.add(THREE.EffectComposer.quad),define("postprocessing/EffectComposer",function(){}),THREE.RenderPass=function(e,t,n,r,i){this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=i!==undefined?i:1,this.oldClearColor=new THREE.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},THREE.RenderPass.prototype={render:function(e,t,n,r){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.render(this.scene,this.camera,n,this.clear),this.clearColor&&e.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}},define("postprocessing/RenderPass",function(){}),THREE.MaskPass=function(e,t){this.scene=e,this.camera=t,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype={render:function(e,t,n,r){var i=e.context;i.colorMask(!1,!1,!1,!1),i.depthMask(!1);var s,o;this.inverse?(s=0,o=1):(s=1,o=0),i.enable(i.STENCIL_TEST),i.stencilOp(i.REPLACE,i.REPLACE,i.REPLACE),i.stencilFunc(i.ALWAYS,s,4294967295),i.clearStencil(o),e.render(this.scene,this.camera,n,this.clear),e.render(this.scene,this.camera,t,this.clear),i.colorMask(!0,!0,!0,!0),i.depthMask(!0),i.stencilFunc(i.EQUAL,1,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}},THREE.ClearMaskPass=function(){this.enabled=!0},THREE.ClearMaskPass.prototype={render:function(e,t,n,r){var i=e.context;i.disable(i.STENCIL_TEST)}},define("postprocessing/MaskPass",function(){}),THREE.ShaderPass=function(e,t){this.textureID=t!==undefined?t:"tDiffuse",this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader}),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1},THREE.ShaderPass.prototype={render:function(e,t,n,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n),THREE.EffectComposer.quad.material=this.material,this.renderToScreen?e.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera):e.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera,t,this.clear)}},define("postprocessing/ShaderPass",function(){}),THREE.SavePass=function(e){THREE.CopyShader===undefined&&console.error("THREE.SavePass relies on THREE.CopyShader");var t=THREE.CopyShader;this.textureID="tDiffuse",this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.renderTarget=e,this.renderTarget===undefined&&(this.renderTargetParameters={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1},this.renderTarget=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters)),this.enabled=!0,this.needsSwap=!1,this.clear=!1},THREE.SavePass.prototype={render:function(e,t,n,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n),THREE.EffectComposer.quad.material=this.material,e.render(THREE.EffectComposer.scene,THREE.EffectComposer.camera,this.renderTarget,this.clear)}},define("postprocessing/SavePass",function(){});var dat=dat||{};dat.gui=dat.gui||{},dat.utils=dat.utils||{},dat.controllers=dat.controllers||{},dat.dom=dat.dom||{},dat.color=dat.color||{},dat.utils.css=function(){return{load:function(e,t){var t=t||document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)},inject:function(e,t){var t=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e,t.getElementsByTagName("head")[0].appendChild(n)}}}(),dat.utils.common=function(){var e=Array.prototype.forEach,t=Array.prototype.slice;return{BREAK:{},extend:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(t[n])||(e[n]=t[n])},this),e},defaults:function(e){return this.each(t.call(arguments,1),function(t){for(var n in t)this.isUndefined(e[n])&&(e[n]=t[n])},this),e},compose:function(){var e=t.call(arguments);return function(){for(var n=t.call(arguments),r=e.length-1;r>=0;r--)n=[e[r].apply(this,n)];return n[0]}},each:function(t,n,r){if(e&&t.forEach===e)t.forEach(n,r);else if(t.length===t.length+0){for(var i=0,s=t.length;i<s;i++)if(i in t&&n.call(r,t[i],i)===this.BREAK)break}else for(i in t)if(n.call(r,t[i],i)===this.BREAK)break},defer:function(e){setTimeout(e,0)},toArray:function(e){return e.toArray?e.toArray():t.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(e){return e!==e},isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return Object.prototype.toString.call(e)==="[object Function]"}}}(),dat.controllers.Controller=function(e){var t=function(e,t){this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onFinishChange=this.__onChange=void 0};return e.extend(t.prototype,{onChange:function(e){return this.__onChange=e,this},onFinishChange:function(e){return this.__onFinishChange=e,this},setValue:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),t}(dat.utils.common),dat.dom.dom=function(e){function t(t){return t==="0"||e.isUndefined(t)?0:(t=t.match(r),e.isNull(t)?0:parseFloat(t[1]))}var n={};e.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(t,r){e.each(t,function(e){n[e]=r})});var r=/(\d+(\.\d+)?)px/,i={makeSelectable:function(e,t){e!==void 0&&e.style!==void 0&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(t,n,r){e.isUndefined(n)&&(n=!0),e.isUndefined(r)&&(r=!0),t.style.position="absolute",n&&(t.style.left=0,t.style.right=0),r&&(t.style.top=0,t.style.bottom=0)},fakeEvent:function(t,r,i,s){var i=i||{},o=n[r];if(!o)throw Error("Event type "+r+" not supported.");var u=document.createEvent(o);switch(o){case"MouseEvents":u.initMouseEvent(r,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,i.x||i.clientX||0,i.y||i.clientY||0,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":o=u.initKeyboardEvent||u.initKeyEvent,e.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),o(r,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:u.initEvent(r,i.bubbles||!1,i.cancelable||!0)}e.defaults(u,s),t.dispatchEvent(u)},bind:function(e,t,n,r){return e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent&&e.attachEvent("on"+t,n),i},unbind:function(e,t,n,r){return e.removeEventListener?e.removeEventListener(t,n,r||!1):e.detachEvent&&e.detachEvent("on"+t,n),i},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)==-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return i},removeClass:function(e,t){if(t){if(e.className!==void 0)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);r!=-1&&(n.splice(r,1),e.className=n.join(" "))}}else e.className=void 0;return i},hasClass:function(e,t){return RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){return e=getComputedStyle(e),t(e["border-left-width"])+t(e["border-right-width"])+t(e["padding-left"])+t(e["padding-right"])+t(e.width)},getHeight:function(e){return e=getComputedStyle(e),t(e["border-top-width"])+t(e["border-bottom-width"])+t(e["padding-top"])+t(e["padding-bottom"])+t(e.height)},getOffset:function(e){var t={left:0,top:0};if(e.offsetParent)do t.left+=e.offsetLeft,t.top+=e.offsetTop;while(e=e.offsetParent);return t},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}};return i}(dat.utils.common),dat.controllers.OptionController=function(e,t,n){var r=function(e,i,s){r.superclass.call(this,e,i);var o=this;this.__select=document.createElement("select");if(n.isArray(s)){var u={};n.each(s,function(e){u[e]=e}),s=u}n.each(s,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),o.__select.appendChild(n)}),this.updateDisplay(),t.bind(this.__select,"change",function(){o.setValue(this.options[this.selectedIndex].value)}),this.domElement.appendChild(this.__select)};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){return e=r.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.NumberController=function(e,t){var n=function(e,r,i){n.superclass.call(this,e,r),i=i||{},this.__min=i.min,this.__max=i.max,this.__step=i.step,e=this.__impliedStep=t.isUndefined(this.__step)?this.initialValue==0?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,e=e.toString(),this.__precision=e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0};return n.superclass=e,t.extend(n.prototype,e.prototype,{setValue:function(e){return this.__min!==void 0&&e<this.__min?e=this.__min:this.__max!==void 0&&e>this.__max&&(e=this.__max),this.__step!==void 0&&e%this.__step!=0&&(e=Math.round(e/this.__step)*this.__step),n.superclass.prototype.setValue.call(this,e)},min:function(e){return this.__min=e,this},max:function(e){return this.__max=e,this},step:function(e){return this.__step=e,this}}),n}(dat.controllers.Controller,dat.utils.common),dat.controllers.NumberControllerBox=function(e,t,n){var r=function(e,i,s){function o(){var e=parseFloat(l.__input.value);n.isNaN(e)||l.setValue(e)}function u(e){var t=h-e.clientY;l.setValue(l.getValue()+t*l.__impliedStep),h=e.clientY}function f(){t.unbind(window,"mousemove",u),t.unbind(window,"mouseup",f)}this.__truncationSuspended=!1,r.superclass.call(this,e,i,s);var l=this,h;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"change",o),t.bind(this.__input,"blur",function(){o(),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}),t.bind(this.__input,"mousedown",function(e){t.bind(window,"mousemove",u),t.bind(window,"mouseup",f),h=e.clientY}),t.bind(this.__input,"keydown",function(e){e.keyCode===13&&(l.__truncationSuspended=!0,this.blur(),l.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){var e=this.__input,t;if(this.__truncationSuspended)t=this.getValue();else{t=this.getValue();var n=Math.pow(10,this.__precision);t=Math.round(t*n)/n}return e.value=t,r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common),dat.controllers.NumberControllerSlider=function(e,t,n,r,i){var s=function(e,n,r,i,o){function u(e){e.preventDefault();var n=t.getOffset(l.__background),r=t.getWidth(l.__background);return l.setValue(l.__min+(l.__max-l.__min)*((e.clientX-n.left)/(n.left+r-n.left))),!1}function f(){t.unbind(window,"mousemove",u),t.unbind(window,"mouseup",f),l.__onFinishChange&&l.__onFinishChange.call(l,l.getValue())}s.superclass.call(this,e,n,{min:r,max:i,step:o});var l=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),t.bind(this.__background,"mousedown",function(e){t.bind(window,"mousemove",u),t.bind(window,"mouseup",f),u(e)}),t.addClass(this.__background,"slider"),t.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return s.superclass=e,s.useDefaultStyles=function(){n.inject(i)},r.extend(s.prototype,e.prototype,{updateDisplay:function(){return this.__foreground.style.width=(this.getValue()-this.__min)/(this.__max-this.__min)*100+"%",s.superclass.prototype.updateDisplay.call(this)}}),s}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),dat.controllers.FunctionController=function(e,t,n){var r=function(e,n,i){r.superclass.call(this,e,n);var s=this;this.__button=document.createElement("div"),this.__button.innerHTML=i===void 0?"Fire":i,t.bind(this.__button,"click",function(e){return e.preventDefault(),s.fire(),!1}),t.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=e,n.extend(r.prototype,e.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.BooleanController=function(e,t,n){var r=function(e,n){r.superclass.call(this,e,n);var i=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),t.bind(this.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=e,n.extend(r.prototype,e.prototype,{setValue:function(e){return e=r.superclass.prototype.setValue.call(this,e),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.color.toString=function(e){return function(t){if(t.a==1||e.isUndefined(t.a)){for(t=t.hex.toString(16);t.length<6;)t="0"+t;return"#"+t}return"rgba("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+","+t.a+")"}}(dat.utils.common),dat.color.interpret=function(e,t){var n,r,i=[{litmus:t.isString,conversions:{THREE_CHAR_HEX:{read:function(e){return e=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i),e===null?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:e},SIX_CHAR_HEX:{read:function(e){return e=e.match(/^#([A-F0-9]{6})$/i),e===null?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:e},CSS_RGB:{read:function(e){return e=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/),e===null?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:e},CSS_RGBA:{read:function(e){return e=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/),e===null?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:e}}},{litmus:t.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:t.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!=3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!=4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:t.isObject,conversions:{RGBA_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)&&t.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return t.isNumber(e.r)&&t.isNumber(e.g)&&t.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)&&t.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return t.isNumber(e.h)&&t.isNumber(e.s)&&t.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}];return function(){r=!1;var e=arguments.length>1?t.toArray(arguments):arguments[0];return t.each(i,function(i){if(i.litmus(e))return t.each(i.conversions,function(i,s){n=i.read(e);if(r===!1&&n!==!1)return r=n,n.conversionName=s,n.conversion=i,t.BREAK}),t.BREAK}),r}}(dat.color.toString,dat.utils.common),dat.GUI=dat.gui.GUI=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){function v(e,t,n,s){if(t[n]===void 0)throw Error("Object "+t+' has no property "'+n+'"');s.color?t=new l(t,n):(t=[t,n].concat(s.factoryArgs),t=r.apply(e,t)),s.before instanceof i&&(s.before=s.before.__li),y(e,t),p.addClass(t.domElement,"c"),n=document.createElement("span"),p.addClass(n,"property-name"),n.innerHTML=t.property;var o=document.createElement("div");return o.appendChild(n),o.appendChild(t.domElement),s=m(e,o,s.before),p.addClass(s,P.CLASS_CONTROLLER_ROW),p.addClass(s,typeof t.getValue()),g(e,s,t),e.__controllers.push(t),t}function m(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,params.before):e.__ul.appendChild(r),e.onResize(),r}function g(e,t,n){n.__li=t,n.__gui=e,d.extend(n,{options:function(t){if(arguments.length>1)return n.remove(),v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[d.toArray(arguments)]});if(d.isArray(t)||d.isObject(t))return n.remove(),v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[t]})},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}});if(n instanceof a){var r=new u(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});d.each(["updateDisplay","onChange","onFinishChange"],function(e){var t=n[e],i=r[e];n[e]=r[e]=function(){var e=Array.prototype.slice.call(arguments);return t.apply(n,e),i.apply(r,e)}}),p.addClass(t,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof u){var i=function(t){return d.isNumber(n.__min)&&d.isNumber(n.__max)?(n.remove(),v(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):t};n.min=d.compose(i,n.min),n.max=d.compose(i,n.max)}else n instanceof s?(p.bind(t,"click",function(){p.fakeEvent(n.__checkbox,"click")}),p.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof o?(p.bind(t,"click",function(){p.fakeEvent(n.__button,"click")}),p.bind(t,"mouseover",function(){p.addClass(n.__button,"hover")}),p.bind(t,"mouseout",function(){p.removeClass(n.__button,"hover")})):n instanceof l&&(p.addClass(t,"color"),n.updateDisplay=d.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=d.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&T(e.getRoot(),!0),t},n.setValue)}function y(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(r!=-1){var i=n.__rememberedObjectIndecesToControllers[r];i===void 0&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[t.property]=t;if(n.load&&n.load.remembered){n=n.load.remembered;if(n[e.preset])n=n[e.preset];else{if(!n[C])return;n=n[C]}n[r]&&n[r][t.property]!==void 0&&(r=n[r][t.property],t.initialValue=r,t.setValue(r))}}}function b(e){var t=e.__save_row=document.createElement("li");p.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),p.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",p.addClass(n,"button gears");var r=document.createElement("span");r.innerHTML="Save",p.addClass(r,"button"),p.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",p.addClass(i,"button"),p.addClass(i,"save-as");var s=document.createElement("span");s.innerHTML="Revert",p.addClass(s,"button"),p.addClass(s,"revert");var o=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?d.each(e.load.remembered,function(t,n){x(e,n,n==e.preset)}):x(e,C,!1),p.bind(o,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(o),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(s);if(k){var t=document.getElementById("dg-save-locally"),u=document.getElementById("dg-local-explain");t.style.display="block",t=document.getElementById("dg-local-storage"),localStorage.getItem(document.location.href+".isLocal")==="true"&&t.setAttribute("checked","checked");var a=function(){u.style.display=e.useLocalStorage?"block":"none"};a(),p.bind(t,"change",function(){e.useLocalStorage=!e.useLocalStorage,a()})}var f=document.getElementById("dg-new-constructor");p.bind(f,"keydown",function(e){e.metaKey&&(e.which===67||e.keyCode==67)&&A.hide()}),p.bind(n,"click",function(){f.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),A.show(),f.focus(),f.select()}),p.bind(r,"click",function(){e.save()}),p.bind(i,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),p.bind(s,"click",function(){e.revert()})}function w(e){function t(t){return t.preventDefault(),i=t.clientX,p.addClass(e.__closeButton,P.CLASS_DRAG),p.bind(window,"mousemove",n),p.bind(window,"mouseup",r),!1}function n(t){return t.preventDefault(),e.width+=i-t.clientX,e.onResize(),i=t.clientX,!1}function r(){p.removeClass(e.__closeButton,P.CLASS_DRAG),p.unbind(window,"mousemove",n),p.unbind(window,"mouseup",r)}e.__resize_handle=document.createElement("div"),d.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;p.bind(e.__resize_handle,"mousedown",t),p.bind(e.__closeButton,"mousedown",t),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function E(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function S(e,t){var n={};return d.each(e.__rememberedObjects,function(r,i){var s={};d.each(e.__rememberedObjectIndecesToControllers[i],function(e,n){s[n]=t?e.initialValue:e.getValue()}),n[i]=s}),n}function x(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function T(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function N(e){e.length!=0&&c(function(){N(e)}),d.each(e,function(e){e.updateDisplay()})}e.inject(n);var C="Default",k;try{k="localStorage"in window&&window.localStorage!==null}catch(L){k=!1}var A,O=!0,M,_=!1,D=[],P=function(e){function t(){localStorage.setItem(document.location.href+".gui",JSON.stringify(r.getSaveObject()))}function n(){var e=r.getRoot();e.width+=1,d.defer(function(){e.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),p.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],e=e||{},e=d.defaults(e,{autoPlace:!0,width:P.DEFAULT_WIDTH}),e=d.defaults(e,{resizable:e.autoPlace,hideable:e.autoPlace}),d.isUndefined(e.load)?e.load={preset:C}:e.preset&&(e.load.preset=e.preset),d.isUndefined(e.parent)&&e.hideable&&D.push(this),e.resizable=d.isUndefined(e.parent)&&e.resizable,e.autoPlace&&d.isUndefined(e.scrollable)&&(e.scrollable=!0);var i=k&&localStorage.getItem(document.location.href+".isLocal")==="true";Object.defineProperties(this,{parent:{get:function(){return e.parent}},scrollable:{get:function(){return e.scrollable}},autoPlace:{get:function(){return e.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:e.load.preset},set:function(t){r.parent?r.getRoot().preset=t:e.load.preset=t;for(t=0;t<this.__preset_select.length;t++)this.__preset_select[t].value==this.preset&&(this.__preset_select.selectedIndex=t);r.revert()}},width:{get:function(){return e.width},set:function(t){e.width=t,E(r,t)}},name:{get:function(){return e.name},set:function(t){e.name=t,o&&(o.innerHTML=e.name)}},closed:{get:function(){return e.closed},set:function(t){e.closed=t,e.closed?p.addClass(r.__ul,P.CLASS_CLOSED):p.removeClass(r.__ul,P.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?P.TEXT_OPEN:P.TEXT_CLOSED)}},load:{get:function(){return e.load}},useLocalStorage:{get:function(){return i},set:function(e){k&&((i=e)?p.bind(window,"unload",t):p.unbind(window,"unload",t),localStorage.setItem(document.location.href+".isLocal",e))}}});if(d.isUndefined(e.parent)){e.closed=!1,p.addClass(this.domElement,P.CLASS_MAIN),p.makeSelectable(this.domElement,!1);if(k&&i){r.useLocalStorage=!0;var s=localStorage.getItem(document.location.href+".gui");s&&(e.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=P.TEXT_CLOSED,p.addClass(this.__closeButton,P.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),p.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{e.closed===void 0&&(e.closed=!0);var o=document.createTextNode(e.name);p.addClass(o,"controller-name"),s=m(r,o),p.addClass(this.__ul,P.CLASS_CLOSED),p.addClass(s,"title"),p.bind(s,"click",function(e){return e.preventDefault(),r.closed=!r.closed,!1}),e.closed||(this.closed=!1)}e.autoPlace&&(d.isUndefined(e.parent)&&(O&&(M=document.createElement("div"),p.addClass(M,"dg"),p.addClass(M,P.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(M),O=!1),M.appendChild(this.domElement),p.addClass(this.domElement,P.CLASS_AUTO_PLACE)),this.parent||E(r,e.width)),p.bind(window,"resize",function(){r.onResize()}),p.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),p.bind(this.__ul,"transitionend",function(){r.onResize()}),p.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),e.resizable&&w(this),r.getRoot(),e.parent||n()};return P.toggleHide=function(){_=!_,d.each(D,function(e){e.domElement.style.zIndex=_?-999:999,e.domElement.style.opacity=_?0:1})},P.CLASS_AUTO_PLACE="a",P.CLASS_AUTO_PLACE_CONTAINER="ac",P.CLASS_MAIN="main",P.CLASS_CONTROLLER_ROW="cr",P.CLASS_TOO_TALL="taller-than-window",P.CLASS_CLOSED="closed",P.CLASS_CLOSE_BUTTON="close-button",P.CLASS_DRAG="drag",P.DEFAULT_WIDTH=245,P.TEXT_CLOSED="Close Controls",P.TEXT_OPEN="Open Controls",p.bind(window,"keydown",function(e){document.activeElement.type!=="text"&&(e.which===72||e.keyCode==72)&&P.toggleHide()},!1),d.extend(P.prototype,{add:function(e,t){return v(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return v(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.slice(this.__controllers.indexOf(e),1);var t=this;d.defer(function(){t.onResize()})},destroy:function(){this.autoPlace&&M.removeChild(this.domElement)},addFolder:function(e){if(this.__folders[e]!==void 0)throw Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};return t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]),t=new P(t),this.__folders[e]=t,e=m(this,t.domElement),p.addClass(e,"folder"),t},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=p.getOffset(e.__ul).top,n=0;d.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=p.getHeight(t))}),window.innerHeight-t-20<n?(p.addClass(e.domElement,P.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(p.removeClass(e.domElement,P.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&d.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},remember:function(){d.isUndefined(A)&&(A=new h,A.domElement.innerHTML=t);if(this.parent)throw Error("You can only call remember on a top level GUI.");var e=this;d.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length==0&&b(e),e.__rememberedObjects.indexOf(t)==-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&E(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=S(this)),e.folders={},d.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=S(this),T(this,!1)},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[C]=S(this,!0)),this.load.remembered[e]=S(this),this.preset=e,x(this,e,!0)},revert:function(e){d.each(this.__controllers,function(t){this.getRoot().load.remembered?y(e||this.getRoot(),t):t.setValue(t.initialValue)},this),d.each(this.__folders,function(e){e.revert(e)}),e||T(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length==0;this.__listening.push(e),t&&N(this.__listening)}}),P}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",dat.controllers.factory=function(e,t,n,r,i,s,o){return function(u,l,h,p){var v=u[l];if(o.isArray(h)||o.isObject(h))return new e(u,l,h);if(o.isNumber(v))return o.isNumber(h)&&o.isNumber(p)?new n(u,l,h,p):new t(u,l,{min:h,max:p});if(o.isString(v))return new r(u,l);if(o.isFunction(v))return new i(u,l,"");if(o.isBoolean(v))return new s(u,l)}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(e,t,n){var r=function(e,n){function i(){s.setValue(s.__input.value)}r.superclass.call(this,e,n);var s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),t.bind(this.__input,"keyup",i),t.bind(this.__input,"change",i),t.bind(this.__input,"blur",function(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}),t.bind(this.__input,"keydown",function(e){e.keyCode===13&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=e,n.extend(r.prototype,e.prototype,{updateDisplay:function(){return t.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(e,t,n,r,i){function s(e,t,n,r){e.style.background="",i.each(a,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+n+" 0%, "+r+" 100%); "})}function o(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var u=function(e,a){function l(e){g(e),t.bind(window,"mousemove",g),t.bind(window,"mouseup",p)}function p(){t.unbind(window,"mousemove",g),t.unbind(window,"mouseup",p)}function v(){var e=r(this.value);e!==!1?(w.__color.__state=e,w.setValue(w.__color.toOriginal())):this.value=w.__color.toString()}function m(){t.unbind(window,"mousemove",y),t.unbind(window,"mouseup",m)}function g(e){e.preventDefault();var n=t.getWidth(w.__saturation_field),r=t.getOffset(w.__saturation_field),i=(e.clientX-r.left+document.body.scrollLeft)/n,e=1-(e.clientY-r.top+document.body.scrollTop)/n;return e>1?e=1:e<0&&(e=0),i>1?i=1:i<0&&(i=0),w.__color.v=e,w.__color.s=i,w.setValue(w.__color.toOriginal()),!1}function y(e){e.preventDefault();var n=t.getHeight(w.__hue_field),r=t.getOffset(w.__hue_field),e=1-(e.clientY-r.top+document.body.scrollTop)/n;return e>1?e=1:e<0&&(e=0),w.__color.h=e*360,w.setValue(w.__color.toOriginal()),!1}u.superclass.call(this,e,a),this.__color=new n(this.getValue()),this.__temp=new n(0);var w=this;this.domElement=document.createElement("div"),t.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",t.bind(this.__input,"keydown",function(e){e.keyCode===13&&v.call(this)}),t.bind(this.__input,"blur",v),t.bind(this.__selector,"mousedown",function(){t.addClass(this,"drag").bind(window,"mouseup",function(){t.removeClass(w.__selector,"drag")})});var E=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(E.style,{width:"100%",height:"100%",background:"none"}),s(E,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),o(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),t.bind(this.__saturation_field,"mousedown",l),t.bind(this.__field_knob,"mousedown",l),t.bind(this.__hue_field,"mousedown",function(e){y(e),t.bind(window,"mousemove",y),t.bind(window,"mouseup",m)}),this.__saturation_field.appendChild(E),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};u.superclass=e,i.extend(u.prototype,e.prototype,{updateDisplay:function(){var e=r(this.getValue());if(e!==!1){var t=!1;i.each(n.COMPONENTS,function(n){if(!i.isUndefined(e[n])&&!i.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&i.extend(this.__color.__state,e)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,u=255-o;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,s(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+u+","+u+","+u+",.7)"})}});var a=["-moz-","-o-","-webkit-","-ms-",""];return u}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(e,t,n,r){function i(e,t,n){Object.defineProperty(e,t,{get:function(){return this.__state.space==="RGB"?this.__state[t]:(o(this,t,n),this.__state[t])},set:function(e){this.__state.space!=="RGB"&&(o(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function s(e,t){Object.defineProperty(e,t,{get:function(){return this.__state.space==="HSV"?this.__state[t]:(u(this),this.__state[t])},set:function(e){this.__state.space!=="HSV"&&(u(this),this.__state.space="HSV"),this.__state[t]=e}})}function o(e,n,i){if(e.__state.space==="HEX")e.__state[n]=t.component_from_hex(e.__state.hex,i);else{if(e.__state.space!=="HSV")throw"Corrupted color state";r.extend(e.__state,t.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}}function u(e){var n=t.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=n.h}var a=function(){this.__state=e.apply(this,arguments);if(this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return a.COMPONENTS="r,g,b,h,s,v,hex,a".split(","),r.extend(a.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(a.prototype,"r",2),i(a.prototype,"g",1),i(a.prototype,"b",0),s(a.prototype,"h"),s(a.prototype,"s"),s(a.prototype,"v"),Object.defineProperty(a.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(a.prototype,"hex",{get:function(){return!this.__state.space!=="HEX"&&(this.__state.hex=t.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}}),a}(dat.color.interpret,dat.color.math=function(){var e;return{hsv_to_rgb:function(e,t,n){var r=e/60-Math.floor(e/60),i=n*(1-t),s=n*(1-r*t),t=n*(1-(1-r)*t),e=[[n,t,i],[s,n,i],[i,n,t],[i,s,n],[t,i,n],[n,i,s]][Math.floor(e/60)%6];return{r:e[0]*255,g:e[1]*255,b:e[2]*255}},rgb_to_hsv:function(e,t,n){var r=Math.min(e,t,n),i=Math.max(e,t,n),r=i-r;return i==0?{h:NaN,s:0,v:0}:(e=e==i?(t-n)/r:t==i?2+(n-e)/r:4+(e-t)/r,e/=6,e<0&&(e+=1),{h:e*360,s:r/i,v:i/255})},rgb_to_hex:function(e,t,n){return e=this.hex_with_component(0,2,e),e=this.hex_with_component(e,1,t),e=this.hex_with_component(e,0,n)},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(t,n,r){return r<<(e=n*8)|t&~(255<<e)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),dat.dom.CenteredDiv=function(e,t){var n=function(){this.backgroundElement=document.createElement("div"),t.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),e.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),t.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;e.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),t.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var t=this,n=function(){t.domElement.style.display="none",t.backgroundElement.style.display="none",e.unbind(t.domElement,"webkitTransitionEnd",n),e.unbind(t.domElement,"transitionend",n),e.unbind(t.domElement,"oTransitionEnd",n)};e.bind(this.domElement,"webkitTransitionEnd",n),e.bind(this.domElement,"transitionend",n),e.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-e.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-e.getHeight(this.domElement)/2+"px"},n}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common),define("dat.gui",function(){}),define("image",[],function(){function r(){}function i(n){return n=n.replace(t,""),n+=n.indexOf("?")<0?"?":"&",n+e+"="+Math.round(2147483647*Math.random())}var e="bust",t="!bust",n="!rel";return{load:function(e,t,i,s){var o;s.isBuild?i(null):(o=new Image,o.onerror=function(e){i.error(e)},o.onload=function(e){i(o);try{delete o.onload}catch(t){o.onload=r}},e.indexOf(n)!==-1?o.src=t.toUrl(e.replace(n,"")):o.src=e)},normalize:function(e,n){return e.indexOf(t)===-1?e:i(e)}}}),define("landscape",["image!img/sand.jpg"],function(e){var t,n,r,i=Math.PI*2,s={init:function(t){var n,r,s,o=4e4,u=40;n=new THREE.PlaneGeometry(o,o,u-1,u-1);for(var a,f,l,c=0;l=n.vertices[c];c++)a=c%u/u*2-1,f=~~(c/u)/u*2-1,l.z=(Math.cos(a*i)+Math.cos(f*i))*-400;var h=new THREE.Texture(e);h.magFilter=THREE.LinearMipMapLinearFilter,h.minFilter=THREE.LinearMipMapNearestFilter,h.wrapS=h.wrapT=THREE.RepeatWrapping,h.repeat.set(10,10),h.needsUpdate=!0,r=new THREE.MeshPhongMaterial({color:16777215,map:h}),n.computeFaceNormals(),n.computeVertexNormals(),n.computeTangents(),s=new THREE.Mesh(n,r),s.receiveShadow=!0,s.castShadow=!0,s.position.y=-500,s.rotation.x=-Math.PI/2,t.add(s)}};return s}),define("water",["image!img/water.jpg"],function(e){var t,n,r,i,s=128,o=128,u=s/2,a=o/2,f={roughness:35,height:-1e3},l={init:function(u,a){r=new THREE.PlaneGeometry(2e4,2e4,s-1,o-1),r.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2)),r.dynamic=!0;var l,c,h,p;for(l=0,h=r.vertices.length;l<h;l++)r.vertices[l].y=f.roughness*Math.sin(l/2);r.computeFaceNormals(),r.computeVertexNormals(),n=new THREE.Texture(e),n.wrapS=n.wrapT=THREE.RepeatWrapping,n.repeat.set(5,5),n.needsUpdate=!0,i=new THREE.MeshBasicMaterial({color:17663,map:n}),t=new THREE.Mesh(r,i),u.add(t);var d=a.addFolder("water");a.remember(f),d.add(f,"roughness",0,60),d.add(f,"height",-1400,100)},render:function(e,i){for(var s=0,o=r.vertices.length;s<o;s++)r.vertices[s].y=f.roughness*Math.sin(s/5+(i*10+s)/7);var u=i%100/100;n.offset.set(u,u),t.geometry.verticesNeedUpdate=!0,t.position.y=f.height}};return l}),define("clouds",["image!img/cloud.png"],function(e,t,n){var r,i={scale:1,height:500,windspeed:.1,dispersion:1},s={init:function(t,n){var s=800;r=new THREE.Object3D;var o=new THREE.Texture(e);o.magFilter=THREE.LinearMipMapLinearFilter,o.minFilter=THREE.LinearMipMapNearestFilter,o.needsUpdate=!0;var u=new THREE.SpriteMaterial({map:o,useScreenCoordinates:!1,color:16777215});for(var a=0;a<s;a++){var f=Math.random()-.5,l=(Math.random()-.5)*.001,c=Math.random()-.5,h=new THREE.Sprite(u);h.position.set(f,l,c),h.rotation.z=Math.random()*Math.PI,h.__scale=Math.random()*Math.random()*2.5+.5,h.position.multiplyScalar(5e3),r.add(h)}t.add(r);var p=n.addFolder("clouds");n.remember(i),p.add(i,"scale",0,4),p.add(i,"dispersion",0,5),p.add(i,"windspeed",0,300),p.add(i,"height",0,1500)},render:function(e){for(var t=0;t<r.children.length;t++){var n=r.children[t],s=n.material,o=1,u=1;s.map&&s.map.image&&s.map.image.width&&(o=s.map.image.width,u=s.map.image.height),n.rotation+=.001*(t/r.children.length),n.scale.set(n.__scale*i.scale*o,n.__scale*i.scale*u,1)}r.position.y=i.height,r.scale.set(i.dispersion,i.dispersion,i.dispersion),r.rotation.y+=e*(i.windspeed/1e3)}};return s}),THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},define("shaders/CopyShader",function(){}),THREE.BlendShader={uniforms:{tDiffuse1:{type:"t",value:null},tDiffuse2:{type:"t",value:null},mixRatio:{type:"f",value:.5},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","vec4 texel1 = texture2D( tDiffuse1, vUv );","vec4 texel2 = texture2D( tDiffuse2, vUv );","gl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n")},define("shaders/BlendShader",function(){}),THREE.EdgeShader={uniforms:{tDiffuse:{type:"t",value:null},aspect:{type:"v2",value:new THREE.Vector2(512,512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","G[0] = g0,","G[1] = g1,","G[2] = g2,","G[3] = g3,","G[4] = g4,","G[5] = g5,","G[6] = g6,","G[7] = g7,","G[8] = g8;","mat3 I;","float cnv[9];","vec3 sample;","for (float i=0.0; i<3.0; i++) {","for (float j=0.0; j<3.0; j++) {","sample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","I[int(i)][int(j)] = length(sample);","}","}","for (int i=0; i<9; i++) {","float dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","cnv[i] = dp3 * dp3;","}","float M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","float S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","gl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n")},define("shaders/EdgeShader",function(){}),THREE.VignetteShader={uniforms:{tDiffuse:{type:"t",value:null},offset:{type:"f",value:1},darkness:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","gl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")},define("shaders/VignetteShader",function(){}),THREE.SepiaShader={uniforms:{tDiffuse:{type:"t",value:null},amount:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 color = texture2D( tDiffuse, vUv );","vec3 c = color.rgb;","color.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","color.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","color.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","gl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n")},define("shaders/SepiaShader",function(){}),define("fxstuff",["shaders/CopyShader","shaders/BlendShader","shaders/EdgeShader","shaders/VignetteShader","shaders/SepiaShader"],function(){function i(r){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,e.setSize(window.innerWidth,window.innerHeight),t.setSize(window.innerWidth,window.innerHeight)}function s(t){var n=t.addFolder("Effects"),i=n.addFolder("Edge"),s={enabled:!0,savePass:r.savePass,edgeEffect:r.edgeEffect,blend:r.blend,bg:"#000000",bgOpacity:0};t.remember(s),t.remember(s.blend.uniforms.mixRatio),t.remember(s.blend.uniforms.opacity),i.add(s,"enabled").onFinishChange(function(e){s.savePass.enabled=e,s.edgeEffect.enabled=e,s.blend.enabled=e}),i.add(s.blend.uniforms.mixRatio,"value",-1,1).step(.1).name("mixratio"),i.add(s.blend.uniforms.opacity,"value",0,1).step(.1).name("opacity"),i.add(s,"bgOpacity",0,1).name("Bg opacity").onChange(function(){e.setClearColor(s.bg,s.bgOpacity)}),i.addColor(s,"bg").name("Background color"),t.remember(r.vignette),t.remember(r.vignette.uniforms.offset),t.remember(r.vignette.uniforms.darkness);var o=n.addFolder("Vignette");o.add(r.vignette,"enabled"),o.add(r.vignette.uniforms.offset,"value",0,100).step(.25).name("offset"),o.add(r.vignette.uniforms.darkness,"value",0,1).step(.1).name("darkness"),t.remember(r.sepia),t.remember(r.sepia.uniforms.amount);var u=n.addFolder("Sepia");u.add(r.sepia,"enabled").name("Sepia"),u.add(r.sepia.uniforms.amount,"value",-1,1).step(.1).name("amount")}function o(o,u,a,f){n=a,e=new THREE.WebGLRenderer,e.setSize(window.innerWidth,window.innerHeight),e.setClearColor("#000000",0),e.shadowMapEnabled=!0,e.shadowMapType=THREE.PCFShadowMap,r={},r.savePass=new THREE.SavePass,r.edgeEffect=new THREE.ShaderPass(THREE.EdgeShader),r.edgeEffect.uniforms.aspect.value.x=window.innerWidth,r.edgeEffect.uniforms.aspect.value.y=window.innerHeight,r.blend=new THREE.ShaderPass(THREE.BlendShader,"tDiffuse1"),r.blend.uniforms.tDiffuse2.value=r.savePass.renderTarget,r.blend.uniforms.mixRatio.value=.85,r.vignette=new THREE.ShaderPass(THREE.VignetteShader),r.vignette.enabled=!1,r.vignette.uniforms.offset.value.x=1,r.vignette.uniforms.darkness.value.x=1,r.sepia=new THREE.ShaderPass(THREE.SepiaShader),r.sepia.enabled=!1,r.sepia.uniforms.amount.value.x=1,r.final=new THREE.ShaderPass(THREE.CopyShader),r.final.renderToScreen=!0,r.render=new THREE.RenderPass(u,n),t=new THREE.EffectComposer(e),t.addPass(r.render),t.addPass(r.savePass),t.addPass(r.edgeEffect),t.addPass(r.blend),t.addPass(r.sepia),t.addPass(r.vignette),t.addPass(r.final),s(f),$(o).append(e.domElement),$(window).on("resize",i)}var e,t,n,r,u={render:function(){e.clear(),t.render()},initEffects:o};return u}),define("tweenstuff",[],function(){function o(e,t,n,r,i,s){var o=function(){$.each(e,function(e,t){typeof n[e]!="boolean"&&(n[e]=t)})},u=(new TWEEN.Tween(e)).to(t,r.duration*1e3).easing(i).onUpdate(o).onComplete(s);u.start()}function u(t){function f(){a||(a=!0,n=!1,$(e.__preset_select).val(t.to),e.preset=t.to)}var r=e.load.remembered,i=$.extend(!0,{},r[t.from]),s=$.extend(!0,{},r[t.to]);$(e.__preset_select).val(t.from),e.preset=t.from,TWEEN.removeAll();var u=TWEEN.Easing[t.easing.split(".")[0]][t.easing.split(".")[1]];u=typeof u=="undefined"?TWEEN.Easing.Linear.None:u;var a=!1;for(var l in i){var c=i[l],h=s[l];if(h){var p=e.__rememberedObjects[l];o(c,h,p,t,u,f)}}}function a(n){var i=t.addFolder(n.name),o=n.name;i.add(n,"name").onFinishChange(function(e){a(n),delete t.__folders[o],$(i.domElement).remove(),delete i,o=e}),i.add(n,"from",Object.keys(e.load.remembered)),i.add(n,"to",Object.keys(e.load.remembered)),i.add(n,"easing",s),i.add(n,"duration",0,120).step(.01),i.add(n,"start"),i.add({"delete":function(){var e=confirm("Are you sure you want to delete this transition?");e==1&&(r.splice(r.indexOf(n),1),delete t.__folders[n.name],$(i.domElement).remove(),delete i)}},"delete")}function f(e){var t={name:"new transition",from:"Default",to:"Default",easing:"Linear",duration:2,start:function(){u(t)}};$.extend(t,e),a(t),r.push(t)}function l(n,r){t=n,e=r,t.add({add:f},"add").name("Add a transition");for(var s in i)f(i[s])}var e,t,n,r=[],i=typeof localStorage.Tweenz=="undefined"?[]:JSON.parse(localStorage.Tweenz),s={};Object.keys(TWEEN.Easing).forEach(function(e){Object.keys(TWEEN.Easing[e]).forEach(function(t){var n=e+"."+t;s[n]=n})});var c={initTweenz:l,Tweenz:r,save:function(){localStorage.Tweenz=JSON.stringify(r)},queNext:function(){if(!n){n=!0;var e=$("#quequeList").find(".quequed");e.length==0?$("#quequeList").find("li:first").find(".playBtn").click():e.removeClass("quequed").next().addClass(".quequed").find(".playBtn").click()}}};return c}),define("text",["module"],function(e){var t,n,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,o=typeof location!="undefined"&&location.href,u=o&&location.protocol&&location.protocol.replace(/\:/,""),a=o&&location.hostname,f=o&&(location.port||undefined),l=[],c=e.config&&e.config()||{};t={version:"2.0.5",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:c.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=r[t];try{e=new ActiveXObject(n)}catch(i){}if(e){r=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,c.isBuild&&(l[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}c.isBuild=i.isBuild;var s=t.parseName(e),l=s.moduleName+(s.ext?"."+s.ext:""),h=n.toUrl(l),p=c.useXhr||t.useXhr;!o||p(h,u,a,f)?t.get(h,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([l],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(l.hasOwnProperty(n)){var s=t.jsEscape(l[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(c.env==="node"||!c.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(c.env==="xhr"||!c.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);c.onXhr&&c.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText))},s.send(null)};else if(c.env==="rhino"||!c.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};return t}),define("json",["text"],function(text){function cacheBust(e){return e=e.replace(CACHE_BUST_FLAG,""),e+=e.indexOf("?")<0?"?":"&",e+CACHE_BUST_QUERY_PARAM+"="+Math.round(2147483647*Math.random())}var CACHE_BUST_QUERY_PARAM="bust",CACHE_BUST_FLAG="!bust",jsonParse=typeof JSON!="undefined"&&typeof JSON.parse=="function"?JSON.parse:function(val){return eval("("+val+")")},buildMap={};return{load:function(e,t,n,r){!r.isBuild||r.inlineJSON!==!1&&e.indexOf(CACHE_BUST_QUERY_PARAM+"=")===-1?text.get(t.toUrl(e),function(t){r.isBuild?(buildMap[e]=t,n(t)):n(jsonParse(t))},n.error,{accept:"application/json"}):n(null)},normalize:function(e,t){return e.indexOf(CACHE_BUST_FLAG)===-1?e:cacheBust(e)},write:function(e,t,n){if(t in buildMap){var r=buildMap[t];n('define("'+e+"!"+t+'", function(){ return '+r+";});\n")}}}}),define("json!models/SHACK.js",function(){return{metadata:{formatVersion:3.1,generatedBy:"Blender 2.66 Exporter",vertices:816,faces:612,normals:704,colors:0,uvs:[],materials:1,morphTargets:0,bones:0},scale:1,materials:[{DbgColor:15658734,DbgIndex:0,DbgName:"Material",blending:"NormalBlending",colorAmbient:[.1400000190734865,.1400000190734865,.1400000190734865],colorDiffuse:[.1400000190734865,.1400000190734865,.1400000190734865],colorSpecular:[.7,.7,.7],depthTest:!0,depthWrite:!0,shading:"Lambert",specularCoef:50,transparency:1,transparent:!1,vertexColors:!1}],vertices:[-1.90522,-0.0274019,-1.87662,-1.68313,-0.0274022,-1.87671,-1.68311,-0.0274022,-1.83669,-1.90521,-0.027402,-1.83661,-1.90522,2.56909,-1.87662,-1.68313,2.77955,-1.87671,-1.68312,2.77955,-1.83669,-1.90521,2.56909,-1.83661,-1.65317,2.7883,-1.83348,-1.43109,3.09763,-1.83356,-1.4311,3.09763,-1.87357,-1.65319,2.7883,-1.87349,-1.6687,-0.0186033,-1.83347,-1.44661,-0.0199599,-1.83356,-1.44662,-0.0199602,-1.87357,-1.66871,-0.0186033,-1.87349,-1.17412,-0.0185455,-1.87879,-0.95299,-0.0182869,-1.87375,-0.952975,-0.0182869,-1.83374,-1.1761,-0.0185454,-1.83883,-1.17707,3.39975,-1.87893,-0.955253,3.6706,-1.86795,-0.957232,3.6706,-1.82799,-1.17905,3.39975,-1.83897,-1.42998,3.08851,-1.83679,-1.20873,3.39078,-1.84367,-1.20675,3.39078,-1.88363,-1.43,3.08851,-1.8768,-1.41151,-0.0290642,-1.8368,-1.18942,-0.0274488,-1.83688,-1.1883,-0.0274488,-1.88272,-1.41152,-0.0290642,-1.87681,-0.423587,-0.0121608,-1.87717,-0.191844,-0.0086782,-1.86489,-0.201508,-0.0086782,-1.83725,-0.423572,-0.0121608,-1.83716,-0.463421,4.23765,-1.87716,-0.231612,4.5418,-1.86719,-0.233925,4.5418,-1.82725,-0.463406,4.23765,-1.83715,-0.204363,4.55102,-1.8223,.0173464,4.88475,-1.80946,.0196595,4.88475,-1.84941,-0.20205,4.55102,-1.86225,-0.18009,345469e-9,-1.8209,.0416195,.00247133,-1.80806,.0439327,.00247121,-1.848,-0.177777,345469e-9,-1.86084,-0.680856,-0.0038625,-1.87385,-0.458766,-0.00335193,-1.87394,-0.458751,-0.00335181,-1.83392,-0.680842,-0.00386238,-1.83384,-0.686695,3.97566,-1.87385,-0.464604,4.24677,-1.87393,-0.464589,4.24677,-1.83392,-0.68668,3.97566,-1.83384,-0.939791,3.67415,-1.83035,-0.716545,3.96666,-1.83705,-0.71656,3.96666,-1.87707,-0.937812,3.67415,-1.87032,-0.918458,-0.0146495,-1.8293,-0.695186,-0.0127822,-1.83706,-0.695201,-0.0127822,-1.87707,-0.916479,-0.0146494,-1.86926,1.03521,.0103602,-1.86998,1.25649,.0117531,-1.8778,1.25651,.0117528,-1.83779,1.03323,.0103645,-1.83002,1.01933,3.98984,-1.87104,1.24058,3.70059,-1.87779,1.2406,3.70059,-1.83778,1.01735,3.98985,-1.83108,1.27048,3.70953,-1.83457,1.49257,3.43897,-1.83465,1.49256,3.43897,-1.87466,1.27047,3.70953,-1.87458,1.27087,.0206418,-1.83457,1.49296,.0206759,-1.83465,1.49295,.0206759,-1.87466,1.27086,.0206418,-1.87458,1.77394,.0237708,-1.86157,1.99566,.0254213,-1.84873,1.99334,.0254259,-1.80878,1.77163,.0237758,-1.82162,1.75512,3.14134,-1.86297,1.97683,2.8323,-1.85014,1.97452,2.83231,-1.81019,1.7528,3.14134,-1.82303,1.49374,3.42986,-1.83788,1.72322,3.13219,-1.82797,1.72554,3.13218,-1.86792,1.49372,3.42986,-1.87789,1.52812,.0117918,-1.83789,1.75019,.014798,-1.83797,1.75986,.0147777,-1.86561,1.52811,.0117916,-1.8779,.540139,-0.00299275,-1.87753,.763366,-0.00185621,-1.88345,.762243,-0.00185394,-1.8376,.540154,-0.00299275,-1.83752,.527112,4.54776,-1.87753,.75036,4.24824,-1.88436,.748381,4.24824,-1.8444,.527127,4.54776,-1.83752,.778079,4.25715,-1.8397,.999898,3.98633,-1.82871,1.00188,3.98633,-1.86868,.780058,4.25714,-1.87966,.775582,.00702119,-1.83955,.998707,.00680089,-1.83446,.998692,.00680089,-1.87448,.777561,.0070169,-1.87951,.282972,.00801992,-1.87421,.505055,.00618672,-1.87429,.50507,.0061866,-1.83428,.282987,.00801957,-1.8342,.303941,4.89033,-1.87422,.526025,4.55689,-1.8743,.526039,4.55689,-1.83429,.303956,4.89033,-1.83421,.0519063,4.88212,-1.83734,.273997,4.88164,-1.83742,.273982,4.88164,-1.87743,.0518916,4.88212,-1.87735,.0464582,-0.000271916,-1.83734,.268549,-0.000748277,-1.83742,.268534,-0.000748038,-1.87743,.0464437,-0.000271916,-1.87735,-2.50312,1.90481,-1.38015,-2.50304,1.90474,-1.15806,-2.53346,1.93074,-1.15804,-2.53353,1.93081,-1.38013,.126434,4.98068,-1.38015,.126509,4.98062,-1.15806,.0960956,5.00662,-1.15804,.0960207,5.00668,-1.38013,.102711,5.0193,-1.1281,.101382,5.01759,-0.906014,.131795,4.99159,-0.906032,.133125,4.9933,-1.12812,-2.5268,1.94349,-1.14362,-2.52813,1.94178,-0.921536,-2.49771,1.91578,-0.921553,-2.49638,1.91749,-1.14364,-2.49227,1.91409,-0.64905,-2.49582,1.91767,-0.427919,-2.52623,1.94367,-0.427901,-2.52264,1.94006,-0.651026,.137395,4.98987,-0.652001,.129325,4.99731,-0.430181,.098949,5.02328,-0.432158,.107019,5.01584,-0.653977,.0943909,5.00445,-0.904908,.101307,5.00192,-0.683656,.131683,4.97595,-0.68168,.124804,4.97845,-0.904925,-2.53509,1.92865,-0.886432,-2.53334,1.93054,-0.664347,-2.49849,1.90076,-0.663227,-2.50467,1.90265,-0.88645,-2.48684,1.92283,.101484,-2.49257,1.93502,.333227,-2.51358,1.95299,.323565,-2.51726,1.94883,.101501,.142373,4.99834,.0616499,.138412,5.00903,.293459,.10805,5.03498,.291149,.111959,5.02434,.0616677,.113837,5.04936,.320711,.106292,5.06026,.542422,.136655,5.0343,.544732,.1442,5.0234,.323021,-2.51666,1.97453,.344985,-2.52421,1.98544,.566695,-2.49384,1.95948,.569005,-2.4863,1.94858,.347295,-2.48079,1.93505,-0.155786,-2.48019,1.93561,.066305,-2.5106,1.96161,.0663227,-2.51121,1.96105,-0.155768,.148751,5.01092,-0.161624,.149354,5.01147,.0604666,.118941,5.03747,.0604843,.118337,5.03692,-0.161606,.104423,5.02604,-0.414717,.111461,5.02393,-0.191472,.141875,4.99793,-0.19149,.134799,5.00007,-0.412741,-2.52584,1.95096,-0.393384,-2.51799,1.94816,-0.170112,-2.48758,1.92216,-0.17013,-2.49546,1.92499,-0.391408,-2.46892,1.95471,1.56028,-2.46152,1.9513,1.78156,-2.49194,1.9773,1.78158,-2.49929,1.98068,1.55831,.161387,5.02983,1.5444,.167971,5.02712,1.76565,.137558,5.05312,1.76567,.131016,5.05581,1.54242,.144368,5.06603,1.79555,.144478,5.06601,2.01765,.174892,5.04001,2.01763,.174781,5.04003,1.79554,-2.48518,1.99016,1.79594,-2.48507,1.99014,2.01804,-2.45466,1.96414,2.01802,-2.45477,1.96416,1.79593,-2.4614,1.97638,2.29901,-2.46943,1.98671,2.52073,-2.49979,2.01267,2.51842,-2.49175,2.00234,2.2967,.169155,5.05125,2.28019,.161117,5.06158,2.5019,.13076,5.08755,2.49959,.138797,5.07722,2.27788,.137495,5.05287,2.01881,.133075,5.06292,2.2483,.163433,5.03696,2.25061,.167908,5.02687,2.01879,-2.49181,1.97727,2.05319,-2.48862,1.98085,2.27527,-2.46763,1.96286,2.28493,-2.46139,1.95127,2.05318,-2.47703,1.93366,1.06521,-2.47135,1.93118,1.28844,-2.50619,1.96097,1.28732,-2.50744,1.95966,1.06523,.152485,5.00949,1.05218,.158868,5.00642,1.27543,.128496,5.03239,1.27345,.122072,5.03549,1.0522,.134143,5.04623,1.30315,.12558,5.05309,1.52497,.155952,5.02712,1.52695,.164515,5.02025,1.30513,-2.49552,1.97045,1.30066,-2.4996,1.97348,1.52378,-2.46919,1.94748,1.52376,-2.46515,1.94448,1.30263,-2.46817,1.94916,.808043,-2.46999,1.94688,1.03013,-2.50041,1.97288,1.03014,-2.49858,1.97516,.80806,.161301,5.02492,.829012,.159479,5.02264,1.0511,.129065,5.04864,1.05111,.130888,5.05092,.82903,.124757,5.03896,.57698,.124338,5.03832,.79907,.154752,5.01232,.799053,.15517,5.01296,.576962,-2.50479,1.96309,.571532,-2.50521,1.96245,.793622,-2.4748,1.93645,.793605,-2.47438,1.93709,.571514,-2.51343,1.92662,-1.64038,-2.50725,1.92472,-1.41715,-2.5421,1.95451,-1.41827,-2.54385,1.95262,-1.64036,.116045,5.00242,-1.65885,.122924,4.99992,-1.43561,.0925479,5.02589,-1.43758,.0856318,5.02842,-1.65884,-2.50514,1.94146,-1.89757,-2.50647,1.93975,-1.67548,-2.53689,1.96575,-1.67546,-2.53556,1.96746,-1.89755,.124366,5.01727,-1.88205,.123036,5.01556,-1.65996,.0926232,5.04156,-1.65994,.0939529,5.04327,-1.88203,.0872617,5.03065,-2.13406,.0873365,5.03059,-1.91197,.11775,5.00458,-1.91199,.117675,5.00465,-2.13408,-2.54229,1.95478,-2.13406,-2.54222,1.95471,-1.91197,-2.5118,1.92871,-1.91199,-2.51188,1.92878,-2.13408,2.80456,1.95984,-1.38015,2.80464,1.95991,-1.15806,2.77423,1.9339,-1.15804,2.77416,1.93383,-1.38013,.17411,5.03495,-1.38015,.174185,5.03501,-1.15806,.143779,5.009,-1.15804,.143704,5.00894,-1.38013,.132275,5.01751,-1.1281,.133755,5.01593,-0.906015,.164161,5.04194,-0.906032,.162681,5.04352,-1.12812,2.76267,1.94245,-1.14362,2.76415,1.94088,-0.921536,2.79456,1.96689,-0.921553,2.79308,1.96846,-1.14364,2.79708,1.972,-0.64905,2.79299,1.96905,-0.427919,2.76259,1.94304,-0.427901,2.76671,1.94603,-0.651026,.166736,5.0472,-0.652001,.158133,5.04038,-0.430181,.127764,5.01441,-0.432158,.136368,5.02122,-0.653978,.145655,5.00698,-0.904908,.149225,5.01342,-0.683656,.179593,5.0394,-0.68168,.17606,5.03299,-0.904926,2.77605,1.93196,-0.886432,2.77445,1.93398,-0.664347,2.80928,1.96378,-0.663227,2.80645,1.95797,-0.88645,2.78928,1.97872,.101484,2.77635,1.97496,.333227,2.75534,1.95699,.323565,2.75888,1.95271,.101501,.159137,5.05343,.0616499,.147968,5.05118,.293459,.117613,5.02521,.291149,.128732,5.02742,.0616676,.104312,5.03316,.320711,.0923676,5.0274,.542422,.122723,5.05337,.544732,.134666,5.05913,.323021,2.73358,1.95729,.344985,2.72163,1.95152,.566695,2.75199,1.97749,.569005,2.76393,1.98325,.347295,2.77815,1.98659,-0.155786,2.7777,1.98727,.0663049,2.74729,1.96126,.0663226,2.74774,1.96058,-0.155768,.147701,5.06169,-0.161624,.147247,5.06237,.0604666,.116842,5.03636,.0604842,.117296,5.03568,-0.161606,.125889,5.02024,-0.414717,.129059,5.02687,-0.191472,.159465,5.05288,-0.19149,.156257,5.04622,-0.412741,2.75545,1.94456,-0.393384,2.75943,1.95188,-0.170112,2.78983,1.97789,-0.17013,2.78582,1.97054,-0.391408,2.76058,2.00137,1.56028,2.76509,2.00815,1.78156,2.73468,1.98214,1.78158,2.7302,1.9754,1.55831,.13098,5.07711,1.5444,.134679,5.08319,1.76565,.104273,5.05718,1.76567,.100607,5.05113,1.54242,.0925753,5.06591,1.79555,.0926151,5.06602,2.01765,.12302,5.09203,2.01763,.122981,5.09192,1.79554,2.72303,1.99081,1.79594,2.72307,1.99091,2.01804,2.75347,2.01692,2.01802,2.75343,2.01682,1.79593,2.74033,2.01217,2.29901,2.72888,2.00583,2.52073,2.69852,1.97987,2.51842,2.70997,1.98621,2.2967,.111022,5.0881,2.28019,.0995715,5.08177,2.5019,.0692108,5.05581,2.49959,.0806625,5.06214,2.27788,.104507,5.05708,2.01881,.0938983,5.05427,2.2483,.124259,5.08023,2.25061,.134913,5.08309,2.01879,2.73473,1.98227,2.0532,2.73169,1.98597,2.27527,2.75272,2.00391,2.28493,2.76514,2.00827,2.05318,2.78011,1.99009,1.06521,2.78344,1.99532,1.28844,2.7486,1.96553,1.28732,2.74971,1.96408,1.06523,.149689,5.06515,1.05218,.153718,5.07098,1.27543,.123345,5.04501,1.27345,.119284,5.03914,1.0522,.110554,5.05274,1.30315,.102444,5.04534,1.52497,.132817,5.07131,1.52695,.140927,5.07871,1.30513,2.74089,1.97754,1.30066,2.73727,1.97397,1.52378,2.76767,1.99998,1.52376,2.77127,2.00351,1.30263,2.76617,2.00125,.808043,2.76814,1.9991,1.03013,2.73774,1.97309,1.03014,2.73577,1.97524,.80806,.135814,5.07626,.829012,.137788,5.0741,1.0511,.107382,5.04809,1.05111,.105409,5.05025,.82903,.116278,5.04233,.57698,.116846,5.04182,.79907,.147251,5.06783,.799053,.146684,5.06834,.576962,2.74672,1.96724,.571532,2.74729,1.96672,.793622,2.7777,1.99273,.793605,2.77713,1.99324,.571514,2.78141,1.95304,-1.64038,2.78425,1.95885,-1.41715,2.74941,1.92905,-1.41828,2.75101,1.92703,-1.64036,.151023,5.02806,-1.65885,.154556,5.03447,-1.43561,.124187,5.00849,-1.43758,.120618,5.00205,-1.65884,2.76804,1.96353,-1.89757,2.76952,1.96195,-1.67548,2.73912,1.93594,-1.67546,2.73764,1.93752,-1.89755,.137644,5.03858,-1.88205,.139123,5.037,-1.65996,.108718,5.01099,-1.65994,.107238,5.01257,-1.88203,.118667,5.004,-2.13406,.118742,5.00407,-1.91197,.149148,5.03008,-1.91199,.149073,5.03001,-2.13408,2.74912,1.9289,-2.13406,2.7492,1.92896,-1.91197,2.7796,1.95497,-1.91199,2.77953,1.95491,-2.13408,2.07206,.102884,-1.77314,2.07216,.102884,-1.55105,2.03215,.102884,-1.55103,2.03205,.102884,-1.77312,2.07206,2.64331,-1.77314,2.07216,2.64331,-1.55105,2.03215,2.64331,-1.55103,2.03205,2.64331,-1.77312,2.02893,2.65206,-1.52109,2.02903,2.6507,-1.299,2.06904,2.6507,-1.29902,2.06895,2.65206,-1.52111,2.02893,.111683,-1.53661,2.02903,.110327,-1.31453,2.06904,.110327,-1.31454,2.06894,.111683,-1.53663,2.07428,.111741,-1.04204,2.06926,.111999,-0.820909,2.02924,.112,-0.820891,2.03431,.111741,-1.04402,2.07442,2.65216,-1.04499,2.06345,2.65242,-0.823171,2.02349,2.65242,-0.825147,2.03446,2.65216,-1.04697,2.03226,2.64158,-1.2979,2.03916,2.64319,-1.07665,2.07912,2.64319,-1.07467,2.07227,2.64158,-1.29792,2.03227,.101222,-1.27942,2.03237,.102837,-1.05734,2.07821,.102837,-1.05622,2.07228,.101222,-1.27944,2.07272,.118126,-0.291506,2.06045,.121608,-0.059763,2.0328,.121608,-0.0694247,2.03271,.118126,-0.291488,2.0727,2.65824,-0.33134,2.06275,2.66172,-0.0995303,2.0228,2.66172,-0.10184,2.03269,2.65824,-0.331322,2.01786,2.67094,-0.0722783,2.00504,2.67306,.149432,2.04499,2.67306,.151742,2.05781,2.67094,-0.0699683,2.01646,.130632,-0.0480051,2.00364,.132758,.173705,2.04358,.132758,.176015,2.0564,.130632,-0.0456952,2.06938,.126424,-0.548775,2.06948,.126935,-0.326685,2.02946,.126935,-0.326667,2.02937,.126424,-0.548758,2.06937,2.66684,-0.554613,2.06947,2.66735,-0.332523,2.02946,2.66735,-0.332505,2.02936,2.66684,-0.554596,2.02586,2.65597,-0.807707,2.03258,2.65784,-0.584461,2.07259,2.65784,-0.584479,2.06582,2.65597,-0.805731,2.0248,.115637,-0.786374,2.03259,.117504,-0.563102,2.0726,.117504,-0.56312,2.06477,.115637,-0.784397,2.06563,.140646,1.16729,2.07346,.14204,1.38857,2.03345,.14204,1.38859,2.02567,.140651,1.16532,2.06669,2.68102,1.15141,2.07346,2.68241,1.37266,2.03344,2.68241,1.37268,2.02673,2.68102,1.14943,2.03023,2.69135,1.40256,2.03033,2.69139,1.62466,2.07034,2.69139,1.62464,2.07024,2.69135,1.40255,2.03023,.150928,1.40295,2.03033,.150962,1.62505,2.07034,.150962,1.62503,2.07024,.150928,1.40294,2.05727,.154057,1.90602,2.04445,.155707,2.12774,2.0045,.155712,2.12543,2.01732,.154062,1.90371,2.05867,2.69441,1.8872,2.04585,2.69606,2.10891,2.00591,2.69607,2.1066,2.01873,2.69442,1.88489,2.03356,2.68227,1.62582,2.02367,2.68526,1.85531,2.06362,2.68525,1.85762,2.07357,2.68227,1.6258,2.03357,.142078,1.66021,2.03367,.145085,1.88228,2.06131,.145064,1.89194,2.07358,.142078,1.66019,2.07315,.127293,.67222,2.07908,.12843,.895446,2.03323,.128433,.894326,2.03313,.127294,.672238,2.07314,2.66768,.659193,2.07999,2.66882,.882441,2.04003,2.66882,.880465,2.03313,2.66768,.65921,2.03533,2.67773,.910163,2.02436,2.67751,1.13198,2.06432,2.67751,1.13396,2.07529,2.67773,.912139,2.03518,.137308,.907665,2.03011,.137087,1.13079,2.07012,.137087,1.13077,2.07514,.137303,.909642,2.0698,.138306,.415053,2.0699,.136473,.637136,2.02989,.136473,.637154,2.02979,.138306,.415071,2.06981,2.67864,.436022,2.06991,2.67681,.658106,2.0299,2.67681,.658123,2.0298,2.67864,.43604,2.03292,2.67043,.18399,2.03302,2.66996,.406081,2.07303,2.66996,.406063,2.07293,2.67043,.183973,2.03291,.130014,.178542,2.03301,.129539,.400632,2.07302,.129538,.400615,2.07293,.130015,.178524,-1.90522,.0327303,2.10212,-1.68313,.0327303,2.10204,-1.68311,.0327303,2.14205,-1.90521,.0327303,2.14213,-1.90522,2.62922,2.10212,-1.68313,2.83968,2.10204,-1.68312,2.83968,2.14205,-1.90521,2.62922,2.14213,-1.65317,2.84844,2.14527,-1.43109,3.15776,2.14518,-1.4311,3.15776,2.10517,-1.65319,2.84844,2.10525,-1.6687,.0415292,2.14527,-1.44661,.0401723,2.14519,-1.44662,.0401726,2.10518,-1.66871,.0415291,2.10526,-1.17412,.0415868,2.09996,-0.95299,.0418453,2.105,-0.952975,.0418453,2.14501,-1.1761,.0415869,2.13992,-1.17707,3.45988,2.09981,-0.955252,3.73074,2.1108,-0.957232,3.73074,2.15076,-1.17905,3.45988,2.13978,-1.42998,3.14864,2.14196,-1.20873,3.45091,2.13507,-1.20675,3.45091,2.09511,-1.43,3.14864,2.10195,-1.41151,.0310681,2.14195,-1.18942,.0326836,2.14187,-1.1883,.0326836,2.09603,-1.41152,.0310681,2.10194,-0.423587,3.24359,2.10157,-0.191845,3.24707,2.11386,-0.201508,3.24707,2.1415,-0.423572,3.24359,2.14158,-0.463421,4.29778,2.10159,-0.231612,4.60193,2.11156,-0.233925,4.60193,2.1515,-0.463406,4.29778,2.1416,-0.204363,4.61115,2.15644,.0173464,4.94489,2.16928,.0196595,4.94489,2.12934,-0.20205,4.61115,2.1165,-0.18009,3.2561,2.15785,.0416195,3.25822,2.17069,.0439324,3.25822,2.13074,-0.177777,3.2561,2.1179,-0.680856,3.25189,2.10489,-0.458766,3.2524,2.10481,-0.458751,3.2524,2.14482,-0.680842,3.25189,2.14491,-0.686694,4.03579,2.1049,-0.464604,4.3069,2.10481,-0.464589,4.3069,2.14483,-0.686679,4.03579,2.14491,-0.939791,3.73428,2.14839,-0.716545,4.02679,2.14169,-0.71656,4.02679,2.10168,-0.937812,3.73428,2.10843,-0.918458,.0454828,2.14945,-0.695186,.0473502,2.14168,-0.695201,.0473502,2.10167,-0.916479,.0454829,2.10949,1.03521,.0704926,2.10876,1.25649,.0718851,2.10095,1.25651,.0718853,2.14096,1.03323,.0704967,2.14872,1.01933,4.04997,2.1077,1.24058,3.76073,2.10095,1.2406,3.76073,2.14097,1.01735,4.04998,2.14767,1.27048,3.76967,2.14418,1.49257,3.49911,2.1441,1.49256,3.49911,2.10409,1.27047,3.76967,2.10417,1.27087,.0807743,2.14418,1.49296,.0808086,2.1441,1.49295,.0808084,2.10409,1.27086,.0807743,2.10417,1.77394,.0839031,2.11718,1.99566,.0855535,2.13002,1.99334,.0855584,2.16996,1.77163,.0839082,2.15713,1.75512,3.20147,2.11577,1.97683,2.89244,2.12861,1.97452,2.89244,2.16855,1.7528,3.20147,2.15572,1.49374,3.48999,2.14087,1.72322,3.19232,2.15077,1.72554,3.19231,2.11083,1.49372,3.48999,2.10086,1.52812,.071924,2.14086,1.75019,.0749308,2.14078,1.75986,.0749097,2.11313,1.52811,.0719241,2.10085,.540139,.0571395,2.10121,.763366,.0582761,2.0953,.762242,.0582786,2.14114,.540154,.0571398,2.14123,.527112,4.60789,2.10122,.750361,4.30837,2.09438,.748382,4.30837,2.13435,.527127,4.60789,2.14123,.778079,4.31728,2.13905,.999898,4.04647,2.15003,1.00188,4.04646,2.11007,.780059,4.31727,2.09908,.775582,.0671535,2.1392,.998707,.0669334,2.14428,.998692,.0669332,2.10427,.777561,.0671492,2.09923,.282972,3.26377,2.10454,.505055,3.26194,2.10445,.50507,3.26194,2.14447,.282986,3.26377,2.14455,.303941,4.95046,2.10453,.526025,4.61702,2.10445,.52604,4.61702,2.14446,.303956,4.95046,2.14454,.0519066,4.94225,2.14141,.273997,4.94178,2.14132,.273982,4.94178,2.10131,.0518918,4.94225,2.10139,.0464585,3.25548,2.14141,.268549,3.255,2.14133,.268534,3.255,2.10131,.0464435,3.25548,2.1014,-1.86604,-0.017383,-1.80654,-1.86604,-0.0173829,-1.58445,-1.90605,-0.0173829,-1.58445,-1.90605,-0.017383,-1.80654,-1.86604,2.52304,-1.80654,-1.86604,2.52304,-1.58445,-1.90605,2.52304,-1.58445,-1.90605,2.52304,-1.80654,-1.90928,2.53179,-1.55451,-1.90927,2.53044,-1.33242,-1.86926,2.53044,-1.33242,-1.86926,2.53179,-1.55451,-1.90927,-0.00858426,-1.57003,-1.90927,-0.00994086,-1.34795,-1.86926,-0.00994086,-1.34794,-1.86926,-0.00858426,-1.57003,-1.86414,-0.00852644,-1.07544,-1.86926,-0.008268,-0.854311,-1.90927,-0.008268,-0.854311,-1.90411,-0.00852644,-1.07743,-1.864,2.5319,-1.07839,-1.87506,2.53215,-0.856575,-1.91503,2.53215,-0.858569,-1.90396,2.5319,-1.08038,-1.90605,2.52131,-1.33132,-1.89925,2.52293,-1.11006,-1.85929,2.52293,-1.10807,-1.86604,2.52131,-1.33132,-1.90605,-0.0190451,-1.31284,-1.90605,-0.0174298,-1.09075,-1.86021,-0.0174298,-1.08961,-1.86604,-0.0190451,-1.31284,-1.86604,-0.00214159,-0.324906,-1.87841,.00134087,-0.0931689,-1.90605,.00134087,-0.102843,-1.90605,-0.00214171,-0.324906,-1.86604,2.53797,-0.36474,-1.87609,2.54145,-0.132935,-1.91604,2.54145,-0.135263,-1.90605,2.53797,-0.36474,-1.92099,2.55067,-0.105703,-1.93391,2.5528,.116002,-1.89397,2.5528,.11833,-1.88105,2.55067,-0.103375,-1.92241,.0103647,-0.0814305,-1.93532,.0124903,.140274,-1.89538,.0124903,.142602,-1.88246,.0103647,-0.0791028,-1.86926,.00615644,-0.582177,-1.86926,.00666714,-0.360087,-1.90927,.00666714,-0.360087,-1.90927,.00615668,-0.582177,-1.86926,2.54657,-0.588015,-1.86926,2.54708,-0.365925,-1.90927,2.54708,-0.365925,-1.90927,2.54657,-0.588015,-1.91267,2.5357,-0.841128,-1.90605,2.53757,-0.61788,-1.86604,2.53757,-0.61788,-1.8727,2.5357,-0.839134,-1.91373,-0.00463033,-0.819795,-1.90605,-0.00276303,-0.59652,-1.86604,-0.00276303,-0.59652,-1.87377,-0.00463045,-0.817801,-1.87377,.0203793,1.13389,-1.86604,.021772,1.35517,-1.90605,.021772,1.35517,-1.91373,.0203837,1.13189,-1.8727,2.56075,1.118,-1.86604,2.56215,1.33926,-1.90605,2.56215,1.33926,-1.91267,2.56076,1.11601,-1.90927,2.57108,1.36915,-1.90928,2.57112,1.59124,-1.86926,2.57112,1.59124,-1.86926,2.57108,1.36915,-1.90927,.030661,1.36954,-1.90927,.0306952,1.59163,-1.86926,.0306953,1.59163,-1.86926,.0306609,1.36954,-1.88246,.0337899,1.87262,-1.89538,.0354401,2.09433,-1.93532,.0354452,2.092,-1.92241,.0337949,1.87029,-1.88105,2.57414,1.85379,-1.89397,2.57579,2.0755,-1.93391,2.5758,2.07317,-1.92099,2.57415,1.85147,-1.90605,2.562,1.5924,-1.91604,2.56499,1.82189,-1.87609,2.56499,1.82421,-1.86604,2.562,1.5924,-1.90605,.021811,1.62679,-1.90605,.0248172,1.84886,-1.87841,.0247965,1.85853,-1.86604,.021811,1.62679,-1.86604,.00702631,.63882,-1.86021,.00816298,.862049,-1.90605,.00816524,.860908,-1.90605,.00702631,.63882,-1.86604,2.54742,.625792,-1.85928,2.54855,.849044,-1.89925,2.54856,.84705,-1.90605,2.54742,.625792,-1.90396,2.55746,.876746,-1.91503,2.55725,1.09856,-1.87506,2.55724,1.10055,-1.864,2.55746,.87874,-1.90411,.0170403,.874248,-1.90927,.0168202,1.09737,-1.86926,.01682,1.09737,-1.86414,.0170357,.876242,-1.86926,.0180387,.381651,-1.86926,.0162058,.603735,-1.90927,.0162058,.603735,-1.90927,.0180387,.381651,-1.86926,2.55838,.40262,-1.86926,2.55654,.624704,-1.90927,2.55654,.624704,-1.90927,2.55838,.40262,-1.90605,2.55016,.150572,-1.90605,2.54969,.372663,-1.86604,2.54969,.372663,-1.86604,2.55016,.150572,-1.90605,.00974727,.145124,-1.90605,.00927079,.367214,-1.86604,.00927091,.367215,-1.86604,.00974727,.145124],morphTargets:[],normals:[-0.577563,-0.577319,-0.577136,.577105,-0.577349,-0.577563,.577563,-0.577349,.577136,-0.577136,-0.577349,.577563,-0.715079,.307413,-0.627766,-0.714621,.307413,.628315,.33076,.768639,.547472,.330332,.768639,-0.547716,-0.727256,.236152,-0.644429,-0.580889,-0.573962,-0.577136,-0.580462,-0.573962,.577593,-0.726768,.236183,.644948,.574358,-0.580554,.577074,.259377,.798608,.543016,.573931,-0.580554,-0.577471,.25898,.798608,-0.543199,-0.549944,-0.581469,-0.599506,.592975,-0.580096,-0.558397,.562273,-0.573321,.595874,-0.602649,-0.574358,.553972,-0.696585,.257637,-0.669576,-0.751549,.259987,.60625,.266182,.801508,.535447,.298837,.778161,-0.552385,-0.735038,.234077,-0.63628,-0.581225,-0.582324,-0.568346,-0.567858,-0.583544,.580462,-0.726157,.237983,.644978,.576312,-0.569903,.585711,.229926,.803003,.549791,.583148,-0.573717,-0.575091,.28309,.794733,-0.536851,-0.558733,-0.581133,-0.591662,.669271,-0.520493,-0.530198,.503433,-0.617298,.604541,-0.577715,-0.580645,.573626,-0.707938,.242714,-0.663228,-0.740593,.242439,.626667,.203101,.719718,.663869,.305002,.871487,-0.383953,-0.691885,.218696,-0.68804,-0.538804,-0.581744,-0.609272,-0.605518,-0.581744,.543016,-0.766686,.218696,.603595,.547044,-0.572985,.610218,.209265,.804621,.55565,.613819,-0.572985,-0.543016,.272011,.804621,-0.527787,-0.576495,-0.578448,-0.577074,.578143,-0.57625,-0.577593,.57857,-0.57625,.577166,-0.576067,-0.578448,.577502,-0.72515,.2584,-0.638234,-0.724693,.2584,.638752,.281838,.789972,.544481,.281442,.789972,-0.544694,-0.727622,.239845,-0.642628,-0.565844,-0.586596,-0.579394,-0.580767,-0.576586,.574633,-0.727958,.245827,.640004,.589373,-0.575427,.566973,.272561,.808374,.521714,.57271,-0.571093,-0.588061,.258889,.783074,-0.565447,-0.567125,-0.585406,-0.579333,.571673,-0.5721,-0.588061,.588641,-0.576342,.56682,-0.581744,-0.575518,.574725,-0.246925,.790277,-0.560747,-0.295206,.798425,.524735,.733329,.245521,.633961,.717612,.251045,-0.649586,-0.282815,.789636,-0.544481,-0.577471,-0.57741,-0.577105,-0.577044,-0.57741,.577563,-0.282418,.789636,.544664,.577624,-0.577258,.577136,.724784,.259316,.638264,.577197,-0.577258,-0.577563,.724296,.259316,-0.638813,-0.539171,-0.581317,-0.609363,.613758,-0.57329,-0.542741,.547075,-0.573138,.610065,-0.605853,-0.581195,.543229,-0.227943,.798395,-0.557298,-0.29078,.798486,.527085,.688314,.236824,.685629,.76278,.236671,-0.601733,-0.275369,.801721,-0.530442,-0.558946,-0.580737,-0.591845,-0.578753,-0.579943,.57329,-0.264534,.786004,.558702,.502731,-0.617786,.604602,.677541,.242531,.694296,.669393,-0.520707,-0.529832,.772271,.258919,-0.580096,-0.582904,-0.580767,-0.568255,.581713,-0.575091,-0.575182,.575549,-0.571001,.585345,-0.568834,-0.582446,.580615,-0.269265,.8099,-0.521043,-0.266213,.781457,.564257,.724235,.241493,.645833,.725333,.242927,-0.644063,-0.261269,.788354,-0.556963,-0.550615,-0.580676,-0.599658,-0.604022,-0.573016,.553819,-0.302408,.791253,.531419,.5609,-0.574511,.596057,.701132,.258736,.664388,.592303,-0.581042,-0.558153,.747307,.259102,-0.611866,-0.581042,-0.573595,-0.577319,.573504,-0.581133,-0.577349,.573931,-0.581133,.576922,-0.580615,-0.573595,.577746,-0.241707,.804498,-0.542528,-0.241279,.804498,.542711,.730583,.219123,.646657,.730125,.219123,-0.647206,-0.576647,.578295,-0.577074,-0.578448,-0.576373,-0.577166,-0.578051,-0.576373,.577593,-0.57622,.578295,.577502,.576647,-0.578295,.577074,.578448,.576373,.577166,.57622,-0.578295,-0.577502,.578051,.576373,-0.577593,.063478,-0.813837,-0.577593,.063845,-0.814173,.577074,-0.813807,-0.063814,.577593,-0.814203,-0.063509,-0.577074,.813807,.063814,-0.577593,-0.063845,.814173,-0.577074,-0.063478,.813837,.577593,.814203,.063509,.577074,.816218,.06711,-0.573809,.066347,-0.810938,-0.581347,-0.811762,-0.060183,-0.580828,-0.060976,.817042,-0.57329,-0.816218,-0.06711,.573809,-0.066347,.810938,.581347,.060976,-0.817042,.57329,.811762,.060183,.580828,.077609,-0.831751,-0.549638,.047609,-0.803552,.59331,-0.825526,-0.048372,.562243,-0.794244,-0.076662,-0.60268,.831324,.044832,-0.553911,-0.042695,.79809,-0.600971,-0.07419,.826807,.557543,.800165,.073763,.595203,.8052,.067202,-0.589129,.052675,-0.812433,-0.580615,-0.8211,-0.067354,-0.566759,-0.074953,.811701,-0.57918,-0.814692,-0.051637,.577532,-0.054384,.82522,.562181,.06531,-0.809229,.583819,.813196,.061068,.578722,.069308,-0.827937,-0.556475,.066897,-0.738182,.671224,-0.859096,-0.073305,.506485,-0.814905,-0.07065,-0.575213,.81814,.044984,-0.573199,-0.059969,.805078,-0.590075,-0.123692,.845882,.518784,.775353,.139866,.615802,.835047,.037233,-0.548845,.083499,-0.83932,-0.537156,-0.791955,-0.090854,-0.603748,-0.041871,.78692,-0.615589,-0.835047,-0.037233,.548845,-0.083529,.83932,.537156,.041871,-0.78692,.615589,.791955,.090854,.603748,.06238,-0.814905,-0.576189,.064943,-0.813074,.578478,-0.812891,-0.062593,.578997,-0.815088,-0.06473,-0.575671,.812891,.062593,-0.578997,-0.064943,.813074,-0.578478,-0.06238,.814905,.576159,.815088,.06473,.575671,.815271,.060183,-0.575915,.058016,-0.823237,-0.564684,-0.81222,-0.066103,-0.579577,-0.067476,.805292,-0.589007,-0.80398,-0.067568,.590777,-0.051088,.812311,.58095,.07709,-0.815302,.57384,.824244,.060549,.562975,.058992,-0.82223,-0.566057,.076083,-0.816309,.572558,-0.804834,-0.068758,.589465,-0.811365,-0.064913,-0.580889,.816126,.061312,-0.574602,-0.066439,.806299,-0.587725,-0.052095,.811274,.582293,.82342,.05942,.564287,.813746,.063753,-0.577685,.063387,-0.813898,-0.577502,-0.814234,-0.06357,-0.576983,-0.063936,.814081,-0.577166,-0.813746,-0.063753,.577685,-0.063387,.813898,.577502,.063936,-0.814081,.577166,.814234,.06357,.576983,.084445,-0.838374,-0.538469,.040803,-0.788018,.614246,-0.835871,-0.038331,.547563,-0.79104,-0.089663,-0.60509,.835871,.038331,-0.547563,-0.040803,.788018,-0.614246,-0.084445,.838374,.538469,.79104,.089663,.605121,.818995,.046144,-0.571917,.070284,-0.826991,-0.557787,-0.814081,-0.069521,-0.576556,-0.058931,.806116,-0.588763,-0.859859,-0.074343,.505081,-0.124546,.844966,.520096,.065767,-0.739372,.670034,.774499,.138554,.617176,.053713,-0.811396,-0.581957,.064272,-0.810236,.582537,-0.815546,-0.052797,.57622,-0.820246,-0.066195,-0.568102,.806085,.068361,-0.587817,-0.073946,.812738,-0.577899,-0.055361,.824213,.563524,.812372,.059877,.580035,.832148,.04593,-0.552629,.078585,-0.830775,-0.550981,-0.793359,-0.075472,-0.603992,-0.041627,.799158,-0.599628,-0.82635,-0.049501,.560961,-0.075167,.825831,.558855,.046571,-0.80459,.591968,.79928,.072573,.596515,.067385,-0.8099,-0.582659,.059969,-0.818049,.571978,-0.817042,-0.06827,.572497,-0.810907,-0.059023,-0.582141,.817042,.06827,-0.572497,-0.059969,.818049,-0.571978,-0.067385,.8099,.582659,.810907,.059023,.582141,.814631,.064974,-0.576281,.064486,-0.812799,-0.578906,-0.813349,-0.062349,-0.578387,-0.062838,.81518,-0.575762,-0.814661,-0.064974,.576281,-0.064486,.812799,.578906,.062838,-0.81518,.575762,.813349,.062349,.578387,-0.060976,.817042,-0.573321,.813807,.063845,-0.577593,.814173,.063509,.577074,.813807,-0.063601,-0.577593,.814203,-0.063265,.577074,-0.063234,-0.813837,.577593,-0.063631,-0.814173,-0.577074,.063234,.813837,-0.577593,-0.814203,.063265,-0.577074,-0.813807,.063601,.577593,.063631,.814173,.577074,.060366,.816736,-0.573809,.811396,-0.060274,-0.581347,-0.0665,-0.811274,-0.580828,-0.816614,.06653,-0.57329,-0.060366,-0.816736,.573809,-0.811396,.060274,.581347,.816614,-0.06653,.57329,.0665,.811274,.580828,.833735,-0.0524,-0.549638,.801202,-0.07767,.59331,-0.080325,-0.823023,.562243,-0.047517,-0.796533,-0.60268,.084719,.828211,-0.553911,-0.795038,.081668,-0.600971,-0.828303,.055025,.557543,.051302,.801904,.595203,.058565,.805872,-0.589129,.810755,-0.074038,-0.580645,-0.060884,-0.821589,-0.566759,-0.813501,.051912,-0.57918,-0.075411,-0.81286,.577532,-0.823664,.074343,.562181,.809564,-0.061068,.583819,.065889,.81283,.578722,.828669,-0.06003,-0.556475,.739616,-0.048463,.671255,-0.060884,-0.860073,.506485,-0.056673,-0.816004,-0.575213,.082522,.81521,-0.573199,-0.804651,.065676,-0.590075,-0.854854,.009064,.518784,-0.017823,.787683,.615802,.092807,.830714,-0.548845,.842097,-0.047731,-0.537156,-0.033113,-0.796442,-0.603748,-0.783898,.080752,-0.615589,-0.092807,-0.830714,.548845,-0.842097,.047731,.537156,.783898,-0.080752,.615589,.033143,.796442,.603748,.814722,-0.064821,-0.576159,.813288,-0.062014,.578478,-0.064333,-0.812769,.578997,-0.062532,-0.815271,-0.575671,.064302,.812769,-0.578997,-0.813288,.062014,-0.578509,-0.814722,.064821,.576159,.062532,.815271,.575671,.067049,.814722,-0.575915,.82226,-0.070437,-0.564684,-0.060732,-0.812616,-0.579577,-0.805994,.05829,-0.589007,-0.057985,-0.804712,.590777,-0.810389,.075594,.58095,.817377,-0.050356,.57384,.068087,.823664,.562975,.821406,-0.069308,-0.566057,.818232,-0.051515,.572558,-0.056978,-0.80575,.589465,-0.061769,-0.811609,-0.580889,.066073,.81576,-0.574572,-0.806848,.059481,-0.587725,-0.809534,.074435,.582293,.069063,.822657,.564287,.063295,.813776,-0.577685,.813868,-0.063662,-0.577502,-0.06354,-0.814264,-0.576983,-0.814142,.063173,-0.577166,-0.063295,-0.813776,.577685,-0.813868,.063662,.577502,.814142,-0.063173,.577166,.06354,.814264,.576983,.841334,-0.046663,-0.538469,.784814,-0.081973,.614277,-0.091861,-0.83169,.547563,-0.034181,-0.795373,-0.605121,.091861,.83169,-0.547563,-0.784814,.081973,-0.614277,-0.841334,.046663,.538469,.034181,.795373,.605121,.081484,.816218,-0.571917,.827876,-0.058901,-0.557787,-0.057649,-0.814997,-0.576556,-0.805506,.066866,-0.588763,-0.059999,-0.860958,.505081,-0.85406,.008087,.520096,.740623,-0.049776,.670034,-0.016663,.786615,.617176,.8099,-0.072878,-0.581988,.810389,-0.062227,.582537,-0.074404,-0.813868,.57622,-0.061892,-0.820582,-0.568102,.057558,.80694,-0.587817,-0.814356,.053072,-0.577899,-0.82281,.073214,.563524,.066897,.811823,.580035,.083743,.829188,-0.552629,.832911,-0.051302,-0.550981,-0.048555,-0.795465,-0.603992,-0.795923,.082888,-0.599628,-0.079318,-0.824,.560961,-0.827509,.053896,.558855,.802057,-0.07886,.591968,.052339,.800867,.596545,.810541,-0.059114,-0.582659,.817438,-0.06769,.571978,-0.059358,-0.817743,.572497,-0.067537,-0.810266,-0.582141,.059358,.817743,-0.572497,-0.817438,.06769,-0.571978,-0.810541,.059114,.582659,.067537,.810266,.582141,.062227,.814875,-0.576281,.812983,-0.062441,-0.578906,-0.064638,-0.813166,-0.578387,-0.815058,.064425,-0.575762,-0.062227,-0.814875,.576281,-0.812983,.062441,.578906,.815058,-0.064425,.575762,.064638,.813166,.578387,.810755,-0.074007,-0.580615,.809534,-0.061068,.583819,.058565,.805902,-0.589129,-0.823664,.074313,.562151,.816614,-0.066561,.57329,.577074,-0.577319,-0.577593,.577593,-0.577349,.577074,-0.577074,-0.577349,.577593,-0.577593,-0.577349,-0.577074,.577074,.577319,-0.577593,-0.577593,.577349,-0.577074,-0.577074,.577349,.577593,.577593,.577349,.577074,.577074,.580859,-0.574053,.577074,-0.573809,-0.581103,-0.577593,-0.573809,-0.580584,-0.577593,.580859,-0.573534,-0.577074,-0.580859,.574053,-0.577074,.573809,.581103,.577593,-0.580859,.573534,.577593,.573809,.580584,.599628,-0.5815,-0.54976,.558519,-0.579852,.593127,-0.595752,-0.573382,.562365,-0.55385,-0.57445,-0.602649,.602619,.574541,-0.553819,-0.551103,.578814,-0.601032,-0.593951,.580065,.557421,.560076,.576006,.595386,.568011,.574969,-0.588855,.568316,-0.582659,-0.58092,-0.580798,-0.583911,-0.567156,-0.584002,.569079,-0.578845,-0.585559,-0.569231,.577136,-0.577715,.591266,.562639,.57503,-0.57326,.583667,.578845,.574267,.578906,.591968,-0.582812,-0.556627,.52971,-0.518662,.671072,-0.604236,-0.616077,.505295,-0.573626,-0.582476,-0.575854,.591693,.567125,-0.572893,-0.568224,.573992,-0.589587,-0.644215,.561235,.519547,.499893,.608417,.616352,.610004,.571795,-0.54854,.609394,-0.582842,-0.537492,-0.543352,-0.582842,-0.604175,-0.542741,.571764,-0.615192,-0.610034,-0.571795,.54854,-0.609394,.582842,.537492,.542711,-0.571795,.615192,.543352,.582842,.604175,.577074,-0.578661,-0.57625,.577593,-0.576006,.578417,-0.577074,-0.576006,.578906,-0.577593,-0.578661,-0.575762,.577074,.576006,-0.578906,-0.577593,.576006,-0.578417,-0.577074,.578661,.57625,.577593,.578661,.575762,.580218,.576281,-0.575488,.579394,-0.587237,-0.565142,-0.574908,-0.577319,-0.579791,-0.574053,.568957,-0.588794,-0.566759,-0.574541,.590442,-0.567095,.583483,.581286,.587939,-0.57036,.573534,.587573,.580889,.56328,.579394,-0.586047,-0.566424,.587939,-0.571581,.572314,-0.566759,-0.575823,.589221,-0.574908,-0.576067,-0.581011,.580218,.577532,-0.574236,-0.574053,.570208,-0.587573,-0.567095,.582232,.582537,.587573,.579669,.564531,.577074,.577258,-0.577685,.577074,-0.57741,-0.577502,-0.577593,-0.57741,-0.576983,-0.577593,.577258,-0.577166,-0.577074,-0.577258,.577685,-0.577074,.577441,.577502,.577593,-0.577258,.577166,.577593,.57741,.576983,.609394,-0.581683,-0.538743,.542711,-0.573107,.613971,-0.610034,-0.572954,.547288,-0.543352,-0.58153,-0.605426,.610034,.572954,-0.547288,-0.542711,.573107,-0.613971,-0.609394,.581683,.538743,.543352,.58153,.605426,.591693,.568346,-0.571673,.591968,-0.581622,-0.557878,-0.573656,-0.581256,-0.577074,-0.568224,.575274,-0.588336,-0.604236,-0.617145,.503983,-0.644215,.560137,.520737,.52971,-0.520096,.669973,.499893,.607105,.617634,.568316,-0.581408,-0.582171,.57503,-0.574511,.582415,-0.585559,-0.570452,.575915,-0.580798,-0.58269,-0.568407,.568011,.57622,-0.587603,-0.584002,.570299,-0.577624,-0.577715,.590075,.563921,.578845,.573016,.580126,.602619,.575732,-0.552568,.599628,-0.58034,-0.551012,-0.55385,-0.573168,-0.60387,-0.551103,.580096,-0.59978,-0.595752,-0.574572,.561144,-0.593951,.578875,.558641,.558489,-0.581133,.591876,.560076,.574725,.596606,.577074,-0.572558,-0.582324,.577593,-0.58208,.572283,-0.577074,-0.58208,.572802,-0.577593,-0.572558,-0.581835,.577074,.58208,-0.572802,-0.577593,.58208,-0.572283,-0.577074,.572558,.582324,.577593,.572558,.581835,.577074,.57857,-0.576342,.577074,-0.576098,-0.578814,-0.577593,-0.576098,-0.578326,-0.577593,.57857,-0.575823,-0.577074,-0.57857,.576342,-0.577074,.576098,.578814,.577593,-0.57857,.575854,.577593,.576098,.578326,-0.577563,-0.577349,-0.577136,.577136,-0.577349,-0.577563,-0.727256,.236183,-0.644429,-0.580889,-0.573962,-0.577166,-0.726768,.236183,.644978,.573931,-0.580554,-0.577502,-0.549974,-0.581469,-0.599506,.562273,-0.573321,.595904,-0.567888,-0.583544,.580462,-0.549364,-0.588549,-0.593097,.674551,-0.515091,-0.528794,.510636,-0.612964,.602893,-0.567217,-0.589648,.574938,-0.713553,.232978,-0.660695,-0.745506,.231025,.625111,.195105,.72396,.661641,.296365,.871334,-0.391034,-0.694235,.214362,-0.687063,-0.534776,-0.585009,-0.609699,-0.601581,-0.585009,.543901,-0.768883,.214362,.602344,.550005,-0.570482,.609882,.205451,.805628,.555589,.616718,-0.570482,-0.542344,.268197,.805628,-0.528184,-0.574602,-0.580004,-0.57738,.579455,-0.575152,-0.57738,.579882,-0.575152,.576952,-0.574175,-0.580004,.577807,-0.726341,.256386,-0.637715,-0.725852,.256386,.638234,.28019,.79049,.544572,.279794,.79049,-0.544786,.588641,-0.576342,.566851,-0.282815,.789636,-0.54445,-0.282418,.789636,.544694,-0.558946,-0.580706,-0.591845,-0.568865,-0.582446,.580615,-0.302438,.791253,.531419,.747276,.259102,-0.611866,-0.583605,-0.571429,-0.576891,.570055,-0.583941,-0.577929,.570482,-0.583941,.577502,-0.583178,-0.571429,.577319,-0.23838,.805353,-0.54268,-0.237983,.805383,.542863,.732566,.215369,.64568,.732078,.215369,-0.646229,-0.575976,.578845,-0.577166,-0.579119,-0.575823,-0.577074,-0.578692,-0.575823,.577502,-0.575549,.578845,.577593,.575976,-0.578845,.577166,.579119,.575823,.577074,.575549,-0.578845,-0.577593,.578692,.575823,-0.577502,.577349,-0.577349,-0.577349,.577349,-0.577349,.577349,-0.577349,-0.577349,.577349,-0.577349,-0.577349,-0.577349,.577349,.577319,-0.577349,-0.577319,.577349,-0.577349,-0.577319,.577349,.577349,.577349,.577319,.577349,.577349,.580859,-0.573809,.577349,-0.573809,-0.580859,-0.577349,-0.573809,-0.580859,-0.577349,.580859,-0.573809,-0.577349,-0.580859,.573809,-0.577349,.573809,.580859,.577349,-0.580859,.573809,.577349,.573809,.580859,.599872,-0.5815,-0.549516,.558245,-0.579852,.593371,-0.595996,-0.573382,.56212,-0.553606,-0.57445,-0.602893,.602863,.574572,-0.553545,-0.550829,.578814,-0.601276,-0.594195,.580065,.557146,.559801,.576006,.59563,.568255,.574969,-0.58861,.56859,-0.582659,-0.580676,-0.580523,-0.583911,-0.567431,-0.583728,.569079,-0.579089,-0.585803,-0.569231,.576861,-0.57799,.591266,.562395,.574786,-0.57326,.583911,.57857,.574267,.57915,.592212,-0.582812,-0.556352,.529405,-0.518662,.671316,-0.60445,-0.616077,.50502,-0.573382,-0.582476,-0.576098,.591968,.567125,-0.572649,-0.567949,.573992,-0.589831,-0.644459,.561235,.519272,.499619,.608417,.616565,.610279,.571795,-0.548265,.609607,-0.582842,-0.537217,-0.543107,-0.582842,-0.604389,-0.542436,.571795,-0.615436,-0.610279,-0.571795,.548265,-0.609607,.582842,.537217,.542436,-0.571795,.615436,.543107,.582842,.604389,.577349,-0.578661,-0.576006,.577319,-0.576006,.578661,-0.577349,-0.576006,.578661,-0.577349,-0.578661,-0.576006,.577349,.576006,-0.578661,-0.577349,.576006,-0.578661,-0.577349,.578661,.576006,.577349,.578661,.576006,.580462,.576281,-0.575243,.579638,-0.587237,-0.564898,-0.574664,-0.577319,-0.580035,-0.573809,.568957,-0.589068,-0.567003,-0.574541,.590197,-0.567339,.583483,.581042,.587695,-0.57036,.573809,.587329,.580889,.563555,.579638,-0.586047,-0.566149,.587695,-0.571581,.572588,-0.567003,-0.575823,.588977,-0.574664,-0.576067,-0.581256,.580462,.577532,-0.573992,-0.573809,.570208,-0.587848,-0.567339,.582232,.582293,.587298,.579669,.564806,.577349,.577258,-0.57741,.577349,-0.57741,-0.577258,-0.577349,-0.57741,-0.577258,-0.577349,.577258,-0.57741,-0.577349,-0.577258,.57741,-0.577349,.57741,.577258,.577319,-0.577258,.57741,.577349,.57741,.577258,.609607,-0.581683,-0.538469,.542436,-0.573107,.614215,-0.610279,-0.572954,.547044,-0.543107,-0.58153,-0.60564,.610279,.572954,-0.547044,-0.542436,.573107,-0.614215,-0.609638,.581683,.538469,.543077,.58153,.60564,.591968,.568346,-0.571429,.592212,-0.581622,-0.557604,-0.573382,-0.581256,-0.577349,-0.567949,.575274,-0.58861,-0.60445,-0.617145,.503708,-0.644459,.560137,.520463,.529405,-0.520096,.670186,.499619,.607105,.617878,.56859,-0.581408,-0.581927,.574786,-0.574511,.58269,-0.585803,-0.570452,.57564,-0.580523,-0.58269,-0.568682,.568255,.57622,-0.587359,-0.583728,.570299,-0.577868,-0.57799,.590075,.563677,.57857,.573016,.58037,.602863,.575732,-0.552293,.599872,-0.58034,-0.550768,-0.553606,-0.573168,-0.604114,-0.550829,.580096,-0.600024,-0.595996,-0.574572,.560869,-0.594195,.578875,.558397,.558245,-0.581133,.59212,.559801,.574725,.596851,.577349,-0.572558,-0.58208,.577349,-0.58208,.572558,-0.577349,-0.58208,.572558,-0.577349,-0.572558,-0.58208,.577349,.58208,-0.572558,-0.577349,.58208,-0.572558,-0.577349,.572558,.58208,.577349,.572558,.58208,.577349,.57857,-0.576098,.577349,-0.576098,-0.57857,-0.577349,-0.576098,-0.57857,-0.577349,.57857,-0.576098,-0.577349,-0.57857,.576098,-0.577349,.576098,.57857,.577319,-0.57857,.576098,.577319,.576098,.57857],colors:[],uvs:[],faces:[35,0,1,2,3,0,0,1,2,3,35,4,7,6,5,0,4,5,6,7,35,0,4,5,1,0,0,4,7,1,35,1,5,6,2,0,1,7,6,2,35,2,6,7,3,0,2,6,5,3,35,4,0,3,7,0,4,0,3,5,35,11,15,12,8,0,8,9,10,11,35,13,9,8,12,0,12,13,11,10,35,14,10,9,13,0,14,15,13,12,35,15,11,10,14,0,9,8,15,14,35,11,8,9,10,0,8,11,13,15,35,15,14,13,12,0,9,14,12,10,35,16,17,18,19,0,16,17,18,19,35,20,23,22,21,0,20,21,22,23,35,16,20,21,17,0,16,20,23,17,35,17,21,22,18,0,17,23,22,18,35,18,22,23,19,0,18,22,21,19,35,20,16,19,23,0,20,16,19,21,35,27,31,28,24,0,24,25,26,27,35,29,25,24,28,0,28,29,27,26,35,30,26,25,29,0,30,31,29,28,35,31,27,26,30,0,25,24,31,30,35,27,24,25,26,0,24,27,29,31,35,31,30,29,28,0,25,30,28,26,35,32,33,34,35,0,32,33,34,35,35,36,39,38,37,0,36,37,38,39,35,32,36,37,33,0,32,36,39,33,35,33,37,38,34,0,33,39,38,34,35,34,38,39,35,0,34,38,37,35,35,36,32,35,39,0,36,32,35,37,35,43,47,44,40,0,40,41,42,43,35,45,41,40,44,0,44,45,43,42,35,46,42,41,45,0,46,47,45,44,35,47,43,42,46,0,41,40,47,46,35,43,40,41,42,0,40,43,45,47,35,47,46,45,44,0,41,46,44,42,35,48,49,50,51,0,48,49,50,51,35,52,55,54,53,0,52,53,54,55,35,48,52,53,49,0,48,52,55,49,35,49,53,54,50,0,49,55,54,50,35,50,54,55,51,0,50,54,53,51,35,52,48,51,55,0,52,48,51,53,35,59,63,60,56,0,56,57,58,59,35,61,57,56,60,0,60,61,59,58,35,62,58,57,61,0,62,63,61,60,35,63,59,58,62,0,57,56,63,62,35,59,56,57,58,0,56,59,61,63,35,63,62,61,60,0,57,62,60,58,35,64,65,66,67,0,64,65,66,67,35,68,71,70,69,0,68,69,70,71,35,64,68,69,65,0,64,68,71,65,35,65,69,70,66,0,65,71,70,66,35,66,70,71,67,0,66,70,69,67,35,68,64,67,71,0,68,64,67,69,35,75,79,76,72,0,72,73,74,75,35,77,73,72,76,0,76,77,75,74,35,78,74,73,77,0,78,79,77,76,35,79,75,74,78,0,73,72,79,78,35,75,72,73,74,0,72,75,77,79,35,79,78,77,76,0,73,78,76,74,35,80,81,82,83,0,80,81,82,83,35,84,87,86,85,0,84,85,86,87,35,80,84,85,81,0,80,84,87,81,35,81,85,86,82,0,81,87,86,82,35,82,86,87,83,0,82,86,85,83,35,84,80,83,87,0,84,80,83,85,35,91,95,92,88,0,88,89,90,91,35,93,89,88,92,0,92,93,91,90,35,94,90,89,93,0,94,95,93,92,35,95,91,90,94,0,89,88,95,94,35,91,88,89,90,0,88,91,93,95,35,95,94,93,92,0,89,94,92,90,35,96,97,98,99,0,96,97,98,99,35,100,103,102,101,0,100,101,102,103,35,96,100,101,97,0,96,100,103,97,35,97,101,102,98,0,97,103,102,98,35,98,102,103,99,0,98,102,101,99,35,100,96,99,103,0,100,96,99,101,35,107,111,108,104,0,104,105,106,107,35,109,105,104,108,0,108,109,107,106,35,110,106,105,109,0,110,111,109,108,35,111,107,106,110,0,105,104,111,110,35,107,104,105,106,0,104,107,109,111,35,111,110,109,108,0,105,110,108,106,35,112,113,114,115,0,112,113,114,115,35,116,119,118,117,0,116,117,118,119,35,112,116,117,113,0,112,116,119,113,35,113,117,118,114,0,113,119,118,114,35,114,118,119,115,0,114,118,117,115,35,116,112,115,119,0,116,112,115,117,35,123,127,124,120,0,120,121,122,123,35,125,121,120,124,0,124,125,123,122,35,126,122,121,125,0,126,127,125,124,35,127,123,122,126,0,121,120,127,126,35,123,120,121,122,0,120,123,125,127,35,127,126,125,124,0,121,126,124,122,35,128,129,130,131,0,128,129,130,131,35,132,135,134,133,0,132,133,134,135,35,128,132,133,129,0,128,132,135,129,35,129,133,134,130,0,129,135,134,130,35,130,134,135,131,0,130,134,133,131,35,132,128,131,135,0,132,128,131,133,35,139,143,140,136,0,136,137,138,139,35,141,137,136,140,0,140,141,139,138,35,142,138,137,141,0,142,143,141,140,35,143,139,138,142,0,137,136,143,142,35,139,136,137,138,0,136,139,141,143,35,143,142,141,140,0,137,142,140,138,35,144,145,146,147,0,144,145,146,147,35,148,151,150,149,0,148,149,150,151,35,144,148,149,145,0,144,148,151,145,35,145,149,150,146,0,145,151,150,146,35,146,150,151,147,0,146,150,149,147,35,148,144,147,151,0,148,144,147,149,35,155,159,156,152,0,152,153,154,155,35,157,153,152,156,0,156,157,155,154,35,158,154,153,157,0,158,159,157,156,35,159,155,154,158,0,153,152,159,158,35,155,152,153,154,0,152,155,157,159,35,159,158,157,156,0,153,158,156,154,35,160,161,162,163,0,160,161,162,163,35,164,167,166,165,0,164,165,166,167,35,160,164,165,161,0,160,164,167,161,35,161,165,166,162,0,161,167,166,162,35,162,166,167,163,0,162,166,165,163,35,164,160,163,167,0,164,160,163,165,35,171,175,172,168,0,168,169,170,171,35,173,169,168,172,0,172,173,171,170,35,174,170,169,173,0,174,175,173,172,35,175,171,170,174,0,169,168,175,174,35,171,168,169,170,0,168,171,173,175,35,175,174,173,172,0,169,174,172,170,35,176,177,178,179,0,176,177,178,179,35,180,183,182,181,0,180,181,182,183,35,176,180,181,177,0,176,180,183,177,35,177,181,182,178,0,177,183,182,178,35,178,182,183,179,0,178,182,181,179,35,180,176,179,183,0,180,176,179,181,35,187,191,188,184,0,184,185,186,187,35,189,185,184,188,0,188,189,187,186,35,190,186,185,189,0,190,191,189,188,35,191,187,186,190,0,185,184,191,190,35,187,184,185,186,0,184,187,189,191,35,191,190,189,188,0,185,190,188,186,35,192,193,194,195,0,192,193,194,195,35,196,199,198,197,0,196,197,198,199,35,192,196,197,193,0,192,196,199,193,35,193,197,198,194,0,193,199,198,194,35,194,198,199,195,0,194,198,197,195,35,196,192,195,199,0,196,192,195,197,35,203,207,204,200,0,200,201,202,203,35,205,201,200,204,0,204,205,203,202,35,206,202,201,205,0,206,207,205,204,35,207,203,202,206,0,201,200,207,206,35,203,200,201,202,0,200,203,205,207,35,207,206,205,204,0,201,206,204,202,35,208,209,210,211,0,208,209,210,211,35,212,215,214,213,0,212,213,214,215,35,208,212,213,209,0,208,212,215,209,35,209,213,214,210,0,209,215,214,210,35,210,214,215,211,0,210,214,213,211,35,212,208,211,215,0,212,208,211,213,35,219,223,220,216,0,216,217,218,219,35,221,217,216,220,0,220,221,219,218,35,222,218,217,221,0,222,223,221,220,35,223,219,218,222,0,217,216,223,222,35,219,216,217,218,0,216,219,221,223,35,223,222,221,220,0,217,222,220,218,35,224,225,226,227,0,224,225,226,227,35,228,231,230,229,0,228,229,230,231,35,224,228,229,225,0,224,228,231,225,35,225,229,230,226,0,225,231,230,226,35,226,230,231,227,0,226,230,229,227,35,228,224,227,231,0,228,224,227,229,35,235,239,236,232,0,232,233,234,235,35,237,233,232,236,0,236,237,235,234,35,238,234,233,237,0,238,239,237,236,35,239,235,234,238,0,233,232,239,238,35,235,232,233,234,0,232,235,237,239,35,239,238,237,236,0,233,238,236,234,35,240,241,242,243,0,240,241,242,243,35,244,247,246,245,0,244,245,246,247,35,240,244,245,241,0,240,244,247,241,35,241,245,246,242,0,241,247,246,242,35,242,246,247,243,0,242,246,245,243,35,244,240,243,247,0,244,240,243,245,35,251,255,252,248,0,248,249,250,251,35,253,249,248,252,0,252,253,251,250,35,254,250,249,253,0,254,255,253,252,35,255,251,250,254,0,249,248,255,254,35,251,248,249,250,0,248,251,253,255,35,255,254,253,252,0,249,254,252,250,35,256,257,258,259,0,153,158,156,154,35,260,263,262,261,0,152,155,157,159,35,256,260,261,257,0,153,152,159,158,35,257,261,262,258,0,158,159,157,156,35,258,262,263,259,0,156,157,155,154,35,260,256,259,263,0,152,153,154,155,35,264,265,266,267,0,137,142,140,138,35,268,271,270,269,0,136,256,141,143,35,264,268,269,265,0,137,136,143,142,35,265,269,270,266,0,142,143,141,140,35,266,270,271,267,0,140,141,256,138,35,268,264,267,271,0,136,137,138,256,35,275,279,276,272,0,257,128,131,133,35,277,273,272,276,0,130,134,133,131,35,278,274,273,277,0,129,258,134,130,35,279,275,274,278,0,128,257,258,129,35,275,272,273,274,0,257,133,134,258,35,279,278,277,276,0,128,129,130,131,35,280,281,282,283,0,259,260,261,262,35,284,287,286,285,0,263,264,265,266,35,280,284,285,281,0,259,263,266,260,35,281,285,286,282,0,260,266,265,261,35,282,286,287,283,0,261,265,264,262,35,284,280,283,287,0,263,259,262,264,35,291,295,292,288,0,267,268,269,270,35,293,289,288,292,0,271,272,270,269,35,294,290,289,293,0,273,274,272,271,35,295,291,290,294,0,268,267,274,273,35,291,288,289,290,0,267,270,272,274,35,295,294,293,292,0,268,273,271,269,35,296,297,298,299,0,275,276,277,278,35,300,303,302,301,0,279,280,281,282,35,296,300,301,297,0,275,279,282,276,35,297,301,302,298,0,276,282,281,277,35,298,302,303,299,0,277,281,280,278,35,300,296,299,303,0,279,275,278,280,35,307,311,308,304,0,283,284,285,286,35,309,305,304,308,0,287,288,286,285,35,310,306,305,309,0,289,290,288,287,35,311,307,306,310,0,284,283,290,289,35,307,304,305,306,0,283,286,288,290,35,311,310,309,308,0,284,289,287,285,35,312,313,314,315,0,291,292,293,294,35,316,319,318,317,0,295,296,297,298,35,312,316,317,313,0,291,295,298,292,35,313,317,318,314,0,292,298,297,293,35,314,318,319,315,0,293,297,296,294,35,316,312,315,319,0,295,291,294,296,35,323,327,324,320,0,299,300,301,302,35,325,321,320,324,0,303,304,302,301,35,326,322,321,325,0,305,306,304,303,35,327,323,322,326,0,300,299,306,305,35,323,320,321,322,0,299,302,304,306,35,327,326,325,324,0,300,305,303,301,35,328,329,330,331,0,307,308,309,310,35,332,335,334,333,0,311,312,313,314,35,328,332,333,329,0,307,311,314,308,35,329,333,334,330,0,308,314,313,309,35,330,334,335,331,0,309,313,312,310,35,332,328,331,335,0,311,307,310,312,35,339,343,340,336,0,315,316,317,318,35,341,337,336,340,0,319,320,318,317,35,342,338,337,341,0,321,322,320,319,35,343,339,338,342,0,316,315,322,321,35,339,336,337,338,0,315,318,320,322,35,343,342,341,340,0,316,321,319,317,35,344,345,346,347,0,323,324,325,326,35,348,351,350,349,0,327,328,329,330,35,344,348,349,345,0,323,327,330,324,35,345,349,350,346,0,324,330,329,325,35,346,350,351,347,0,325,329,328,326,35,348,344,347,351,0,327,323,326,328,35,355,359,356,352,0,331,332,333,334,35,357,353,352,356,0,335,336,334,333,35,358,354,353,357,0,337,338,336,335,35,359,355,354,358,0,332,331,338,337,35,355,352,353,354,0,331,334,336,338,35,359,358,357,356,0,332,337,335,333,35,360,361,362,363,0,339,340,341,342,35,364,367,366,365,0,343,344,345,346,35,360,364,365,361,0,339,343,346,340,35,361,365,366,362,0,340,346,345,341,35,362,366,367,363,0,341,345,344,342,35,364,360,363,367,0,343,339,342,344,35,371,375,372,368,0,347,348,349,350,35,373,369,368,372,0,351,352,350,349,35,374,370,369,373,0,353,354,352,351,35,375,371,370,374,0,348,347,354,353,35,371,368,369,370,0,347,350,352,354,35,375,374,373,372,0,348,353,351,349,35,376,377,378,379,0,355,356,357,358,35,380,383,382,381,0,359,360,361,362,35,376,380,381,377,0,355,359,362,356,35,377,381,382,378,0,356,362,361,357,35,378,382,383,379,0,357,361,360,358,35,380,376,379,383,0,359,355,358,360,35,387,391,388,384,0,363,364,365,366,35,389,385,384,388,0,367,368,366,365,35,390,386,385,389,0,369,370,368,367,35,391,387,386,390,0,364,363,370,369,35,387,384,385,386,0,363,366,368,370,35,391,390,389,388,0,364,369,367,365,35,392,393,394,395,0,371,372,373,374,35,396,399,398,397,0,375,376,377,378,35,392,396,397,393,0,371,375,378,372,35,393,397,398,394,0,372,378,377,373,35,394,398,399,395,0,373,377,376,374,35,396,392,395,399,0,375,371,374,376,35,403,407,404,400,0,379,380,381,382,35,405,401,400,404,0,383,384,382,381,35,406,402,401,405,0,385,386,384,383,35,407,403,402,406,0,380,379,386,385,35,403,400,401,402,0,379,382,384,386,35,407,406,405,404,0,380,385,383,381,35,408,409,410,411,0,387,388,287,285,35,412,415,414,413,0,389,286,390,290,35,408,412,413,409,0,387,389,290,388,35,409,413,414,410,0,388,290,390,287,35,410,414,415,411,0,287,390,286,285,35,412,408,411,415,0,389,387,285,286,35,416,417,418,419,0,268,391,271,269,35,420,423,422,421,0,267,270,272,274,35,416,420,421,417,0,268,267,274,391,35,417,421,422,418,0,391,274,272,271,35,418,422,423,419,0,271,272,270,269,35,420,416,419,423,0,267,268,269,270,35,427,431,428,424,0,263,259,262,264,35,429,425,424,428,0,261,265,264,262,35,430,426,425,429,0,260,266,265,261,35,431,427,426,430,0,259,263,266,260,35,427,424,425,426,0,263,264,265,266,35,431,430,429,428,0,259,260,261,262,35,432,433,434,435,0,392,393,394,395,35,436,439,438,437,0,396,397,398,399,35,432,436,437,433,0,392,396,399,393,35,433,437,438,434,0,393,399,398,394,35,434,438,439,435,0,394,398,397,395,35,436,432,435,439,0,396,392,395,397,35,443,447,444,440,0,400,401,402,403,35,445,441,440,444,0,404,405,403,402,35,446,442,441,445,0,406,407,405,404,35,447,443,442,446,0,401,400,407,406,35,443,440,441,442,0,400,403,405,407,35,447,446,445,444,0,401,406,404,402,35,448,449,450,451,0,408,409,410,411,35,452,455,454,453,0,412,413,414,415,35,448,452,453,449,0,408,412,415,409,35,449,453,454,450,0,409,415,414,410,35,450,454,455,451,0,410,414,413,411,35,452,448,451,455,0,412,408,411,413,35,459,463,460,456,0,416,417,418,419,35,461,457,456,460,0,420,421,419,418,35,462,458,457,461,0,422,423,421,420,35,463,459,458,462,0,417,416,423,422,35,459,456,457,458,0,416,419,421,423,35,463,462,461,460,0,417,422,420,418,35,464,465,466,467,0,424,425,426,427,35,468,471,470,469,0,428,429,430,431,35,464,468,469,465,0,424,428,431,425,35,465,469,470,466,0,425,431,430,426,35,466,470,471,467,0,426,430,429,427,35,468,464,467,471,0,428,424,427,429,35,475,479,476,472,0,432,433,434,435,35,477,473,472,476,0,436,437,435,434,35,478,474,473,477,0,438,439,437,436,35,479,475,474,478,0,433,432,439,438,35,475,472,473,474,0,432,435,437,439,35,479,478,477,476,0,433,438,436,434,35,480,481,482,483,0,440,441,442,443,35,484,487,486,485,0,444,445,446,447,35,480,484,485,481,0,440,444,447,441,35,481,485,486,482,0,441,447,446,442,35,482,486,487,483,0,442,446,445,443,35,484,480,483,487,0,444,440,443,445,35,491,495,492,488,0,448,449,450,451,35,493,489,488,492,0,452,453,451,450,35,494,490,489,493,0,454,455,453,452,35,495,491,490,494,0,449,448,455,454,35,491,488,489,490,0,448,451,453,455,35,495,494,493,492,0,449,454,452,450,35,496,497,498,499,0,456,457,458,459,35,500,503,502,501,0,460,461,462,463,35,496,500,501,497,0,456,460,463,457,35,497,501,502,498,0,457,463,462,458,35,498,502,503,499,0,458,462,461,459,35,500,496,499,503,0,460,456,459,461,35,507,511,508,504,0,464,465,466,467,35,509,505,504,508,0,468,469,467,466,35,510,506,505,509,0,470,471,469,468,35,511,507,506,510,0,465,464,471,470,35,507,504,505,506,0,464,467,469,471,35,511,510,509,508,0,465,470,468,466,35,512,513,514,515,0,472,473,474,475,35,516,519,518,517,0,476,477,478,479,35,512,516,517,513,0,472,476,479,473,35,513,517,518,514,0,473,479,478,474,35,514,518,519,515,0,474,478,477,475,35,516,512,515,519,0,476,472,475,477,35,523,527,524,520,0,480,481,482,483,35,525,521,520,524,0,484,485,483,482,35,526,522,521,525,0,486,487,485,484,35,527,523,522,526,0,481,480,487,486,35,523,520,521,522,0,480,483,485,487,35,527,526,525,524,0,481,486,484,482,35,528,529,530,531,0,488,489,490,491,35,532,535,534,533,0,492,493,494,495,35,528,532,533,529,0,488,492,495,489,35,529,533,534,530,0,489,495,494,490,35,530,534,535,531,0,490,494,493,491,35,532,528,531,535,0,492,488,491,493,35,539,543,540,536,0,496,497,498,499,35,541,537,536,540,0,500,501,499,498,35,542,538,537,541,0,502,503,501,500,35,543,539,538,542,0,497,496,503,502,35,539,536,537,538,0,496,499,501,503,35,543,542,541,540,0,497,502,500,498,35,544,545,546,547,0,504,505,506,507,35,548,551,550,549,0,508,509,510,511,35,544,548,549,545,0,504,508,511,505,35,545,549,550,546,0,505,511,510,506,35,546,550,551,547,0,506,510,509,507,35,548,544,547,551,0,508,504,507,509,35,555,559,556,552,0,512,513,514,515,35,557,553,552,556,0,516,517,515,514,35,558,554,553,557,0,518,519,517,516,35,559,555,554,558,0,513,512,519,518,35,555,552,553,554,0,512,515,517,519,35,559,558,557,556,0,513,518,516,514,35,560,561,562,563,0,520,521,2,3,35,564,567,566,565,0,4,5,6,7,35,560,564,565,561,0,520,4,7,521,35,561,565,566,562,0,521,7,6,2,35,562,566,567,563,0,2,6,5,3,35,564,560,563,567,0,4,520,3,5,35,571,575,572,568,0,522,523,10,524,35,573,569,568,572,0,12,13,524,10,35,574,570,569,573,0,525,15,13,12,35,575,571,570,574,0,523,522,15,525,35,571,568,569,570,0,522,524,13,15,35,575,574,573,572,0,523,525,12,10,35,576,577,578,579,0,526,17,527,19,35,580,583,582,581,0,20,21,22,23,35,576,580,581,577,0,526,20,23,17,35,577,581,582,578,0,17,23,22,527,35,578,582,583,579,0,527,22,21,19,35,580,576,579,583,0,20,526,19,21,35,587,591,588,584,0,24,25,528,27,35,589,585,584,588,0,28,29,27,528,35,590,586,585,589,0,30,31,29,28,35,591,587,586,590,0,25,24,31,30,35,587,584,585,586,0,24,27,29,31,35,591,590,589,588,0,25,30,28,528,35,592,593,594,595,0,529,530,531,532,35,596,599,598,597,0,533,534,535,536,35,592,596,597,593,0,529,533,536,530,35,593,597,598,594,0,530,536,535,531,35,594,598,599,595,0,531,535,534,532,35,596,592,595,599,0,533,529,532,534,35,603,607,604,600,0,537,538,539,540,35,605,601,600,604,0,541,542,540,539,35,606,602,601,605,0,543,544,542,541,35,607,603,602,606,0,538,537,544,543,35,603,600,601,602,0,537,540,542,544,35,607,606,605,604,0,538,543,541,539,35,608,609,610,611,0,545,546,547,548,35,612,615,614,613,0,549,550,551,552,35,608,612,613,609,0,545,549,552,546,35,609,613,614,610,0,546,552,551,547,35,610,614,615,611,0,547,551,550,548,35,612,608,611,615,0,549,545,548,550,35,619,623,620,616,0,56,57,58,59,35,621,617,616,620,0,60,61,59,58,35,622,618,617,621,0,62,63,61,60,35,623,619,618,622,0,57,56,63,62,35,619,616,617,618,0,56,59,61,63,35,623,622,621,620,0,57,62,60,58,35,624,625,626,627,0,64,65,553,67,35,628,631,630,629,0,68,69,70,71,35,624,628,629,625,0,64,68,71,65,35,625,629,630,626,0,65,71,70,553,35,626,630,631,627,0,553,70,69,67,35,628,624,627,631,0,68,64,67,69,35,635,639,636,632,0,554,73,74,555,35,637,633,632,636,0,76,77,555,74,35,638,634,633,637,0,78,79,77,76,35,639,635,634,638,0,73,554,79,78,35,635,632,633,634,0,554,555,77,79,35,639,638,637,636,0,73,78,76,74,35,640,641,642,643,0,80,81,82,83,35,644,647,646,645,0,84,85,86,87,35,640,644,645,641,0,80,84,87,81,35,641,645,646,642,0,81,87,86,82,35,642,646,647,643,0,82,86,85,83,35,644,640,643,647,0,84,80,83,85,35,651,655,652,648,0,88,556,90,91,35,653,649,648,652,0,92,93,91,90,35,654,650,649,653,0,94,95,93,92,35,655,651,650,654,0,556,88,95,94,35,651,648,649,650,0,88,91,93,95,35,655,654,653,652,0,556,94,92,90,35,656,657,658,659,0,96,97,98,557,35,660,663,662,661,0,100,101,102,103,35,656,660,661,657,0,96,100,103,97,35,657,661,662,658,0,97,103,102,98,35,658,662,663,659,0,98,102,101,557,35,660,656,659,663,0,100,96,557,101,35,667,671,668,664,0,104,105,106,558,35,669,665,664,668,0,108,109,558,106,35,670,666,665,669,0,110,559,109,108,35,671,667,666,670,0,105,104,559,110,35,667,664,665,666,0,104,558,109,559,35,671,670,669,668,0,105,110,108,106,35,672,673,674,675,0,560,561,562,563,35,676,679,678,677,0,564,565,566,567,35,672,676,677,673,0,560,564,567,561,35,673,677,678,674,0,561,567,566,562,35,674,678,679,675,0,562,566,565,563,35,676,672,675,679,0,564,560,563,565,35,683,687,684,680,0,568,569,570,571,35,685,681,680,684,0,572,573,571,570,35,686,682,681,685,0,574,575,573,572,35,687,683,682,686,0,569,568,575,574,35,683,680,681,682,0,568,571,573,575,35,687,686,685,684,0,569,574,572,570,35,688,689,690,691,0,576,577,578,579,35,692,695,694,693,0,580,581,582,583,35,688,692,693,689,0,576,580,583,577,35,689,693,694,690,0,577,583,582,578,35,690,694,695,691,0,578,582,581,579,35,692,688,691,695,0,580,576,579,581,35,699,703,700,696,0,584,585,586,587,35,701,697,696,700,0,588,589,587,586,35,702,698,697,701,0,590,591,589,588,35,703,699,698,702,0,585,584,591,590,35,699,696,697,698,0,584,587,589,591,35,703,702,701,700,0,585,590,588,586,35,704,705,706,707,0,592,593,594,595,35,708,711,710,709,0,596,597,598,599,35,704,708,709,705,0,592,596,599,593,35,705,709,710,706,0,593,599,598,594,35,706,710,711,707,0,594,598,597,595,35,708,704,707,711,0,596,592,595,597,35,715,719,716,712,0,600,601,602,603,35,717,713,712,716,0,604,605,603,602,35,718,714,713,717,0,606,607,605,604,35,719,715,714,718,0,601,600,607,606,35,715,712,713,714,0,600,603,605,607,35,719,718,717,716,0,601,606,604,602,35,720,721,722,723,0,608,609,610,611,35,724,727,726,725,0,612,613,614,615,35,720,724,725,721,0,608,612,615,609,35,721,725,726,722,0,609,615,614,610,35,722,726,727,723,0,610,614,613,611,35,724,720,723,727,0,612,608,611,613,35,731,735,732,728,0,616,617,618,619,35,733,729,728,732,0,620,621,619,618,35,734,730,729,733,0,622,623,621,620,35,735,731,730,734,0,617,616,623,622,35,731,728,729,730,0,616,619,621,623,35,735,734,733,732,0,617,622,620,618,35,736,737,738,739,0,624,625,626,627,35,740,743,742,741,0,628,629,630,631,35,736,740,741,737,0,624,628,631,625,35,737,741,742,738,0,625,631,630,626,35,738,742,743,739,0,626,630,629,627,35,740,736,739,743,0,628,624,627,629,35,747,751,748,744,0,632,633,634,635,35,749,745,744,748,0,636,637,635,634,35,750,746,745,749,0,638,639,637,636,35,751,747,746,750,0,633,632,639,638,35,747,744,745,746,0,632,635,637,639,35,751,750,749,748,0,633,638,636,634,35,752,753,754,755,0,640,641,642,643,35,756,759,758,757,0,644,645,646,647,35,752,756,757,753,0,640,644,647,641,35,753,757,758,754,0,641,647,646,642,35,754,758,759,755,0,642,646,645,643,35,756,752,755,759,0,644,640,643,645,35,763,767,764,760,0,648,649,650,651,35,765,761,760,764,0,652,653,651,650,35,766,762,761,765,0,654,655,653,652,35,767,763,762,766,0,649,648,655,654,35,763,760,761,762,0,648,651,653,655,35,767,766,765,764,0,649,654,652,650,35,768,769,770,771,0,656,657,658,659,35,772,775,774,773,0,660,661,662,663,35,768,772,773,769,0,656,660,663,657,35,769,773,774,770,0,657,663,662,658,35,770,774,775,771,0,658,662,661,659,35,772,768,771,775,0,660,656,659,661,35,779,783,780,776,0,664,665,666,667,35,781,777,776,780,0,668,669,667,666,35,782,778,777,781,0,670,671,669,668,35,783,779,778,782,0,665,664,671,670,35,779,776,777,778,0,664,667,669,671,35,783,782,781,780,0,665,670,668,666,35,784,785,786,787,0,672,673,674,675,35,788,791,790,789,0,676,677,678,679,35,784,788,789,785,0,672,676,679,673,35,785,789,790,786,0,673,679,678,674,35,786,790,791,787,0,674,678,677,675,35,788,784,787,791,0,676,672,675,677,35,795,799,796,792,0,680,681,682,683,35,797,793,792,796,0,684,685,683,682,35,798,794,793,797,0,686,687,685,684,35,799,795,794,798,0,681,680,687,686,35,795,792,793,794,0,680,683,685,687,35,799,798,797,796,0,681,686,684,682,35,800,801,802,803,0,688,689,690,691,35,804,807,806,805,0,692,693,694,695,35,800,804,805,801,0,688,692,695,689,35,801,805,806,802,0,689,695,694,690,35,802,806,807,803,0,690,694,693,691,35,804,800,803,807,0,692,688,691,693,35,811,815,812,808,0,696,697,698,699,35,813,809,808,812,0,700,701,699,698,35,814,810,809,813,0,702,703,701,700,35,815,811,810,814,0,697,696,703,702,35,811,808,809,810,0,696,699,701,703,35,815,814,813,812,0,697,702,700,698],bones:[],skinIndices:[],skinWeights:[],animation:{}}}),define("json!models/castle.js",function(){return{metadata:{formatVersion:3.1,generatedBy:"Blender 2.66 Exporter",vertices:362,faces:343,normals:339,colors:0,uvs:[],materials:1,morphTargets:0,bones:0},scale:1,materials:[{DbgColor:15658734,DbgIndex:0,DbgName:"Material",blending:"NormalBlending",colorAmbient:[.6400000190734865,.6400000190734865,.6400000190734865],colorDiffuse:[.6400000190734865,.6400000190734865,.6400000190734865],colorSpecular:[.5,.5,.5],depthTest:!0,depthWrite:!0,shading:"Lambert",specularCoef:50,transparency:1,transparent:!1,vertexColors:!1}],vertices:[.0603377,1.3906,.353796,.708622,1.40949,.107957,.951458,1.24079,.735361,.303174,1.2219,.9812,.379319,2.90835,.692543,.684312,2.91724,.576885,.798558,2.83787,.872055,.493565,2.82899,.987713,2.01768,1.51102,-0.635601,2.66699,1.39502,-0.850086,2.8621,1.27623,-0.195191,2.21279,1.39223,.0192946,2.56823,2.99173,-0.479216,2.87371,2.93716,-0.580123,2.9655,2.88127,-0.27202,2.66002,2.93585,-0.171112,2.37173,1.45023,-1.55157,3.00686,1.43266,-1.82973,3.28122,1.3501,-1.19809,2.6461,1.36768,-0.919921,2.70329,2.99865,-1.43946,3.00209,2.99038,-1.57033,3.13117,2.95154,-1.27316,2.83237,2.95981,-1.1423,1.86283,1.3329,-2.25485,1.72087,1.39969,-2.93046,2.39141,1.30548,-3.08067,2.53337,1.23868,-2.40506,2.10594,2.89692,-2.37656,2.03915,2.92834,-2.69441,2.35462,2.88402,-2.76508,2.4214,2.8526,-2.44723,.417342,1.18255,-2.33177,.417342,1.18255,-3.02536,1.11093,1.18255,-3.02536,1.11093,1.18255,-2.33177,.466282,2.75403,-2.55118,.466282,2.75403,-2.87749,.792589,2.75403,-2.87749,.792589,2.75403,-2.55118,.382637,1.29639,-0.238945,.382637,1.29639,-1.79933,1.94302,1.29639,-1.79933,1.94302,1.29639,-0.238945,.831405,2.35994,-0.687713,.831405,2.35994,-1.35056,1.49425,2.35994,-1.35056,1.49425,2.35994,-0.687713,.87432,3.2981,-0.649799,.796011,3.34263,-1.3065,1.45134,3.2861,-1.38848,1.52965,3.24157,-0.731778,.870497,6.51371,-0.502295,.703336,6.61571,-1.34132,1.53733,6.49679,-1.52193,1.70449,6.39479,-0.682911,.938583,7.11708,-0.472644,.827715,7.16286,-1.32583,1.68142,7.20369,-1.43457,1.79229,7.15791,-0.58139,.883149,7.13997,-0.899235,1.25457,7.18327,-1.3802,1.73686,7.1808,-1.00798,1.36544,7.13749,-0.527017,1.31,7.16038,-0.953608,1.69265,7.74249,-1.34255,1.40137,7.72856,-1.30545,1.73047,7.72687,-1.05146,1.4392,7.71294,-1.01436,.797161,7.71314,-1.32319,.841809,7.6947,-0.979595,1.14096,7.72958,-1.36698,1.18561,7.71115,-1.02339,1.9092,7.56116,-0.565633,1.81383,7.60239,-0.879721,1.59746,7.60723,-0.464922,1.50209,7.64847,-0.77901,.949507,7.54818,-0.295626,.837768,7.66711,-0.621962,1.2968,7.59128,-0.398836,1.18506,7.7102,-0.725172,2.04659,1.17581,.623224,2.04659,1.17581,1.11518,1.3302,1.17581,1.11518,1.3302,1.17581,.623224,1.85781,3.17581,.732023,1.85781,3.17581,.960021,1.51897,3.17581,.960021,1.51897,3.17581,.732023,-1.60217,1.3598,-1.6035,-1.07378,1.3598,-1.40689,-1.32361,1.3598,-0.735477,-1.852,1.3598,-0.93209,-1.56603,3.3598,-1.38864,-1.28503,3.3598,-1.28408,-1.4032,3.3598,-0.966509,-1.6842,3.35981,-1.07107,-1.59739,-0.563372,2.17721,-3.06333,-0.563373,-0.93353,4.39939,-0.563372,-0.93353,2.93346,-0.563372,2.17721,-1.04202,1.43663,1.19543,-1.98452,1.43663,-1.27202,3.32059,1.43663,-1.27202,2.37809,1.43663,1.19543,-1.59493,-0.563372,-4.38067,2.931,-0.563372,-4.38067,-1.04044,1.43663,-3.0604,2.37651,1.43663,-3.0604,.856211,3.45363,.107452,1.04464,3.45912,.0359958,1.11523,3.41009,.218359,.926795,3.4046,.289815,2.20858,3.94407,-0.61649,2.39731,3.91035,-0.678833,2.45402,3.87582,-0.488479,2.26529,3.90954,-0.426136,2.29202,3.50942,-1.20975,2.47663,3.50431,-1.29061,2.55637,3.48031,-1.10701,2.37177,3.48542,-1.02616,1.92296,3.58356,-1.78871,1.8817,3.60297,-1.98509,2.0766,3.57559,-2.02875,2.11786,3.55617,-1.83238,.909938,3.76628,-1.8966,.909938,3.76628,-2.0982,1.11154,3.76628,-2.0982,1.11154,3.76628,-1.8966,1.76966,3.61887,.131844,1.76966,3.61887,.272706,1.56032,3.61887,.272707,1.56032,3.61887,.131843,-0.873258,4.02387,-1.17835,-0.699648,4.02387,-1.11375,-0.772655,4.02387,-0.917551,-0.946264,4.02387,-0.982151,1.51542,8.20013,-1.3833,1.37532,8.19343,-1.36545,1.53362,8.19262,-1.24329,1.39352,8.18592,-1.22544,.60934,8.18602,-1.02647,.630815,8.17715,-0.861207,.774704,8.19392,-1.04753,.79618,8.18506,-0.882271,2.08892,8.11291,-0.662097,2.04305,8.13275,-0.81317,1.93898,8.13508,-0.613657,1.8931,8.15491,-0.764729,1.15798,8.10667,.0450904,1.10424,8.16387,-0.111873,1.32503,8.1274,-0.00455248,1.27128,8.1846,-0.161516,.949969,3.49399,-1.31427,1.31617,3.4624,-1.36008,.977601,3.91877,-1.27224,1.33615,3.86765,-1.34989,.963331,3.48803,-1.23184,1.32954,3.45644,-1.27765,.990963,3.91282,-1.18981,1.34952,3.86169,-1.26746,1.47874,3.41676,-1.2567,1.52622,3.38977,-0.858577,1.50042,3.85641,-1.24564,1.57838,3.80884,-0.854306,1.33837,3.42842,-1.23329,1.38585,3.40142,-0.835172,1.36005,3.86806,-1.22223,1.43801,3.82049,-0.8309,1.01417,3.42,-0.65848,1.42452,3.3846,-0.709813,1.07663,3.87474,-0.61839,1.4784,3.81745,-0.705401,.976076,3.43677,-0.893346,1.38643,3.40137,-0.944679,1.03853,3.89151,-0.853256,1.44031,3.83422,-0.940267,.87368,3.43392,-0.751027,.822376,3.4631,-1.18126,.939026,3.9097,-0.709083,.854771,3.96111,-1.13198,1.01845,3.42165,-0.77519,.967147,3.45083,-1.20542,1.0838,3.89743,-0.733245,.999542,3.94884,-1.15614,1.07677,-0.609634,-6.73228,2.3657,-0.523715,-6.70721,1.16543,1.00982,-4.953,1.99412,1.06506,-4.93688,.663894,1.02425,-3.3186,.663894,1.02425,-4.52693,1.87223,1.02425,-4.52693,1.87223,1.02425,-3.3186,1.01141,1.84785,-3.66611,1.01141,1.84785,-4.17941,1.52471,1.84785,-4.17941,1.52471,1.84785,-3.66612,1.04465,2.57433,-3.63675,.984004,2.60882,-4.14529,1.49148,2.56504,-4.20877,1.55212,2.53056,-3.70024,1.12188,3.13671,-3.58718,1.0223,3.19747,-4.08704,1.51916,3.12662,-4.19465,1.61875,3.06585,-3.69478,1.16245,3.49617,-3.56951,1.0964,3.52345,-4.07781,1.60501,3.54777,-4.1426,1.67106,3.5205,-3.6343,1.12942,3.50981,-3.82366,1.3507,3.53561,-4.11021,1.63803,3.53413,-3.88845,1.41675,3.50833,-3.6019,1.38373,3.52197,-3.85605,1.6117,3.86877,-4.08778,1.43817,3.86048,-4.06567,1.63423,3.85947,-3.91435,1.4607,3.85117,-3.89225,1.07819,3.85129,-4.07624,1.10479,3.8403,-3.87154,1.28302,3.86108,-4.10233,1.30962,3.8501,-3.89763,1.74071,3.76074,-3.62491,1.68389,3.78531,-3.81204,1.55499,3.78819,-3.56491,1.49817,3.81276,-3.75203,1.16896,3.75301,-3.46405,1.10239,3.82386,-3.65847,1.37586,3.77868,-3.52554,1.30929,3.84954,-3.71996,1.47625,4.13529,-3.86696,1.41694,4.13245,-3.8594,1.48396,4.1321,-3.80768,1.42464,4.12927,-3.80013,1.2939,4.12931,-3.86302,1.30299,4.12555,-3.79305,1.36391,4.13266,-3.87193,1.373,4.1289,-3.80196,1.52035,4.09836,-3.70875,1.50093,4.10675,-3.77271,1.45687,4.10774,-3.68824,1.43745,4.11614,-3.7522,1.32492,4.09572,-3.65376,1.30217,4.11993,-3.72022,1.39564,4.10449,-3.67478,1.37289,4.12871,-3.74124,1.10323,2.72603,-4.15131,1.38681,2.70157,-4.18679,1.12462,3.05498,-4.11876,1.40228,3.01538,-4.17889,1.11357,2.72142,-4.08748,1.39716,2.69696,-4.12295,1.13497,3.05037,-4.05493,1.41263,3.01077,-4.11506,1.5127,2.66623,-4.10673,1.54946,2.64532,-3.79843,1.52948,3.00668,-4.09816,1.58986,2.96984,-3.79512,1.404,2.67525,-4.0886,1.44076,2.65435,-3.7803,1.42078,3.01571,-4.08004,1.48116,2.97887,-3.777,1.15294,2.66874,-3.64348,1.47071,2.64132,-3.68323,1.20131,3.02088,-3.61243,1.51244,2.97651,-3.67981,1.12344,2.68172,-3.82535,1.44121,2.65431,-3.8651,1.17181,3.03387,-3.79431,1.48294,2.9895,-3.86169,1.04415,2.67952,-3.71514,1.00442,2.70211,-4.04831,1.09475,3.04795,-3.68266,1.02951,3.08776,-4.01015,1.15626,2.67002,-3.73386,1.11653,2.69261,-4.06702,1.20686,3.03845,-3.70137,1.14161,3.07826,-4.02886,-1.08587,1.31898,.0714877,-0.546552,1.25833,-0.0811735,-0.345295,1.32571,.60305,-0.884613,1.38636,.755711,-0.77419,3.3045,-0.0180809,-0.487376,3.27225,-0.0992676,-0.392184,3.30412,.224361,-0.678998,3.33637,.305547,-0.0441135,3.87983,-0.33609,.133088,3.8599,-0.38625,.191899,3.87959,-0.186304,.0146983,3.89952,-0.136144,-0.669038,1.23582,-2.81495,-0.252327,1.28837,-2.43886,-0.72833,1.24441,-1.9053,-1.14504,1.19186,-2.28138,-0.934775,3.22189,-2.63492,-0.713165,3.24983,-2.43492,-0.938308,3.22904,-2.18254,-1.15992,3.20109,-2.38255,-0.444375,3.95189,-2.19704,-0.307458,3.96916,-2.07348,-0.446557,3.95631,-1.91755,-0.583474,3.93905,-2.04112,-2.46772,1.65979,1.60224,-3.18792,1.35648,-0.0621809,-1.5551,1.81111,.795019,-2.04479,1.49281,-0.490879,-2.7305,3.06167,1.09683,-3.30068,3.09118,-0.104776,-2.08002,3.22032,.513079,-2.4773,3.17985,-0.427482,-2.83249,4.15129,.768141,-3.13601,4.167,.128513,-2.48623,4.23574,.457405,-2.69771,4.2142,-0.0432678,-3.04433,5.73468,.855719,-3.34784,5.75039,.21609,-2.69807,5.81913,.544982,-2.90954,5.79759,.0443094,-3.11625,5.76671,1.45828,-3.83166,5.80374,-0.0493937,-2.30008,5.96577,.725839,-2.79854,5.91499,-0.454299,-3.21883,6.53347,1.50069,-3.93424,6.5705,-0.00698423,-2.40266,6.73253,.768249,-2.90112,6.68176,-0.411889,-3.89611,5.91227,1.41297,-4.29166,5.92724,.582255,-3.67895,6.26292,1.30204,-4.0745,6.27789,.471329,-4.28195,6.26223,1.60411,-4.68079,6.27436,.774933,-3.92469,6.40741,1.42052,-4.32353,6.41954,.59134,-4.43762,6.81186,1.68784,-4.83933,6.82353,.860037,-4.06038,6.77832,1.49041,-4.46209,6.78999,.662604,-4.35983,7.48868,1.66057,-4.76475,7.50154,.834352,-4.04633,7.25454,1.48936,-4.45125,7.26741,.66314,-4.1892,7.76069,1.36149,-4.42285,7.76811,.884742,-4.0083,7.62559,1.26269,-4.24195,7.63301,.785949,-3.95768,6.36759,-0.843304,-3.15961,6.45534,-1.03734,-3.89985,6.67242,-0.360582,-3.10178,6.76017,-0.554614,-3.94268,6.82314,-1.04059,-3.33796,6.86846,-1.15975,-3.88495,6.89769,-0.621725,-3.28023,6.94301,-0.740881,-3.91379,7.19086,-1.07012,-3.42547,7.2184,-1.15942,-3.86694,7.19657,-0.727947,-3.37861,7.2241,-0.817254,-3.83934,7.61822,-1.02707,-3.53146,7.63558,-1.08338,-3.8098,7.62181,-0.811341,-3.50192,7.63917,-0.867648],morphTargets:[],normals:[.327555,-0.36964,-0.869503,-0.81283,-0.3914,-0.431349,-0.846583,.501419,-0.178381,.26841,-0.431135,-0.861415,.804712,.241768,.542161,.745201,-0.621601,.24134,-0.326029,.377789,.866573,-0.37727,-0.643025,.666433,-0.69924,.403821,-0.589862,-0.588397,-0.333201,.736686,-0.45204,.326945,.82989,-0.757622,.635762,-0.147588,-0.869106,-0.064119,-0.490432,.583239,.181036,-0.791833,.28724,-0.529771,-0.797998,-0.853267,-0.31373,-0.416517,.882809,.185461,.431501,.628101,-0.692434,.354961,-0.298685,.217383,.929258,-0.494308,-0.480636,.724296,-0.058382,.860378,.506241,-0.575915,.550829,-0.604022,-0.839412,-0.068117,-0.539171,.411054,.425855,-0.806024,.284616,-0.48619,-0.826167,-0.832362,-0.443129,-0.332774,.881161,.357494,.309336,.757958,-0.586016,.286416,-0.198157,-0.030519,.979675,-0.341777,-0.544481,.765954,.600604,.442,.66625,.845943,-0.091281,-0.525376,.513199,.274361,-0.813227,.572314,.79339,.207221,-0.769646,-0.399335,-0.498123,-0.515366,-0.505051,.692312,.526749,.423414,-0.737022,.411359,-0.521073,-0.747795,.894894,.124577,.42848,.655538,-0.625599,.422895,.608478,.325846,.723533,-0.808313,.101871,.579852,-0.658528,.347453,-0.667501,-0.581927,-0.544176,-0.604297,-0.579577,-0.531724,.617512,.588977,.308451,-0.74694,.630421,-0.499619,-0.594043,.731101,-0.20719,.650014,.627155,-0.488845,.606372,-0.857875,.384625,.340678,.247414,-0.0141,.96878,.566088,.361583,.740776,-0.442152,.800653,.404279,-0.663137,.303781,.684042,-0.684652,.303568,-0.662618,-0.654714,-0.377667,-0.654714,-0.654714,-0.377667,.654714,.663259,.303812,-0.683889,.654714,-0.377667,-0.654714,.683737,.303598,.663533,.654714,-0.377667,.654714,.761773,-0.039583,.646596,-0.686117,.002655,.727439,.599017,-0.012024,-0.800623,-0.773309,.030549,-0.633259,.334697,.301309,-0.892819,-0.510544,.339,-0.790185,-0.588031,-0.011109,.80874,-0.585345,-0.14124,.798364,-0.966155,.19483,.168889,-0.835932,.072726,-0.543931,-0.780999,.077883,-0.619617,.513779,-0.032838,-0.857265,.828394,-0.106235,.549944,.864223,-0.360088,-0.351299,.931181,-0.352397,.093112,-0.117679,.286172,.950896,.388562,.223273,.893948,-0.817835,.368755,-0.441725,-0.785424,.301462,.540574,-0.585986,-0.190405,.787591,-0.713767,.088748,-0.694723,-0.115452,.213569,-0.970061,.615345,.049318,-0.786676,.984222,.016938,-0.176031,.78637,-0.212897,.579882,.208045,.008972,.978057,-0.065004,.985412,.157109,.397168,.565935,-0.722434,.896908,-0.152043,.415204,-0.410688,.265725,.872158,-0.76043,.525834,-0.381024,.676901,.162114,-0.717978,.763054,.263833,.590014,.487136,.035279,-0.872585,-0.429884,.829463,-0.356578,.549883,.507614,-0.663259,-0.523148,.259621,.811701,-0.791162,.092013,-0.604602,-0.557482,-0.275491,.783135,.724357,.320292,.610492,-0.264504,.229621,.936613,.536912,.408734,-0.737999,.770562,.356273,.528459,.252144,.868435,-0.426832,.407788,.637867,.653279,.821223,-0.206244,.531999,.859523,.391644,.328288,-0.108737,.714408,.691214,-0.845851,.388623,-0.365337,.602924,-0.538255,-0.588824,.601489,-0.532365,.595599,-0.601489,-0.532365,.595599,-0.602924,-0.538255,-0.588824,.427869,.369182,-0.824976,.96234,.263894,.064974,-0.598437,.43672,.671651,-0.838771,-0.151708,-0.522874,-0.341594,-0.538255,-0.770409,.767968,-0.532365,-0.356029,.34843,-0.532365,.771447,-0.762108,-0.538255,.359722,.411817,.8464,-0.337535,-0.453139,.356212,-0.817164,.815973,-0.194342,-0.544389,.181249,.794855,.579058,-0.456984,.820917,-0.342357,.136998,.666402,-0.732871,.699484,.668691,.252083,.601581,.798059,-0.033876,.443892,.865535,-0.23188,-0.427656,.843898,-0.323862,.34138,.791559,.506821,.494003,-0.398206,.772881,.90054,-0.434034,.024293,-0.309,-0.510941,.802149,-0.828394,-0.541429,-0.143498,.789483,-0.557268,-0.257149,-0.687033,-0.426466,-0.588244,-0.292276,-0.345042,-0.891903,.499619,-0.266457,-0.824213,-0.497696,.541673,.677389,.632496,.690268,.351329,.260872,.577044,-0.773888,-0.740501,.560411,-0.370891,-0.506943,.310923,.803919,.498154,.733116,.462966,.033601,.779748,-0.625141,-0.898343,.407727,-0.163396,.618854,.35197,.7022,.72219,.589984,-0.360973,-0.455306,.821375,-0.343455,-0.452528,.449324,.770257,-0.529374,.268166,-0.804865,-0.61333,.761162,.210791,-0.036653,.697195,-0.715903,.907193,.330119,-0.26075,.505356,.767998,.393414,.3596,.643147,-0.676015,-0.663381,.532304,-0.525864,-0.572771,.629871,.524552,-0.797754,.521195,-0.303171,-0.611011,.374035,.697653,.439955,.853694,-0.278542,-0.618061,.783898,.058748,.26429,-0.317759,-0.910581,-0.601886,-0.286386,-0.745415,-0.719901,-0.481826,-0.499527,.412427,-0.582965,-0.700003,-0.616138,.648183,-0.447401,.524491,.582263,-0.621143,.915067,.258889,-0.309183,.959349,.229896,.163579,.704581,.502609,.5009,.533738,.551775,-0.640767,.610431,-0.660695,.436811,.417035,-0.581378,-0.698599,-0.176214,-0.302499,.936674,-0.545366,-0.531724,.647908,-0.414289,.59621,.687643,.322214,-0.377392,.86816,.72042,.469161,.510697,.57738,-0.692892,.431837,-0.805414,-0.246284,-0.539079,-0.797754,-0.327891,.505997,-0.526231,-0.594958,.607501,-0.722648,-0.453352,-0.521714,-0.429243,.565935,.703879,-0.594562,.676778,-0.434065,-0.192602,.83929,-0.508408,.419965,.807459,-0.414258,-0.607196,.512406,-0.607196,-0.607196,.512406,.607196,.607196,.512406,-0.607196,.607196,.512406,.607196,.772515,-0.050295,.632954,-0.649251,.008332,.760491,.611835,-0.004547,-0.790948,-0.776391,.057436,-0.627583,.193793,.356029,-0.914121,-0.406201,.368816,-0.836024,-0.562029,.015717,.82693,-0.966155,.19483,.16892,-0.829249,.150761,-0.538133,.537339,-0.004547,-0.843318,.825587,-0.140324,.546495,.791986,-0.371441,-0.484481,.921659,-0.373333,.105472,-0.132664,.283456,.949736,.457411,.192297,.868191,-0.900632,.405835,.155309,-0.825922,.336955,.451979,-0.700339,.184698,.689474,-0.75399,.327372,-0.569475,.448378,.121036,-0.885586,.767052,.10538,.632832,-0.310862,.191046,.931028,-0.954375,.240852,-0.176366,.583117,.387799,-0.713797,.841182,.166662,.514389,-0.60509,-0.049989,.794549,-0.690939,.349681,-0.632679,-0.466567,.072542,.881497,.809107,.513779,.285165,-0.208045,.701529,.681539,.476058,.323344,-0.817774,.807886,-0.065859,.58562,.621784,.674429,-0.398083,.681204,.435163,.588702,.868801,.124424,.479202,.758293,.295114,-0.581256,.578356,.745567,.331034,-0.471541,.611347,.635517,-0.897519,.357952,-0.257424,.477737,.573626,.665334,.335826,.863124,-0.377056,-0.725333,.640217,-0.252968,-0.529557,.4167,.738853,-0.443403,.863216,-0.241279,-0.301614,.529191,.793054,.543535,.83755,-0.055086,-0.607898,.74221,.282022,.419996,.659017,-0.62389,-0.545824,.751885,-0.369701,.093265,-0.23661,-0.967101,-0.496445,-0.230628,-0.836848,.878628,.224708,-0.421308,.957915,.224769,.178503,-0.146275,-0.010743,.989166,-0.563524,.032624,.825434,.467605,-0.123508,.87524,.815973,-0.134953,.562059,-0.97763,.099826,.184973,-0.880001,.026673,.474197,-0.627674,.762749,.155644,-0.98291,.083285,.164037,-0.574145,-0.01883,.818506,-0.451979,.512558,.730033,.774773,.002014,.632221,.922208,.319742,.217444,-0.049867,.871975,.486953,-0.856441,.111698,-0.503983,-0.822108,.371715,-0.431196,.311624,-0.328959,-0.891415,.479324,-0.021943,-0.877346,.875637,.110721,.470046,-0.456679,.245521,.855037,-0.402722,.658681,-0.635517,.594317,.192297,-0.780877,-0.959868,.280374,-0.002777,-0.123264,-0.011322,.992279,.21305,.402356,.890316,-0.644642,.737449,.201392,-0.0524,.083163,-0.995148,-0.159978,.325144,-0.932005,.974487,-0.090762,-0.205237,.971618,.228401,-0.061434,.034242,.14182,.989288,-0.997894,-0.00412,.064669,.150426,.706748,-0.691244,.897397,.433241,.083377,-0.983856,.007111,-0.178747,-0.380474,.193854,.904233,-0.279916,.257241,.924894,-0.916288,.06943,-0.394421,.321329,.24662,-0.914274,-0.935636,.063173,-0.34724,.365154,.263588,-0.892819,.908444,.371349,.191778,.943419,.250496,.2172,.348094,-0.764214,-0.542924,.721885,-0.687674,.077059,-0.230903,.111789,.966521,.00708,-0.915067,.40318,.895627,-0.413709,.163182,.212043,-0.634236,.743461,-0.404462,-0.888852,-0.215278,.690268,.692923,.208106,.047578,.615253,.786859,.582171,-0.587939,-0.561571,-0.547533,-0.774834,-0.315897,.645466,.727775,-0.231605,-0.740959,.669393,.053407,.485061,-0.266518,-0.83285,.594378,.801843,.061281,-0.665456,.632221,-0.396771,-0.092563,.640339,.762474,.048799,.412,-0.909848,.755608,.412336,.508927,-0.653584,-0.69628,-0.296609,-0.190069,-0.700034,.688314,.231391,.127812,-0.964415,.915586,.112918,.385846,-0.276589,-0.435804,.856471,-0.850429,-0.427992,-0.305887,-0.963927,-0.066103,-0.257698,-0.370128,-0.080844,.925443,-0.208716,.432112,.877316,-0.824122,.453597,-0.339152,.249672,.038026,-0.967559,-0.200507,.917661,-0.343028,.569414,.349651,-0.74395,.930204,.007599,.366924,.175329,.900266,.398389,.943968,.330027,-0.001862,.486496,.04001,-0.872738,.711966,.611682,.344798,-0.727317,.584124,.36021,-0.737327,-0.438887,-0.513474,-0.674551,.445326,.588733,.770043,.351634,.532273,-0.610034,.262062,.747765,-0.775506,-0.10358,-0.62273,.532853,.203986,-0.821223,-0.792077,.103488,-0.60152,-0.627125,.632221,-0.454939,.38081,.688467,-0.617206,-0.458449,.650472,.605518,.549364,.708304,.44322],colors:[],uvs:[],faces:[35,1,0,4,5,0,0,1,2,3,35,5,6,2,1,0,3,4,5,0,35,6,7,3,2,0,4,6,7,5,35,0,3,7,4,0,1,7,6,2,35,0,1,2,3,0,1,0,5,7,35,29,28,121,122,0,8,9,10,11,35,12,13,9,8,0,12,13,14,15,35,13,14,10,9,0,13,16,17,14,35,14,15,11,10,0,16,18,19,17,35,15,12,8,11,0,18,12,15,19,35,8,9,10,11,0,15,14,17,19,35,4,7,112,109,0,2,6,20,21,35,20,21,17,16,0,22,23,24,25,35,21,22,18,17,0,23,26,27,24,35,22,23,19,18,0,26,28,29,27,35,23,20,16,19,0,28,22,25,29,35,16,17,18,19,0,25,24,27,29,35,86,85,129,130,0,30,31,32,33,35,28,29,25,24,0,9,8,34,35,35,29,30,26,25,0,8,36,37,34,35,30,31,27,26,0,36,38,39,37,35,31,28,24,27,0,38,9,35,39,35,24,25,26,27,0,35,34,37,39,35,28,31,124,121,0,9,38,40,10,35,36,37,33,32,0,41,42,43,44,35,37,38,34,33,0,42,45,46,43,35,38,39,35,34,0,45,47,48,46,35,39,36,32,35,0,47,41,44,48,35,32,33,34,35,0,44,43,46,48,35,96,95,135,136,0,49,50,51,52,35,44,45,41,40,0,53,54,55,56,35,45,46,42,41,0,54,57,58,55,35,46,47,43,42,0,57,59,60,58,35,47,44,40,43,0,59,53,56,60,35,40,41,42,43,0,56,55,58,60,35,44,47,51,48,0,53,59,61,62,35,50,49,153,154,0,63,64,65,66,35,47,46,50,51,0,59,57,63,61,35,45,44,48,49,0,54,53,62,64,35,46,45,49,50,0,57,54,64,63,34,52,56,60,0,67,68,69,34,53,52,60,0,70,67,69,34,53,60,57,0,70,69,71,35,54,55,164,163,0,72,73,74,75,35,48,51,170,169,0,62,61,76,77,35,49,48,177,178,0,64,62,78,79,35,57,60,70,69,0,71,69,80,81,34,54,61,58,0,72,82,83,34,54,57,61,0,72,71,82,34,54,53,57,0,72,70,71,34,55,62,59,0,73,84,85,34,55,54,62,0,73,72,84,34,54,58,62,0,72,83,84,34,55,59,63,0,73,85,86,34,55,63,56,0,73,86,68,34,52,55,56,0,67,73,68,35,63,64,80,79,0,86,87,88,89,35,64,63,75,76,0,87,86,90,91,35,62,58,65,67,0,84,83,92,93,35,74,76,148,146,0,94,91,95,96,35,61,64,68,66,0,82,87,97,98,35,58,61,66,65,0,83,82,98,92,35,64,62,67,68,0,87,84,93,97,35,77,79,151,149,0,99,89,100,101,35,64,61,71,72,0,87,82,102,103,35,60,64,72,70,0,69,87,103,80,35,61,57,69,71,0,82,71,81,102,35,72,71,143,144,0,103,102,104,105,35,63,59,73,75,0,86,85,106,90,35,59,62,74,73,0,85,84,94,106,35,62,64,76,74,0,84,87,91,94,35,75,73,145,147,0,90,106,107,108,35,56,63,79,77,0,68,86,89,99,35,60,56,77,78,0,69,68,99,109,35,64,60,78,80,0,87,69,109,88,35,81,82,83,84,0,110,111,112,113,35,6,5,110,111,0,4,3,114,115,35,81,85,86,82,0,110,31,30,111,35,82,86,87,83,0,111,30,116,112,35,83,87,88,84,0,112,116,117,113,35,85,81,84,88,0,31,110,113,117,35,89,90,91,92,0,118,119,120,121,35,30,29,122,123,0,36,8,11,122,35,89,93,94,90,0,118,123,124,119,35,90,94,95,91,0,119,124,50,120,35,91,95,96,92,0,120,50,49,121,35,93,89,92,96,0,123,118,121,49,35,101,102,305,304,0,125,126,127,128,35,102,103,108,107,0,126,129,130,131,35,103,104,100,99,0,129,132,133,134,35,104,101,97,100,0,132,125,135,133,35,97,98,99,100,0,135,136,134,133,35,104,103,102,101,0,132,129,126,125,35,106,105,185,186,0,137,138,139,140,35,98,102,107,105,0,136,126,131,138,35,103,99,106,108,0,129,134,137,130,35,99,98,105,106,0,134,136,138,137,35,112,111,110,109,0,20,115,114,21,35,116,115,114,113,0,141,142,143,144,35,120,119,118,117,0,145,146,147,148,35,124,123,122,121,0,40,122,11,10,35,128,127,126,125,0,149,150,151,152,35,129,132,131,130,0,32,153,154,33,35,133,136,135,134,0,155,52,51,156,35,5,4,109,110,0,3,2,21,114,35,23,22,119,120,0,28,26,146,145,35,38,37,126,127,0,45,42,151,150,35,14,13,114,115,0,16,13,143,142,35,85,88,132,129,0,31,117,153,32,35,36,39,128,125,0,41,47,149,152,35,94,93,133,134,0,124,123,155,156,35,12,15,116,113,0,12,18,141,144,35,37,36,125,126,0,42,41,152,151,35,87,86,130,131,0,116,30,33,154,35,13,12,113,114,0,13,12,144,143,35,31,30,123,124,0,38,36,122,40,35,7,6,111,112,0,6,4,115,20,35,22,21,118,119,0,26,23,147,146,35,93,96,136,133,0,123,49,52,155,35,88,87,131,132,0,117,116,154,153,35,20,23,120,117,0,22,28,145,148,35,95,94,134,135,0,50,124,156,51,35,21,20,117,118,0,23,22,148,147,35,39,38,127,128,0,47,45,150,149,35,15,14,115,116,0,18,16,142,141,35,139,137,138,140,0,157,158,159,160,35,144,143,141,142,0,105,104,161,162,35,145,146,148,147,0,107,96,95,108,35,151,152,150,149,0,100,163,164,101,35,65,66,138,137,0,92,98,159,158,35,78,77,149,150,0,109,99,101,164,35,76,75,147,148,0,91,90,108,95,35,67,65,137,139,0,93,92,158,157,35,80,78,150,152,0,88,109,164,163,35,69,70,142,141,0,81,80,162,161,35,68,67,139,140,0,97,93,157,160,35,79,80,152,151,0,89,88,163,100,35,71,69,141,143,0,102,81,161,104,35,66,68,140,138,0,98,97,160,159,35,73,74,146,145,0,106,94,96,107,35,70,72,144,142,0,80,103,105,162,35,155,156,160,159,0,165,166,167,168,35,49,53,155,153,0,64,70,165,65,35,53,54,156,155,0,70,72,166,165,35,54,50,154,156,0,72,63,66,166,35,158,157,159,160,0,169,170,168,167,35,153,155,159,157,0,65,165,168,170,35,156,154,158,160,0,166,66,169,167,35,154,153,157,158,0,66,65,170,169,35,162,161,165,166,0,171,172,173,174,35,55,51,162,164,0,73,61,171,74,35,51,50,161,162,0,61,63,172,171,35,50,54,163,161,0,63,72,75,172,35,166,165,167,168,0,174,173,175,176,35,163,164,168,167,0,75,74,176,175,35,161,163,167,165,0,172,75,175,173,35,164,162,166,168,0,74,171,174,176,35,170,172,176,174,0,76,177,178,179,35,51,55,172,170,0,61,73,177,76,35,55,52,171,172,0,73,67,180,177,35,52,48,169,171,0,67,62,77,180,35,173,174,176,175,0,181,179,178,182,35,171,169,173,175,0,180,77,181,182,35,169,170,174,173,0,77,76,179,181,35,172,171,175,176,0,177,180,182,178,35,179,180,184,183,0,183,184,185,186,35,48,52,179,177,0,62,67,183,78,35,52,53,180,179,0,67,70,184,183,35,53,49,178,180,0,70,64,79,184,35,182,181,183,184,0,187,188,186,185,35,180,178,182,184,0,184,79,187,185,35,177,179,183,181,0,78,183,186,188,35,178,177,181,182,0,79,78,188,187,35,187,188,186,185,0,189,190,140,139,35,105,107,187,185,0,138,131,189,139,35,107,108,188,187,0,131,130,190,189,35,108,106,186,188,0,130,137,140,190,35,193,194,190,189,0,53,54,191,192,35,194,195,191,190,0,54,57,193,191,35,195,196,192,191,0,57,59,194,193,35,196,193,189,192,0,59,53,192,194,35,193,196,200,197,0,53,59,195,196,35,199,198,246,247,0,197,198,199,200,35,196,195,199,200,0,59,57,197,195,35,194,193,197,198,0,54,53,196,198,35,195,194,198,199,0,57,54,198,197,34,201,205,209,0,201,68,202,34,202,201,209,0,203,201,202,34,202,209,206,0,203,202,71,35,203,204,257,256,0,204,205,206,207,35,197,200,263,262,0,196,195,208,209,35,198,197,270,271,0,198,196,210,211,35,206,209,219,218,0,71,202,212,213,34,203,210,207,0,204,82,83,34,203,206,210,0,204,71,82,34,203,202,206,0,204,203,71,34,204,211,208,0,205,84,85,34,204,203,211,0,205,204,84,34,203,207,211,0,204,83,84,34,204,208,212,0,205,85,86,34,204,212,205,0,205,86,68,34,201,204,205,0,201,205,68,35,212,213,229,228,0,86,87,214,215,35,213,212,224,225,0,87,86,216,217,35,211,207,214,216,0,84,83,218,219,35,210,213,217,215,0,82,87,220,221,35,207,210,215,214,0,83,82,221,218,35,213,211,216,217,0,87,84,219,220,35,226,228,244,242,0,222,215,223,224,35,213,210,220,221,0,87,82,225,226,35,209,213,221,219,0,202,87,226,212,35,210,206,218,220,0,82,71,213,225,35,221,220,236,237,0,226,225,227,228,35,212,208,222,224,0,86,85,229,216,35,208,211,223,222,0,85,84,230,229,35,211,213,225,223,0,84,87,217,230,35,224,222,238,240,0,216,229,231,232,35,205,212,228,226,0,68,86,215,222,35,209,205,226,227,0,202,68,222,233,35,213,209,227,229,0,87,202,233,214,35,232,230,231,233,0,234,235,236,237,35,237,236,234,235,0,228,227,238,239,35,238,239,241,240,0,231,240,241,232,35,244,245,243,242,0,223,242,243,224,35,214,215,231,230,0,218,221,236,235,35,227,226,242,243,0,233,222,224,243,35,225,224,240,241,0,217,216,232,241,35,216,214,230,232,0,219,218,235,234,35,229,227,243,245,0,214,233,243,242,35,218,219,235,234,0,213,212,239,238,35,217,216,232,233,0,220,219,234,237,35,228,229,245,244,0,215,214,242,223,35,220,218,234,236,0,225,213,238,227,35,215,217,233,231,0,221,220,237,236,35,222,223,239,238,0,229,230,240,231,35,219,221,237,235,0,212,226,228,239,35,248,249,253,252,0,244,245,167,168,35,198,202,248,246,0,198,203,244,199,35,202,203,249,248,0,203,204,245,244,35,203,199,247,249,0,204,197,200,245,35,251,250,252,253,0,169,170,168,167,35,246,248,252,250,0,199,244,168,170,35,249,247,251,253,0,245,200,169,167,35,247,246,250,251,0,200,199,170,169,35,255,254,258,259,0,246,247,173,174,35,204,200,255,257,0,205,195,246,206,35,200,199,254,255,0,195,197,247,246,35,199,203,256,254,0,197,204,207,247,35,259,258,260,261,0,174,173,175,176,35,256,257,261,260,0,207,206,176,175,35,254,256,260,258,0,247,207,175,173,35,257,255,259,261,0,206,246,174,176,35,263,265,269,267,0,208,248,249,179,35,200,204,265,263,0,195,205,248,208,35,204,201,264,265,0,205,201,250,248,35,201,197,262,264,0,201,196,209,250,35,266,267,269,268,0,181,179,249,251,35,264,262,266,268,0,250,209,181,251,35,262,263,267,266,0,209,208,179,181,35,197,201,272,270,0,196,201,252,210,35,201,202,273,272,0,201,203,253,252,35,202,198,271,273,0,203,198,211,253,35,275,274,276,277,0,187,254,255,256,35,273,271,275,277,0,253,211,187,256,35,271,270,274,275,0,211,210,254,187,35,285,284,288,289,0,257,258,259,260,35,278,282,283,279,0,261,262,263,264,35,279,283,284,280,0,264,263,258,265,35,280,284,285,281,0,265,258,257,266,35,282,278,281,285,0,262,261,266,257,35,286,289,288,287,0,267,260,259,268,35,283,282,286,287,0,263,262,267,268,35,282,285,289,286,0,262,257,260,267,35,284,283,287,288,0,258,263,268,259,35,297,296,300,301,0,269,270,271,272,35,290,294,295,291,0,273,274,275,276,35,291,295,296,292,0,276,275,270,277,35,292,296,297,293,0,277,270,269,278,35,294,290,293,297,0,274,273,278,269,35,298,301,300,299,0,279,272,271,280,35,295,294,298,299,0,275,274,279,280,35,294,297,301,298,0,274,269,272,279,35,296,295,299,300,0,270,275,280,271,35,303,302,306,307,0,281,282,283,284,35,102,98,303,305,0,126,136,281,127,35,98,97,302,303,0,136,135,282,281,35,97,101,304,302,0,135,125,128,282,35,309,307,311,313,0,285,284,286,287,35,302,304,308,306,0,282,128,288,283,35,304,305,309,308,0,128,127,285,288,35,305,303,307,309,0,127,281,284,285,35,312,313,317,316,0,289,287,290,291,35,307,306,310,311,0,284,283,292,286,35,306,308,312,310,0,283,288,289,292,35,308,309,313,312,0,288,285,287,289,35,314,316,320,318,0,293,291,294,295,35,313,311,315,317,0,287,286,296,290,35,311,310,314,315,0,286,292,293,296,35,310,312,316,314,0,292,289,291,293,35,318,320,324,322,0,295,294,297,298,35,316,317,321,320,0,291,290,299,294,35,317,315,319,321,0,290,296,300,299,35,315,314,318,319,0,296,293,295,300,35,324,325,323,322,0,297,301,302,298,35,320,321,325,324,0,294,299,301,297,35,325,321,347,349,0,301,299,303,304,35,322,323,329,328,0,298,302,305,306,35,328,329,333,332,0,306,305,307,308,35,323,319,327,329,0,302,300,309,305,35,319,318,326,327,0,300,295,310,309,35,318,322,328,326,0,295,298,306,310,35,332,333,337,336,0,308,307,311,312,35,326,328,332,330,0,310,306,308,313,35,329,327,331,333,0,305,309,314,307,35,327,326,330,331,0,309,310,313,314,35,335,334,338,339,0,315,316,317,318,35,330,332,336,334,0,313,308,312,316,35,333,331,335,337,0,307,314,315,311,35,331,330,334,335,0,314,313,316,315,35,341,339,343,345,0,319,318,320,321,35,336,337,341,340,0,312,311,319,322,35,334,336,340,338,0,316,312,322,317,35,337,335,339,341,0,311,315,318,319,35,343,342,344,345,0,320,323,324,321,35,339,338,342,343,0,318,317,323,320,35,340,341,345,344,0,322,319,321,324,35,338,340,344,342,0,317,322,324,323,35,349,347,351,353,0,304,303,325,326,35,319,323,348,346,0,300,302,327,328,35,321,319,346,347,0,299,300,328,303,35,323,325,349,348,0,302,301,304,327,35,352,353,357,356,0,329,326,330,331,35,346,348,352,350,0,328,327,329,332,35,347,346,350,351,0,303,328,332,325,35,348,349,353,352,0,327,304,326,329,35,355,354,358,359,0,333,334,335,336,35,353,351,355,357,0,326,325,333,330,35,350,352,356,354,0,332,329,331,334,35,351,350,354,355,0,325,332,334,333,35,359,358,360,361,0,336,335,337,338,35,356,357,361,360,0,331,330,338,337,35,357,355,359,361,0,330,333,336,338,35,354,356,360,358,0,334,331,337,335],bones:[],skinIndices:[],skinWeights:[],animation:{}}}),define("models",["json!models/SHACK.js","json!models/castle.js"],function(e,t){return{init:function(n,r){var i=new THREE.JSONLoader,s=i.parse(e),o=i.parse(t),u,a=new THREE.MeshPhongMaterial({color:5592405});u=new THREE.Mesh(s.geometry,s.materials[0]),u.receiveShadow=!0,u.castShadow=!0,u.scale.set(70,70,70),u.position.set(4700,-1050,50),u.rotation.set(0,-0.3,0),n.add(u);var f=new THREE.MeshPhongMaterial({color:5592405});u=new THREE.Mesh(o.geometry,o.materials[0]),u.receiveShadow=!0,u.castShadow=!0,u.scale.set(170,170,170),u.position.set(-5500,-900,50),u.rotation.set(0,-0.3,0),n.add(u)}}}),define("scene",["landscape","water","clouds","fxstuff","tweenstuff","models"],function(e,t,n,r,i,s){function y(e,t){e.add(t,"x").listen().__precision=5,e.add(t,"y").listen().__precision=5,e.add(t,"z").listen().__precision=5}function b(e){var t=$("<canvas/>")[0];t.width=32,t.height=window.innerHeight;var n=t.getContext("2d"),r=n.createLinearGradient(0,0,0,t.height);r.addColorStop(0,"#126"),r.addColorStop(.9,"#48b"),n.fillStyle=r,n.fillRect(0,0,t.width,t.height),e.style.background="url("+t.toDataURL("image/png")+")",e.style.backgroundSize="32px 100%"}function w(){o=new THREE.PerspectiveCamera(30,window.innerWidth/window.innerHeight,1,5e4),o.position.z=8e3,o.lookAt(m),a.remember(o.position),a.remember(o.rotation);var r=a.addFolder("camera");y(r,o.position),y(r,o.rotation),u=new THREE.Scene,light=new THREE.DirectionalLight(16777215,1),light.position.set(-1e3,3e3,0),light.target.position.set(0,0,0),light.castShadow=!0;var i=5e3;light.shadowCameraLeft=-i,light.shadowCameraRight=i,light.shadowCameraTop=i,light.shadowCameraBottom=-i,light.shadowCameraNear=700,light.shadowCameraFar=15e3,light.shadowCameraFov=50,light.shadowBias=1e-4,light.shadowDarkness=.5;var f=2048,l=1024;light.shadowMapWidth=f,light.shadowMapHeight=l;var c=a.addFolder("light");a.remember(light),a.remember(light.position),c.add(light,"intensity",0,2),c.add(light.position,"x",-1e4,1e4),u.add(light),e.init(u,a),t.init(u,a),n.init(u,a),s.init(u,a)}function E(){function r(){n=[],$.each(i.Tweenz,function(e,t){n.push(t.name)})}if(typeof localStorage===undefined)return console.log("Sorry, localStorage only.");var e=typeof localStorage.mainGUI=="undefined"?{preset:"Default",remembered:{Default:{}}}:JSON.parse(localStorage.mainGUI);a=mg=new dat.GUI({name:"mainGUI",load:e}),f=new dat.GUI({name:"transitionGUI"});var t={reset:function(){var e=confirm("Are you sure? <b>RESET</b> Everything?");if(e==1){var e=confirm("... Everything? ...\n ... Really?");e==1&&localStorage.clear()}},save:function(){var e=confirm("Overwrite old save?");e==1&&(localStorage.mainGUI=JSON.stringify(a.getSaveObject()),i.save(),u.save())}};f.add(t,"reset").name("Reset it all"),f.add(t,"save").name("Save it all"),l=f.addFolder("Transitions");var n=[],s=f.addFolder("Que"),o=$('<ul id="quequeList">').sortable(),u={addQueItem:function(e){var t=$("<li>"),s=$("<select>"),u=$("<button>").html(">").addClass("playBtn");u.click(function(){o.find("li").removeClass("quequed"),t.addClass("quequed"),$(i.Tweenz).each(function(e,t){t.name==s.val()&&t.start()})}),t.append(u),t.append(s),r();for(var a in n)s.append("<option>"+n[a]+"</option>");s.val(e);var f=$("<button>").html("X");f.click(function(){t.remove()}),t.append(f),o.append(t)},save:function(){var e=[];o.find("select").each(function(t,n){e.push(n.value)}),localStorage.Ques=JSON.stringify(e)}};return s.add(u,"addQueItem").name("Add Que Item"),$(s.__ul).append(o),function(){var e=typeof localStorage.Ques=="undefined"?[]:JSON.parse(localStorage.Ques);for(var t in e)u.addQueItem(e[t])}}function S(){var e=E(),t=$("<div/>")[0];$("body").append(t),b(t),w(),r.initEffects(t,u,o,a),i.initTweenz(l,a),e(),$(t).on("mousemove",L),$(t).on("mousedown",T),$(t).on("mouseup",N),$(t).on("contextmenu",function(e){e.preventDefault(),e.stopPropagation()}),$(document).on("keydown",C),$(document).on("keyup",k),_()}function T(e){x=!0,e.preventDefault(),e.stopPropagation()}function N(e){x=!1,e.preventDefault(),e.stopPropagation()}function C(e){g[e.keyCode]=!0}function k(e){g[e.keyCode]=!1}function L(e){c=(e.clientX-d)/d,h=-(e.clientY-v)/v}function O(e){var t=new THREE.Vector3,n=g[A.fine];t.x=g[A.left]?1:g[A.right]?-1:0,t.y=g[A.up]?1:g[A.down]?-1:0,t.z=g[A.forward]?1:g[A.backward]?-1:0,t.applyEuler(o.rotation),o.position.add(t.multiplyScalar((n?100:1e3)*e)),g[A.que]&&i.queNext();var r=new THREE.Vector3(0,0,-1);r.y=x?h/(n?1e3:100):0,r.x=x?c/(n?1e3:100):0,r.applyEuler(o.rotation),r.add(o.position),o.lookAt(r)}function _(){requestAnimationFrame(_);var e=(new Date).getTime()/1e3,i=e-M;O(i),n.render(i),t.render(i,e),r.render(),M=e,TWEEN.update()}var o,u,a,f,l,c=0,h=0,p=Date.now(),d=window.innerWidth/2,v=window.innerHeight/2,m=new THREE.Vector3,g={},x=!1,A={left:68,right:65,forward:83,backward:87,up:81,down:90,fine:16,que:32},M=(new Date).getTime()/1e3;return{init:S}}),require(["scene"],function(e){$(function(){e.init()})})})();